Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at './data/battery_demand/tol26/resample_full.csv' and './data/battery_demand/tol26/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1378, 37)
		[INFO] Number of seeds ready for Case 3  = (2000, 36)

		[INFO] Case 1 exists — loaded battery demand from './data/battery_demand/tol26/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists — loaded battery demand from './data/battery_demand/tol26/case2_nan_filled/battery_demand.npy' with shape (1546, 37).
		[INFO] Case 3 exists — loaded battery demand from './data/battery_demand/tol26/case3_extended_generated/battery_demand.npy' with shape (3546, 37).

	1.6 Generating battery schedule...
		[INFO] Case 1 exists — loaded from './data/battery_demand/tol26/case1_real_only/battery_availability.npy' and './data/battery_demand/tol26/case1_real_only/battery_details.npy' shape (168, 263, 36) and (4, 168, 263)
		[INFO] Case 2 exists — loaded from './data/battery_demand/tol26/case2_nan_filled/battery_availability.npy' and './data/battery_demand/tol26/case2_nan_filled/battery_details.npy' shape (1546, 311, 36) and (4, 1546, 311)
		[INFO] Case 3 exists — loaded from './data/battery_demand/tol26/case3_extended_generated/battery_availability.npy' and './data/battery_demand/tol26/case3_extended_generated/battery_details.npy' shape (3546, 422, 36) and (4, 3546, 422)


==================================================
PART 2: MILP Optimization...
==================================================

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from './data/battery_demand/tol26/case1_real_only'
		[INFO] Results already exist at './data/optimization_results/tol26/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol26/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1546 samples from './data/battery_demand/tol26/case2_nan_filled'
		[INFO] Results already exist at './data/optimization_results/tol26/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol26/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 2 completed.

	2.3 Optimizing Case 3...
		[INFO] Loaded 3546 samples from './data/battery_demand/tol26/case3_extended_generated'
		[INFO] Found checkpoint: './data/optimization_results/tol26/case3_extended_generated/optimization_checkpoint.npz'
		[INFO] Resuming from iteration 2640
		[INFO] Processing optimization series:   0%|                          | 0/906 [00:00<?, ?series/s]		[INFO] Processing optimization series:   0%|                  | 1/906 [00:02<42:45,  2.83s/series]		[INFO] Processing optimization series:   0%|                  | 2/906 [00:04<28:37,  1.90s/series]		[INFO] Processing optimization series:   0%|                  | 3/906 [00:06<35:21,  2.35s/series]		[INFO] Processing optimization series:   0%|                  | 4/906 [00:08<27:45,  1.85s/series]		[INFO] Processing optimization series:   1%|                  | 5/906 [00:09<23:28,  1.56s/series]		[INFO] Processing optimization series:   1%|                  | 6/906 [00:10<20:59,  1.40s/series]		[INFO] Processing optimization series:   1%|▏                 | 7/906 [00:13<28:25,  1.90s/series]		[INFO] Processing optimization series:   1%|▏                 | 8/906 [00:14<25:15,  1.69s/series]		[INFO] Processing optimization series:   1%|▏                 | 9/906 [00:15<22:34,  1.51s/series]		[INFO] Processing optimization series:   1%|▏                | 10/906 [00:24<58:42,  3.93s/series]		[INFO] Processing optimization series:   1%|▏                | 11/906 [00:26<47:06,  3.16s/series]		[INFO] Processing optimization series:   1%|▏                | 12/906 [00:26<35:28,  2.38s/series]		[INFO] Processing optimization series:   1%|▏                | 13/906 [00:27<27:04,  1.82s/series]		[INFO] Processing optimization series:   2%|▎                | 14/906 [00:27<20:51,  1.40s/series]		[INFO] Processing optimization series:   2%|▎                | 15/906 [00:29<20:39,  1.39s/series]		[INFO] Processing optimization series:   2%|▎                | 16/906 [00:29<16:19,  1.10s/series]		[INFO] Processing optimization series:   2%|▎                | 17/906 [00:30<13:21,  1.11series/s]		[INFO] Processing optimization series:   2%|▎                | 18/906 [00:30<11:14,  1.32series/s]		[INFO] Processing optimization series:   2%|▎                | 19/906 [00:31<14:01,  1.05series/s]		[INFO] Processing optimization series:   2%|▍                | 20/906 [00:42<57:10,  3.87s/series]		[INFO] Processing optimization series:   2%|▍                | 21/906 [00:43<44:06,  2.99s/series]		[INFO] Processing optimization series:   2%|▍                | 22/906 [00:44<36:17,  2.46s/series]		[INFO] Processing optimization series:   3%|▍                | 23/906 [00:47<38:40,  2.63s/series]		[INFO] Processing optimization series:   3%|▍                | 24/906 [00:49<33:19,  2.27s/series]		[INFO] Processing optimization series:   3%|▍                | 25/906 [00:50<30:21,  2.07s/series]		[INFO] Processing optimization series:   3%|▍                | 26/906 [00:52<29:38,  2.02s/series]		[INFO] Processing optimization series:   3%|▌                | 27/906 [00:53<23:18,  1.59s/series]		[INFO] Processing optimization series:   3%|▌                | 28/906 [00:53<18:38,  1.27s/series]		[INFO] Processing optimization series:   3%|▌                | 29/906 [00:54<15:07,  1.04s/series]		[INFO] Processing optimization series:   3%|▌                | 30/906 [01:01<43:55,  3.01s/series]		[INFO] Processing optimization series:   3%|▌                | 31/906 [01:02<33:03,  2.27s/series]		[INFO] Processing optimization series:   4%|▌                | 32/906 [01:02<25:28,  1.75s/series]		[INFO] Processing optimization series:   4%|▌                | 33/906 [01:04<24:37,  1.69s/series]		[INFO] Processing optimization series:   4%|▋                | 34/906 [01:04<19:25,  1.34s/series]		[INFO] Processing optimization series:   4%|▋                | 35/906 [01:05<15:31,  1.07s/series]		[INFO] Processing optimization series:   4%|▋                | 36/906 [01:05<12:44,  1.14series/s]		[INFO] Processing optimization series:   4%|▋                | 37/906 [01:07<14:42,  1.02s/series]		[INFO] Processing optimization series:   4%|▋                | 38/906 [01:07<12:26,  1.16series/s]		[INFO] Processing optimization series:   4%|▋                | 39/906 [01:08<10:50,  1.33series/s]		[INFO] Processing optimization series:   4%|▊                | 40/906 [01:15<40:27,  2.80s/series]		[INFO] Processing optimization series:   5%|▊                | 41/906 [01:16<33:19,  2.31s/series]		[INFO] Processing optimization series:   5%|▊                | 42/906 [01:18<28:57,  2.01s/series]		[INFO] Processing optimization series:   5%|▊                | 43/906 [01:18<22:09,  1.54s/series]		[INFO] Processing optimization series:   5%|▊                | 44/906 [01:19<21:01,  1.46s/series]		[INFO] Processing optimization series:   5%|▊                | 45/906 [01:20<17:04,  1.19s/series]		[INFO] Processing optimization series:   5%|▊                | 46/906 [01:21<14:10,  1.01series/s]		[INFO] Processing optimization series:   5%|▉                | 47/906 [01:22<17:47,  1.24s/series]		[INFO] Processing optimization series:   5%|▉                | 48/906 [01:24<17:59,  1.26s/series]		[INFO] Processing optimization series:   5%|▉                | 49/906 [01:25<16:00,  1.12s/series]		[INFO] Processing optimization series:   6%|▉                | 50/906 [01:33<47:30,  3.33s/series]		[INFO] Processing optimization series:   6%|▉                | 51/906 [01:36<46:22,  3.25s/series]		[INFO] Processing optimization series:   6%|▉                | 52/906 [01:37<37:30,  2.64s/series]		[INFO] Processing optimization series:   6%|▉                | 53/906 [01:39<31:46,  2.24s/series]		[INFO] Processing optimization series:   6%|█                | 54/906 [01:41<33:53,  2.39s/series]		[INFO] Processing optimization series:   6%|█                | 55/906 [01:42<28:31,  2.01s/series]		[INFO] Processing optimization series:   6%|█                | 56/906 [01:43<22:07,  1.56s/series]		[INFO] Processing optimization series:   6%|█                | 57/906 [01:43<17:22,  1.23s/series]		[INFO] Processing optimization series:   6%|█                | 58/906 [01:45<19:02,  1.35s/series]		[INFO] Processing optimization series:   7%|█                | 59/906 [01:46<15:23,  1.09s/series]		[INFO] Processing optimization series:   7%|█▏               | 60/906 [01:53<42:33,  3.02s/series]		[INFO] Processing optimization series:   7%|█▏               | 61/906 [01:54<35:43,  2.54s/series]		[INFO] Processing optimization series:   7%|█▏               | 62/906 [01:55<26:56,  1.91s/series]		[INFO] Processing optimization series:   7%|█▏               | 63/906 [01:55<21:02,  1.50s/series]		[INFO] Processing optimization series:   7%|█▏               | 64/906 [01:56<16:56,  1.21s/series]		[INFO] Processing optimization series:   7%|█▏               | 65/906 [01:57<16:49,  1.20s/series]		[INFO] Processing optimization series:   7%|█▏               | 66/906 [01:58<13:47,  1.02series/s]		[INFO] Processing optimization series:   7%|█▎               | 67/906 [01:58<11:57,  1.17series/s]		[INFO] Processing optimization series:   8%|█▎               | 68/906 [02:00<13:56,  1.00series/s]		[INFO] Processing optimization series:   8%|█▎               | 69/906 [02:00<11:34,  1.21series/s]		[INFO] Processing optimization series:   8%|█▎               | 70/906 [02:08<42:57,  3.08s/series]		[INFO] Processing optimization series:   8%|█▎               | 71/906 [02:09<32:07,  2.31s/series]		[INFO] Processing optimization series:   8%|█▎               | 72/906 [02:10<27:52,  2.00s/series]		[INFO] Processing optimization series:   8%|█▎               | 73/906 [02:11<21:54,  1.58s/series]		[INFO] Processing optimization series:   8%|█▍               | 74/906 [02:11<17:33,  1.27s/series]		[INFO] Processing optimization series:   8%|█▍               | 75/906 [02:13<17:55,  1.29s/series]		[INFO] Processing optimization series:   8%|█▍               | 76/906 [02:13<14:26,  1.04s/series]		[INFO] Processing optimization series:   8%|█▍               | 77/906 [02:13<12:02,  1.15series/s]		[INFO] Processing optimization series:   9%|█▍               | 78/906 [02:14<10:24,  1.33series/s]		[INFO] Processing optimization series:   9%|█▍               | 79/906 [02:15<12:38,  1.09series/s]		[INFO] Processing optimization series:   9%|█▌               | 80/906 [02:22<38:21,  2.79s/series]		[INFO] Processing optimization series:   9%|█▌               | 81/906 [02:23<29:41,  2.16s/series]		[INFO] Processing optimization series:   9%|█▌               | 82/906 [02:24<26:17,  1.91s/series]		[INFO] Processing optimization series:   9%|█▌               | 83/906 [02:26<25:27,  1.86s/series]		[INFO] Processing optimization series:   9%|█▌               | 84/906 [02:27<19:47,  1.44s/series]		[INFO] Processing optimization series:   9%|█▌               | 85/906 [02:27<15:46,  1.15s/series]		[INFO] Processing optimization series:   9%|█▌               | 86/906 [02:29<18:26,  1.35s/series]		[INFO] Processing optimization series:  10%|█▋               | 87/906 [02:29<15:01,  1.10s/series]		[INFO] Processing optimization series:  10%|█▋               | 88/906 [02:30<12:49,  1.06series/s]		[INFO] Processing optimization series:  10%|█▋               | 89/906 [02:31<13:50,  1.02s/series]		[INFO] Processing optimization series:  10%|█▋               | 90/906 [02:39<42:26,  3.12s/series]		[INFO] Processing optimization series:  10%|█▋               | 91/906 [02:40<31:40,  2.33s/series]		[INFO] Processing optimization series:  10%|█▋               | 92/906 [02:40<24:03,  1.77s/series]		[INFO] Processing optimization series:  10%|█▋               | 93/906 [02:42<24:14,  1.79s/series]		[INFO] Processing optimization series:  10%|█▊               | 94/906 [02:43<18:58,  1.40s/series]		[INFO] Processing optimization series:  10%|█▊               | 95/906 [02:43<15:18,  1.13s/series]		[INFO] Processing optimization series:  11%|█▊               | 96/906 [02:43<12:28,  1.08series/s]		[INFO] Processing optimization series:  11%|█▊               | 97/906 [02:45<13:31,  1.00s/series]		[INFO] Processing optimization series:  11%|█▊               | 98/906 [02:45<11:27,  1.18series/s]		[INFO] Processing optimization series:  11%|█▊               | 99/906 [02:46<09:59,  1.35series/s]		[INFO] Processing optimization series:  11%|█▊              | 100/906 [02:53<38:34,  2.87s/series]		[INFO] Processing optimization series:  11%|█▊              | 101/906 [02:54<30:14,  2.25s/series]		[INFO] Processing optimization series:  11%|█▊              | 102/906 [02:55<22:49,  1.70s/series]		[INFO] Processing optimization series:  11%|█▊              | 103/906 [02:55<17:40,  1.32s/series]		[INFO] Processing optimization series:  11%|█▊              | 104/906 [02:56<17:17,  1.29s/series]		[INFO] Processing optimization series:  12%|█▊              | 105/906 [02:57<14:06,  1.06s/series]		[INFO] Processing optimization series:  12%|█▊              | 106/906 [02:57<11:53,  1.12series/s]		[INFO] Processing optimization series:  12%|█▉              | 107/906 [02:59<13:10,  1.01series/s]		[INFO] Processing optimization series:  12%|█▉              | 108/906 [02:59<11:11,  1.19series/s]		[INFO] Processing optimization series:  12%|█▉              | 109/906 [03:00<09:30,  1.40series/s]		[INFO] Processing optimization series:  12%|█▉              | 110/906 [03:07<34:43,  2.62s/series]		[INFO] Processing optimization series:  12%|█▉              | 111/906 [03:08<29:04,  2.19s/series]		[INFO] Processing optimization series:  12%|█▉              | 112/906 [03:08<22:16,  1.68s/series]		[INFO] Processing optimization series:  12%|█▉              | 113/906 [03:09<17:13,  1.30s/series]		[INFO] Processing optimization series:  13%|██              | 114/906 [03:09<13:43,  1.04s/series]		[INFO] Processing optimization series:  13%|██              | 115/906 [03:11<17:54,  1.36s/series]		[INFO] Processing optimization series:  13%|██              | 116/906 [03:12<14:36,  1.11s/series]		[INFO] Processing optimization series:  13%|██              | 117/906 [03:12<12:02,  1.09series/s]		[INFO] Processing optimization series:  13%|██              | 118/906 [03:13<10:11,  1.29series/s]		[INFO] Processing optimization series:  13%|██              | 119/906 [03:14<12:22,  1.06series/s]		[INFO] Processing optimization series:  13%|██              | 120/906 [03:21<38:02,  2.90s/series]		[INFO] Processing optimization series:  13%|██▏             | 121/906 [03:22<28:39,  2.19s/series]		[INFO] Processing optimization series:  13%|██▏             | 122/906 [03:23<24:28,  1.87s/series]		[INFO] Processing optimization series:  14%|██▏             | 123/906 [03:24<18:48,  1.44s/series]		[INFO] Processing optimization series:  14%|██▏             | 124/906 [03:24<14:55,  1.14s/series]		[INFO] Processing optimization series:  14%|██▏             | 125/906 [03:25<12:32,  1.04series/s]		[INFO] Processing optimization series:  14%|██▏             | 126/906 [03:26<13:50,  1.07s/series]		[INFO] Processing optimization series:  14%|██▏             | 127/906 [03:26<11:33,  1.12series/s]		[INFO] Processing optimization series:  14%|██▎             | 128/906 [03:27<09:42,  1.34series/s]		[INFO] Processing optimization series:  14%|██▎             | 129/906 [03:27<08:37,  1.50series/s]		[INFO] Processing optimization series:  14%|██▎             | 130/906 [03:35<35:32,  2.75s/series]		[INFO] Processing optimization series:  14%|██▎             | 131/906 [03:35<27:04,  2.10s/series]		[INFO] Processing optimization series:  15%|██▎             | 132/906 [03:36<20:36,  1.60s/series]		[INFO] Processing optimization series:  15%|██▎             | 133/906 [03:37<20:09,  1.56s/series]		[INFO] Processing optimization series:  15%|██▎             | 134/906 [03:38<15:51,  1.23s/series]		[INFO] Processing optimization series:  15%|██▍             | 135/906 [03:38<12:53,  1.00s/series]		[INFO] Processing optimization series:  15%|██▍             | 136/906 [03:39<10:35,  1.21series/s]                                                                                                                                                                                                                                                                                                                                 