Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at './data/battery_demand/tol25/resample_full.csv' and './data/battery_demand/tol25/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1377, 37)
		[INFO] Number of seeds ready for Case 3  = (2000, 36)

		[INFO] Case 1 exists — loaded battery demand from './data/battery_demand/tol25/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists — loaded battery demand from './data/battery_demand/tol25/case2_nan_filled/battery_demand.npy' with shape (1545, 37).
		[INFO] Case 3 exists — loaded battery demand from './data/battery_demand/tol25/case3_extended_generated/battery_demand.npy' with shape (3545, 37).

	1.6 Generating battery schedule...
		[INFO] Case 1 exists — loaded from './data/battery_demand/tol25/case1_real_only/battery_availability.npy' and './data/battery_demand/tol25/case1_real_only/battery_details.npy' shape (168, 263, 36) and (4, 168, 263)
		[INFO] Case 2 exists — loaded from './data/battery_demand/tol25/case2_nan_filled/battery_availability.npy' and './data/battery_demand/tol25/case2_nan_filled/battery_details.npy' shape (1545, 311, 36) and (4, 1545, 311)
		[INFO] Case 3 exists — loaded from './data/battery_demand/tol25/case3_extended_generated/battery_availability.npy' and './data/battery_demand/tol25/case3_extended_generated/battery_details.npy' shape (3545, 422, 36) and (4, 3545, 422)


==================================================
PART 2: MILP Optimization...
==================================================

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from './data/battery_demand/tol25/case1_real_only'
		[INFO] Results already exist at './data/optimization_results/tol25/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol25/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1545 samples from './data/battery_demand/tol25/case2_nan_filled'
		[INFO] Results already exist at './data/optimization_results/tol25/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol25/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 2 completed.

	2.3 Optimizing Case 3...
		[INFO] Loaded 3545 samples from './data/battery_demand/tol25/case3_extended_generated'
		[INFO] Found checkpoint: './data/optimization_results/tol25/case3_extended_generated/optimization_checkpoint.npz'
		[INFO] Resuming from iteration 2920
		[INFO] Processing optimization series:   0%|                          | 0/625 [00:00<?, ?series/s]		[INFO] Processing optimization series:   0%|                  | 1/625 [00:03<32:27,  3.12s/series]		[INFO] Processing optimization series:   0%|                  | 2/625 [00:04<20:55,  2.02s/series]		[INFO] Processing optimization series:   0%|                  | 3/625 [00:07<24:57,  2.41s/series]		[INFO] Processing optimization series:   1%|                  | 4/625 [00:08<19:50,  1.92s/series]		[INFO] Processing optimization series:   1%|▏                 | 5/625 [00:09<16:59,  1.65s/series]		[INFO] Processing optimization series:   1%|▏                 | 6/625 [00:10<16:08,  1.56s/series]		[INFO] Processing optimization series:   1%|▏                 | 7/625 [00:14<22:43,  2.21s/series]		[INFO] Processing optimization series:   1%|▏                 | 8/625 [00:15<19:26,  1.89s/series]		[INFO] Processing optimization series:   1%|▎                 | 9/625 [00:16<17:14,  1.68s/series]		[INFO] Processing optimization series:   2%|▏              | 10/625 [00:32<1:02:36,  6.11s/series]		[INFO] Processing optimization series:   2%|▎                | 11/625 [00:34<47:44,  4.66s/series]		[INFO] Processing optimization series:   2%|▎                | 12/625 [00:35<37:46,  3.70s/series]		[INFO] Processing optimization series:   2%|▎                | 13/625 [00:37<30:13,  2.96s/series]		[INFO] Processing optimization series:   2%|▍                | 14/625 [00:40<30:17,  2.97s/series]		[INFO] Processing optimization series:   2%|▍                | 15/625 [00:41<25:27,  2.50s/series]		[INFO] Processing optimization series:   3%|▍                | 16/625 [00:42<21:56,  2.16s/series]		[INFO] Processing optimization series:   3%|▍                | 17/625 [00:45<24:23,  2.41s/series]		[INFO] Processing optimization series:   3%|▍                | 18/625 [00:47<20:57,  2.07s/series]		[INFO] Processing optimization series:   3%|▌                | 19/625 [00:48<18:13,  1.80s/series]		[INFO] Processing optimization series:   3%|▌                | 20/625 [01:02<54:43,  5.43s/series]		[INFO] Processing optimization series:   3%|▌                | 21/625 [01:05<49:16,  4.90s/series]		[INFO] Processing optimization series:   4%|▌                | 22/625 [01:06<37:33,  3.74s/series]		[INFO] Processing optimization series:   4%|▋                | 23/625 [01:08<30:24,  3.03s/series]		[INFO] Processing optimization series:   4%|▋                | 24/625 [01:11<31:47,  3.17s/series]		[INFO] Processing optimization series:   4%|▋                | 25/625 [01:12<25:27,  2.55s/series]		[INFO] Processing optimization series:   4%|▋                | 26/625 [01:13<20:53,  2.09s/series]		[INFO] Processing optimization series:   4%|▋                | 27/625 [01:15<18:35,  1.87s/series]		[INFO] Processing optimization series:   4%|▊                | 28/625 [01:17<20:06,  2.02s/series]		[INFO] Processing optimization series:   5%|▊                | 29/625 [01:18<15:34,  1.57s/series]		[INFO] Processing optimization series:   5%|▊                | 30/625 [01:26<35:54,  3.62s/series]		[INFO] Processing optimization series:   5%|▊                | 31/625 [01:27<28:38,  2.89s/series]		[INFO] Processing optimization series:   5%|▊                | 32/625 [01:30<27:08,  2.75s/series]		[INFO] Processing optimization series:   5%|▉                | 33/625 [01:30<20:28,  2.08s/series]		[INFO] Processing optimization series:   5%|▉                | 34/625 [01:31<15:40,  1.59s/series]		[INFO] Processing optimization series:   6%|▉                | 35/625 [01:31<12:35,  1.28s/series]		[INFO] Processing optimization series:   6%|▉                | 36/625 [01:33<12:57,  1.32s/series]		[INFO] Processing optimization series:   6%|█                | 37/625 [01:33<10:48,  1.10s/series]		[INFO] Processing optimization series:   6%|█                | 38/625 [01:34<08:56,  1.10series/s]		[INFO] Processing optimization series:   6%|█                | 39/625 [01:35<09:49,  1.01s/series]		[INFO] Processing optimization series:   6%|█                | 40/625 [01:42<28:59,  2.97s/series]		[INFO] Processing optimization series:   7%|█                | 41/625 [01:43<22:17,  2.29s/series]		[INFO] Processing optimization series:   7%|█▏               | 42/625 [01:44<16:57,  1.75s/series]		[INFO] Processing optimization series:   7%|█▏               | 43/625 [01:45<15:26,  1.59s/series]		[INFO] Processing optimization series:   7%|█▏               | 44/625 [01:45<12:13,  1.26s/series]		[INFO] Processing optimization series:   7%|█▏               | 45/625 [01:46<09:48,  1.01s/series]		[INFO] Processing optimization series:   7%|█▎               | 46/625 [01:47<10:36,  1.10s/series]		[INFO] Processing optimization series:   8%|█▎               | 47/625 [01:48<08:41,  1.11series/s]		[INFO] Processing optimization series:   8%|█▎               | 48/625 [01:48<07:19,  1.31series/s]		[INFO] Processing optimization series:   8%|█▎               | 49/625 [01:48<06:28,  1.48series/s]		[INFO] Processing optimization series:   8%|█▎               | 50/625 [01:57<28:21,  2.96s/series]		[INFO] Processing optimization series:   8%|█▍               | 51/625 [01:57<21:40,  2.27s/series]		[INFO] Processing optimization series:   8%|█▍               | 52/625 [01:58<16:30,  1.73s/series]		[INFO] Processing optimization series:   8%|█▍               | 53/625 [01:58<13:00,  1.37s/series]		[INFO] Processing optimization series:   9%|█▍               | 54/625 [02:00<13:27,  1.41s/series]		[INFO] Processing optimization series:   9%|█▍               | 55/625 [02:00<10:48,  1.14s/series]		[INFO] Processing optimization series:   9%|█▌               | 56/625 [02:01<09:30,  1.00s/series]		[INFO] Processing optimization series:   9%|█▌               | 57/625 [02:03<11:09,  1.18s/series]		[INFO] Processing optimization series:   9%|█▌               | 58/625 [02:03<09:09,  1.03series/s]		[INFO] Processing optimization series:   9%|█▌               | 59/625 [02:04<07:43,  1.22series/s]		[INFO] Processing optimization series:  10%|█▋               | 60/625 [02:12<27:43,  2.94s/series]		[INFO] Processing optimization series:  10%|█▋               | 61/625 [02:15<28:06,  2.99s/series]		[INFO] Processing optimization series:  10%|█▋               | 62/625 [02:16<22:53,  2.44s/series]		[INFO] Processing optimization series:  10%|█▋               | 63/625 [02:17<19:36,  2.09s/series]		[INFO] Processing optimization series:  10%|█▋               | 64/625 [02:18<16:40,  1.78s/series]		[INFO] Processing optimization series:  10%|█▊               | 65/625 [02:21<18:44,  2.01s/series]		[INFO] Processing optimization series:  11%|█▊               | 66/625 [02:22<16:04,  1.73s/series]		[INFO] Processing optimization series:  11%|█▊               | 67/625 [02:23<14:48,  1.59s/series]		[INFO] Processing optimization series:  11%|█▊               | 68/625 [02:26<18:03,  1.95s/series]		[INFO] Processing optimization series:  11%|█▉               | 69/625 [02:27<15:43,  1.70s/series]		[INFO] Processing optimization series:  11%|█▉               | 70/625 [02:38<42:55,  4.64s/series]		[INFO] Processing optimization series:  11%|█▉               | 71/625 [02:39<32:34,  3.53s/series]		[INFO] Processing optimization series:  12%|█▉               | 72/625 [02:42<29:01,  3.15s/series]		[INFO] Processing optimization series:  12%|█▉               | 73/625 [02:43<23:52,  2.60s/series]		[INFO] Processing optimization series:  12%|██               | 74/625 [02:44<19:34,  2.13s/series]		[INFO] Processing optimization series:  12%|██               | 75/625 [02:45<15:19,  1.67s/series]		[INFO] Processing optimization series:  12%|██               | 76/625 [02:48<19:12,  2.10s/series]		[INFO] Processing optimization series:  12%|██               | 77/625 [02:49<16:18,  1.79s/series]		[INFO] Processing optimization series:  12%|██               | 78/625 [02:50<15:23,  1.69s/series]		[INFO] Processing optimization series:  13%|██▏              | 79/625 [02:53<19:24,  2.13s/series]		[INFO] Processing optimization series:  13%|██▏              | 80/625 [03:06<48:03,  5.29s/series]		[INFO] Processing optimization series:  13%|██▏              | 81/625 [03:07<35:04,  3.87s/series]		[INFO] Processing optimization series:  13%|██▏              | 82/625 [03:07<25:54,  2.86s/series]		[INFO] Processing optimization series:  13%|██▎              | 83/625 [03:08<21:45,  2.41s/series]		[INFO] Processing optimization series:  13%|██▎              | 84/625 [03:09<16:51,  1.87s/series]		[INFO] Processing optimization series:  14%|██▎              | 85/625 [03:09<12:56,  1.44s/series]		[INFO] Processing optimization series:  14%|██▎              | 86/625 [03:11<12:17,  1.37s/series]		[INFO] Processing optimization series:  14%|██▎              | 87/625 [03:11<09:46,  1.09s/series]		[INFO] Processing optimization series:  14%|██▍              | 88/625 [03:12<08:17,  1.08series/s]		[INFO] Processing optimization series:  14%|██▍              | 89/625 [03:12<07:05,  1.26series/s]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               