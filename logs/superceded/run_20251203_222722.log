nohup: ignoring input
Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at 'data/battery_demand/resample_full.csv' and 'data/battery_demand/resample_train.csv'

		[INFO] Number of series for clean windows = (110, 49)
		[INFO] Number of eligible series for Case 2 = (1373, 49)
		[INFO] Case 1 exists — loaded battery demand from 'data/battery_demand/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists — loaded battery demand from 'data/battery_demand/case2_nan_filled/battery_demand.npy' with shape (1563, 37).
		[INFO] Case 0: Successfully added test pair 2024-03-15 & 2024-03-16
		Data: [10536, 28, 30, 35, 37, 37, 36, 33, 26, 10, 6, 10, 14, 19, 18, 15, 20, 26, 15, 9, 16, 21, 20, 8, 12, 15, 24, 31, 35, 32, 35, 34, 32, 31, 30, 22, 14, 18, 27, 18, 19, 19, 25, 25, 25, 26, 27, 17, 19]
		[INFO] Case 0: Successfully added test pair 2024-03-29 & 2024-03-30
		Data: [10872, 13, 26, 31, 33, 33, 33, 31, 15, 8, 19, 11, 15, 18, 16, 18, 18, 19, 7, 4, 23, 23, 16, 17, 18, 18, 19, 24, 29, 30, 30, 22, 27, 21, 14, 15, 16, 20, 18, 23, 27, 18, 2, 10, 23, 22, 22, 17, 21]

	1.6 Generating battery schedule...
		[INFO] Case 1 exists — loaded from 'data/battery_demand/case1_real_only/battery_availability.npy' and 'data/battery_demand/case1_real_only/battery_details.npy' shape (168, 385, 36) and (4, 168, 385)
		[INFO] Case 2 exists — loaded from 'data/battery_demand/case2_nan_filled/battery_availability.npy' and 'data/battery_demand/case2_nan_filled/battery_details.npy' shape (1563, 385, 36) and (4, 1563, 385)
[ERROR] Could not load battery demand from 'data/battery_demand/case3_extended_generated/battery_demand.npy': [Errno 2] No such file or directory: 'data/battery_demand/case3_extended_generated/battery_demand.npy'


==================================================
PART 2: MILP Optimization...
==================================================

	2.2 Optimizing Case 2...
		[INFO] Loaded 1563 samples from 'data/battery_demand/case2_nan_filled'
		[INFO] Results already exist at './data/optimization_results/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at './data/optimization_results/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 2 completed.

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from 'data/battery_demand/case1_real_only'
		[INFO] Results already exist at './data/optimization_results/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at './data/optimization_results/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 1 completed.


==================================================
PART 3: Supervised Learning...
==================================================

	3.2 Training Case 2...

=== Starting Training Run: STAFV4_CASE2 ===
Device: cuda
		[INFO] Starting Preprocessing for Case 2...
		[INFO] Unique quantized indices: 28274
		[INFO] Suggested num_embeddings: 33928
		[INFO] Generating sliding windows...
		[INFO] Saved dataset: ./data/training_results/STAFV4_CASE2/merged_dataset_STAFV4_CASE2.csv (Shape: (18756, 201))
		[INFO] Saved metadata: ./data/training_results/STAFV4_CASE2/feature_info_STAFV4_CASE2.json
	[Model Config] Detected Dims: {'static': 4, 'series_count': 5, 'seq_len': 24, 'vehicle': 76, 'emb_vocab': 33928}
		[INFO] Data loaded. Train: 13129, Val: 5627
		[INFO] Fitting new scalers on training data...

		[INFO]Epoch |    LR    | Trn RMSE | Val RMSE | Trn R2 | Val R2 | Stop
-----------------------------------------------------------------
		[INFO]    1 | 0.001000 |   9.4161 |   7.5959 | -0.700 | -0.102 | 0/150
		[INFO]    2 | 0.001000 |   6.3732 |   4.8905 |  0.222 |  0.543 | 0/150
		[INFO]    3 | 0.001000 |   4.8472 |   4.2494 |  0.550 |  0.655 | 0/150
		[INFO]    4 | 0.001000 |   4.4525 |   3.8649 |  0.621 |  0.715 | 0/150
		[INFO]    5 | 0.001000 |   4.2268 |   3.7242 |  0.657 |  0.735 | 0/150
		[INFO]    6 | 0.001000 |   4.0618 |   3.6583 |  0.685 |  0.744 | 0/150
		[INFO]    7 | 0.001000 |   3.9911 |   3.6329 |  0.695 |  0.748 | 0/150
		[INFO]    8 | 0.001000 |   3.9072 |   3.5822 |  0.708 |  0.755 | 0/150
		[INFO]    9 | 0.001000 |   3.7670 |   3.5478 |  0.729 |  0.760 | 0/150
		[INFO]   10 | 0.001000 |   3.6614 |   3.5961 |  0.744 |  0.753 | 0/150
		[INFO]   11 | 0.001000 |   3.5488 |   3.5944 |  0.759 |  0.753 | 1/150
		[INFO]   12 | 0.001000 |   3.5078 |   3.6116 |  0.765 |  0.751 | 2/150
		[INFO]   13 | 0.001000 |   3.3971 |   3.6283 |  0.779 |  0.748 | 3/150
		[INFO]   14 | 0.001000 |   3.3845 |   3.6044 |  0.781 |  0.752 | 4/150
		[INFO]   15 | 0.001000 |   3.2949 |   3.6247 |  0.792 |  0.749 | 5/150
		[INFO]   16 | 0.001000 |   3.2480 |   3.6378 |  0.798 |  0.747 | 6/150
		[INFO]   17 | 0.001000 |   3.1917 |   3.6502 |  0.805 |  0.745 | 7/150
		[INFO]   18 | 0.001000 |   3.1355 |   3.6473 |  0.812 |  0.746 | 8/150
		[INFO]   19 | 0.001000 |   3.1116 |   3.6365 |  0.815 |  0.747 | 9/150
		[INFO]   20 | 0.001000 |   3.0542 |   3.6403 |  0.821 |  0.747 | 10/150
		[INFO]   21 | 0.001000 |   3.0172 |   3.6925 |  0.826 |  0.740 | 11/150
		[INFO]   22 | 0.001000 |   2.9599 |   3.7019 |  0.832 |  0.738 | 12/150
		[INFO]   23 | 0.001000 |   2.9348 |   3.6781 |  0.835 |  0.742 | 13/150
		[INFO]   24 | 0.001000 |   2.9679 |   3.6992 |  0.832 |  0.739 | 14/150
		[INFO]   25 | 0.001000 |   2.9246 |   3.7875 |  0.837 |  0.726 | 15/150
		[INFO]   26 | 0.001000 |   2.9032 |   3.7781 |  0.838 |  0.727 | 16/150
		[INFO]   27 | 0.001000 |   2.8392 |   3.7853 |  0.846 |  0.726 | 17/150
		[INFO]   28 | 0.001000 |   2.7907 |   3.8657 |  0.851 |  0.715 | 18/150
		[INFO]   29 | 0.001000 |   2.8077 |   3.8512 |  0.849 |  0.717 | 19/150
		[INFO]   30 | 0.001000 |   2.7842 |   3.8623 |  0.852 |  0.715 | 20/150
		[INFO]   31 | 0.001000 |   2.7308 |   3.8218 |  0.858 |  0.721 | 21/150
		[INFO]   32 | 0.001000 |   2.6934 |   3.9033 |  0.861 |  0.709 | 22/150
		[INFO]   33 | 0.001000 |   2.6919 |   3.8632 |  0.861 |  0.715 | 23/150
		[INFO]   34 | 0.001000 |   2.6893 |   3.8591 |  0.862 |  0.716 | 24/150
		[INFO]   35 | 0.001000 |   2.6822 |   3.9159 |  0.862 |  0.707 | 25/150
		[INFO]   36 | 0.000750 |   2.6124 |   3.9289 |  0.869 |  0.705 | 26/150
		[INFO]   37 | 0.000750 |   2.6258 |   3.9360 |  0.868 |  0.704 | 27/150
		[INFO]   38 | 0.000750 |   2.6097 |   3.9097 |  0.870 |  0.708 | 28/150
		[INFO]   39 | 0.000750 |   2.6125 |   3.8910 |  0.869 |  0.711 | 29/150
		[INFO]   40 | 0.000750 |   2.5548 |   3.9010 |  0.875 |  0.709 | 30/150
		[INFO]   41 | 0.000750 |   2.5969 |   3.8984 |  0.871 |  0.710 | 31/150
		[INFO]   42 | 0.000750 |   2.5349 |   4.0136 |  0.877 |  0.692 | 32/150
		[INFO]   43 | 0.000750 |   2.5795 |   3.9485 |  0.873 |  0.702 | 33/150
		[INFO]   44 | 0.000750 |   2.5598 |   4.0176 |  0.875 |  0.692 | 34/150
		[INFO]   45 | 0.000750 |   2.5262 |   3.9620 |  0.878 |  0.700 | 35/150
		[INFO]   46 | 0.000750 |   2.5398 |   3.9991 |  0.877 |  0.695 | 36/150
		[INFO]   47 | 0.000750 |   2.4813 |   4.0173 |  0.882 |  0.692 | 37/150
		[INFO]   48 | 0.000750 |   2.5132 |   3.9957 |  0.879 |  0.695 | 38/150
		[INFO]   49 | 0.000750 |   2.5276 |   4.0543 |  0.878 |  0.686 | 39/150
		[INFO]   50 | 0.000750 |   2.5286 |   4.0304 |  0.878 |  0.690 | 40/150
		[INFO]   51 | 0.000750 |   2.4439 |   4.0326 |  0.886 |  0.689 | 41/150
		[INFO]   52 | 0.000750 |   2.4314 |   3.9834 |  0.887 |  0.697 | 42/150
		[INFO]   53 | 0.000750 |   2.5042 |   3.9875 |  0.880 |  0.696 | 43/150
		[INFO]   54 | 0.000750 |   2.4966 |   3.9660 |  0.881 |  0.700 | 44/150
		[INFO]   55 | 0.000750 |   2.4513 |   4.0103 |  0.885 |  0.693 | 45/150
