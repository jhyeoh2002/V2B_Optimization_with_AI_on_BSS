nohup: ignoring input
Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at 'data/battery_demand/resample_full.csv' and 'data/battery_demand/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1395, 37)
		[INFO] Case 1 exists — loaded battery demand from 'data/battery_demand/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists — loaded battery demand from 'data/battery_demand/case2_nan_filled/battery_demand.npy' with shape (1563, 37).
		[INFO] Case 0: Successfully added test pair 2024-03-15 & 2024-03-16
		Data: [10536, 28, 30, 35, 37, 37, 36, 33, 26, 10, 6, 10, 14, 19, 18, 15, 20, 26, 15, 9, 16, 21, 20, 8, 12, 15, 24, 31, 35, 32, 35, 34, 32, 31, 30, 22, 14, 18, 27, 18, 19, 19, 25, 25, 25, 26, 27, 17, 19]
		[INFO] Case 0: Successfully added test pair 2024-03-29 & 2024-03-30
		Data: [10872, 13, 26, 31, 33, 33, 33, 31, 15, 8, 19, 11, 15, 18, 16, 18, 18, 19, 7, 4, 23, 23, 16, 17, 18, 18, 19, 24, 29, 30, 30, 22, 27, 21, 14, 15, 16, 20, 18, 23, 27, 18, 2, 10, 23, 22, 22, 17, 21]

	1.6 Generating battery schedule...
		[INFO] Case 1 exists — loaded from 'data/battery_demand/case1_real_only/battery_availability.npy' and 'data/battery_demand/case1_real_only/battery_details.npy' shape (168, 385, 36) and (4, 168, 385)
		[INFO] Case 2 exists — loaded from 'data/battery_demand/case2_nan_filled/battery_availability.npy' and 'data/battery_demand/case2_nan_filled/battery_details.npy' shape (1563, 385, 36) and (4, 1563, 385)
[ERROR] Could not load battery demand from 'data/battery_demand/case3_extended_generated/battery_demand.npy': [Errno 2] No such file or directory: 'data/battery_demand/case3_extended_generated/battery_demand.npy'


==================================================
PART 2: MILP Optimization...
==================================================

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from 'data/battery_demand/case1_real_only'
		[INFO] Starting fresh run: mode=optimization
		[INFO] Processing optimization series:   0%|                          | 0/168 [00:00<?, ?series/s]		[INFO] Processing optimization series:   1%|                  | 1/168 [00:00<02:05,  1.33series/s]		[INFO] Processing optimization series:   1%|▏                 | 2/168 [00:01<01:58,  1.40series/s]		[INFO] Processing optimization series:   2%|▎                 | 3/168 [00:02<01:55,  1.43series/s]		[INFO] Processing optimization series:   2%|▍                 | 4/168 [00:02<01:56,  1.41series/s]		[INFO] Processing optimization series:   3%|▌                 | 5/168 [00:03<01:52,  1.45series/s]		[INFO] Processing optimization series:   4%|▋                 | 6/168 [00:04<01:50,  1.47series/s]		[INFO] Processing optimization series:   4%|▊                 | 7/168 [00:04<01:50,  1.45series/s]		[INFO] Processing optimization series:   5%|▊                 | 8/168 [00:05<01:48,  1.47series/s]		[INFO] Processing optimization series:   5%|▉                 | 9/168 [00:06<01:47,  1.48series/s]		[INFO] Processing optimization series:   6%|█                | 10/168 [00:06<01:49,  1.44series/s]		[INFO] Processing optimization series:   7%|█                | 11/168 [00:07<01:48,  1.44series/s]		[INFO] Processing optimization series:   7%|█▏               | 12/168 [00:08<01:48,  1.43series/s]		[INFO] Processing optimization series:   8%|█▎               | 13/168 [00:09<01:47,  1.44series/s]		[INFO] Processing optimization series:   8%|█▍               | 14/168 [00:09<01:42,  1.51series/s]		[INFO] Processing optimization series:   9%|█▌               | 15/168 [00:10<01:37,  1.57series/s]		[INFO] Processing optimization series:  10%|█▌               | 16/168 [00:10<01:35,  1.59series/s]		[INFO] Processing optimization series:  10%|█▋               | 17/168 [00:11<01:32,  1.63series/s]		[INFO] Processing optimization series:  11%|█▊               | 18/168 [00:11<01:31,  1.63series/s]		[INFO] Processing optimization series:  11%|█▉               | 19/168 [00:12<01:28,  1.69series/s]		[INFO] Processing optimization series:  12%|██               | 20/168 [00:13<01:26,  1.72series/s]		[INFO] Processing optimization series:  12%|██▏              | 21/168 [00:13<01:26,  1.71series/s]		[INFO] Processing optimization series:  13%|██▏              | 22/168 [00:14<01:23,  1.74series/s]		[INFO] Processing optimization series:  14%|██▎              | 23/168 [00:14<01:21,  1.77series/s]		[INFO] Processing optimization series:  14%|██▍              | 24/168 [00:15<01:22,  1.75series/s]		[INFO] Processing optimization series:  15%|██▌              | 25/168 [00:15<01:19,  1.80series/s]		[INFO] Processing optimization series:  15%|██▋              | 26/168 [00:16<01:17,  1.83series/s]		[INFO] Processing optimization series:  16%|██▋              | 27/168 [00:17<01:19,  1.77series/s]		[INFO] Processing optimization series:  17%|██▊              | 28/168 [00:17<01:18,  1.79series/s]		[INFO] Processing optimization series:  17%|██▉              | 29/168 [00:18<01:17,  1.79series/s]		[INFO] Processing optimization series:  18%|███              | 30/168 [00:18<01:20,  1.70series/s]		[INFO] Processing optimization series:  18%|███▏             | 31/168 [00:19<01:19,  1.73series/s]		[INFO] Processing optimization series:  19%|███▏             | 32/168 [00:19<01:17,  1.75series/s]		[INFO] Processing optimization series:  20%|███▎             | 33/168 [00:20<01:19,  1.71series/s]		[INFO] Processing optimization series:  20%|███▍             | 34/168 [00:21<01:17,  1.73series/s]		[INFO] Processing optimization series:  21%|███▌             | 35/168 [00:21<01:15,  1.75series/s]		[INFO] Processing optimization series:  21%|███▋             | 36/168 [00:22<01:16,  1.74series/s]		[INFO] Processing optimization series:  22%|███▋             | 37/168 [00:22<01:14,  1.77series/s]		[INFO] Processing optimization series:  23%|███▊             | 38/168 [00:23<01:13,  1.76series/s]		[INFO] Processing optimization series:  23%|███▉             | 39/168 [00:23<01:14,  1.73series/s]		[INFO] Processing optimization series:  24%|████             | 40/168 [00:24<01:15,  1.70series/s]		[INFO] Processing optimization series:  24%|████▏            | 41/168 [00:25<01:13,  1.74series/s]		[INFO] Processing optimization series:  25%|████▎            | 42/168 [00:25<01:13,  1.70series/s]		[INFO] Processing optimization series:  26%|████▎            | 43/168 [00:26<01:12,  1.73series/s]		[INFO] Processing optimization series:  26%|████▍            | 44/168 [00:26<01:11,  1.74series/s]		[INFO] Processing optimization series:  27%|████▌            | 45/168 [00:27<01:13,  1.68series/s]		[INFO] Processing optimization series:  27%|████▋            | 46/168 [00:28<01:12,  1.69series/s]		[INFO] Processing optimization series:  28%|████▊            | 47/168 [00:28<01:11,  1.69series/s]		[INFO] Processing optimization series:  29%|████▊            | 48/168 [00:29<01:11,  1.68series/s]		[INFO] Processing optimization series:  29%|████▉            | 49/168 [00:29<01:09,  1.70series/s]		[INFO] Processing optimization series:  30%|█████            | 50/168 [00:30<01:11,  1.65series/s]		[INFO] Processing optimization series:  30%|█████▏           | 51/168 [00:30<01:08,  1.71series/s]		[INFO] Processing optimization series:  31%|█████▎           | 52/168 [00:31<01:06,  1.75series/s]		[INFO] Processing optimization series:  32%|█████▎           | 53/168 [00:32<01:06,  1.74series/s]		[INFO] Processing optimization series:  32%|█████▍           | 54/168 [00:32<01:04,  1.76series/s]		[INFO] Processing optimization series:  33%|█████▌           | 55/168 [00:33<01:04,  1.76series/s]		[INFO] Processing optimization series:  33%|█████▋           | 56/168 [00:33<01:05,  1.71series/s]		[INFO] Processing optimization series:  34%|█████▊           | 57/168 [00:34<01:04,  1.73series/s]		[INFO] Processing optimization series:  35%|█████▊           | 58/168 [00:34<01:02,  1.76series/s]		[INFO] Processing optimization series:  35%|█████▉           | 59/168 [00:35<01:02,  1.74series/s]		[INFO] Processing optimization series:  36%|██████           | 60/168 [00:36<01:03,  1.70series/s]		[INFO] Processing optimization series:  36%|██████▏          | 61/168 [00:36<01:01,  1.75series/s]		[INFO] Processing optimization series:  37%|██████▎          | 62/168 [00:37<01:00,  1.74series/s]		[INFO] Processing optimization series:  38%|██████▍          | 63/168 [00:37<00:59,  1.77series/s]		[INFO] Processing optimization series:  38%|██████▍          | 64/168 [00:38<00:57,  1.82series/s]		[INFO] Processing optimization series:  39%|██████▌          | 65/168 [00:38<00:57,  1.79series/s]		[INFO] Processing optimization series:  39%|██████▋          | 66/168 [00:39<00:56,  1.81series/s]		[INFO] Processing optimization series:  40%|██████▊          | 67/168 [00:40<00:56,  1.80series/s]		[INFO] Processing optimization series:  40%|██████▉          | 68/168 [00:40<00:56,  1.76series/s]		[INFO] Processing optimization series:  41%|██████▉          | 69/168 [00:41<00:56,  1.76series/s]		[INFO] Processing optimization series:  42%|███████          | 70/168 [00:41<00:57,  1.69series/s]		[INFO] Processing optimization series:  42%|███████▏         | 71/168 [00:42<00:57,  1.68series/s]		[INFO] Processing optimization series:  43%|███████▎         | 72/168 [00:42<00:56,  1.71series/s]		[INFO] Processing optimization series:  43%|███████▍         | 73/168 [00:43<00:55,  1.73series/s]		[INFO] Processing optimization series:  44%|███████▍         | 74/168 [00:44<00:55,  1.70series/s]		[INFO] Processing optimization series:  45%|███████▌         | 75/168 [00:44<00:53,  1.73series/s]		[INFO] Processing optimization series:  45%|███████▋         | 76/168 [00:45<00:52,  1.75series/s]		[INFO] Processing optimization series:  46%|███████▊         | 77/168 [00:45<00:52,  1.73series/s]		[INFO] Processing optimization series:  46%|███████▉         | 78/168 [00:46<00:51,  1.76series/s]		[INFO] Processing optimization series:  47%|███████▉         | 79/168 [00:47<00:50,  1.75series/s]		[INFO] Processing optimization series:  48%|████████         | 80/168 [00:47<00:51,  1.69series/s]		[INFO] Processing optimization series:  48%|████████▏        | 81/168 [00:48<00:49,  1.75series/s]		[INFO] Processing optimization series:  49%|████████▎        | 82/168 [00:48<00:49,  1.73series/s]		[INFO] Processing optimization series:  49%|████████▍        | 83/168 [00:49<00:48,  1.76series/s]		[INFO] Processing optimization series:  50%|████████▌        | 84/168 [00:49<00:46,  1.81series/s]		[INFO] Processing optimization series:  51%|████████▌        | 85/168 [00:50<00:46,  1.79series/s]		[INFO] Processing optimization series:  51%|████████▋        | 86/168 [00:50<00:45,  1.82series/s]		[INFO] Processing optimization series:  52%|████████▊        | 87/168 [00:51<00:44,  1.83series/s]		[INFO] Processing optimization series:  52%|████████▉        | 88/168 [00:52<00:44,  1.78series/s]		[INFO] Processing optimization series:  53%|█████████        | 89/168 [00:52<00:44,  1.77series/s]		[INFO] Processing optimization series:  54%|█████████        | 90/168 [00:53<00:46,  1.68series/s]		[INFO] Processing optimization series:  54%|█████████▏       | 91/168 [00:53<00:45,  1.68series/s]		[INFO] Processing optimization series:  55%|█████████▎       | 92/168 [00:54<00:44,  1.72series/s]		[INFO] Processing optimization series:  55%|█████████▍       | 93/168 [00:55<00:43,  1.73series/s]		[INFO] Processing optimization series:  56%|█████████▌       | 94/168 [00:55<00:43,  1.69series/s]		[INFO] Processing optimization series:  57%|█████████▌       | 95/168 [00:56<00:42,  1.71series/s]		[INFO] Processing optimization series:  57%|█████████▋       | 96/168 [00:56<00:43,  1.66series/s]		[INFO] Processing optimization series:  58%|█████████▊       | 97/168 [00:57<00:44,  1.60series/s]		[INFO] Processing optimization series:  58%|█████████▉       | 98/168 [00:58<00:42,  1.65series/s]		[INFO] Processing optimization series:  59%|██████████       | 99/168 [00:58<00:40,  1.70series/s]		[INFO] Processing optimization series:  60%|█████████▌      | 100/168 [00:59<00:42,  1.61series/s]		[INFO] Processing optimization series:  60%|█████████▌      | 101/168 [00:59<00:40,  1.67series/s]		[INFO] Processing optimization series:  61%|█████████▋      | 102/168 [01:00<00:39,  1.66series/s]		[INFO] Processing optimization series:  61%|█████████▊      | 103/168 [01:01<00:37,  1.71series/s]		[INFO] Processing optimization series:  62%|█████████▉      | 104/168 [01:01<00:36,  1.76series/s]		[INFO] Processing optimization series:  62%|██████████      | 105/168 [01:02<00:36,  1.74series/s]		[INFO] Processing optimization series:  63%|██████████      | 106/168 [01:02<00:35,  1.77series/s]		[INFO] Processing optimization series:  64%|██████████▏     | 107/168 [01:03<00:33,  1.80series/s]		[INFO] Processing optimization series:  64%|██████████▎     | 108/168 [01:03<00:33,  1.77series/s]		[INFO] Processing optimization series:  65%|██████████▍     | 109/168 [01:04<00:32,  1.81series/s]		[INFO] Processing optimization series:  65%|██████████▍     | 110/168 [01:04<00:33,  1.71series/s]		[INFO] Processing optimization series:  66%|██████████▌     | 111/168 [01:05<00:33,  1.69series/s]		[INFO] Processing optimization series:  67%|██████████▋     | 112/168 [01:06<00:32,  1.72series/s]		[INFO] Processing optimization series:  67%|██████████▊     | 113/168 [01:06<00:31,  1.75series/s]		[INFO] Processing optimization series:  68%|██████████▊     | 114/168 [01:07<00:31,  1.72series/s]		[INFO] Processing optimization series:  68%|██████████▉     | 115/168 [01:07<00:30,  1.72series/s]		[INFO] Processing optimization series:  69%|███████████     | 116/168 [01:08<00:30,  1.71series/s]		[INFO] Processing optimization series:  70%|███████████▏    | 117/168 [01:09<00:30,  1.67series/s]		[INFO] Processing optimization series:  70%|███████████▏    | 118/168 [01:09<00:29,  1.70series/s]		[INFO] Processing optimization series:  71%|███████████▎    | 119/168 [01:10<00:28,  1.72series/s]		[INFO] Processing optimization series:  71%|███████████▍    | 120/168 [01:10<00:30,  1.58series/s]		[INFO] Processing optimization series:  72%|███████████▌    | 121/168 [01:11<00:29,  1.60series/s]		[INFO] Processing optimization series:  73%|███████████▌    | 122/168 [01:12<00:27,  1.65series/s]		[INFO] Processing optimization series:  73%|███████████▋    | 123/168 [01:12<00:27,  1.65series/s]		[INFO] Processing optimization series:  74%|███████████▊    | 124/168 [01:13<00:25,  1.72series/s]		[INFO] Processing optimization series:  74%|███████████▉    | 125/168 [01:13<00:24,  1.77series/s]		[INFO] Processing optimization series:  75%|████████████    | 126/168 [01:14<00:24,  1.74series/s]		[INFO] Processing optimization series:  76%|████████████    | 127/168 [01:14<00:23,  1.77series/s]		[INFO] Processing optimization series:  76%|████████████▏   | 128/168 [01:15<00:22,  1.82series/s]		[INFO] Processing optimization series:  77%|████████████▎   | 129/168 [01:16<00:21,  1.80series/s]		[INFO] Processing optimization series:  77%|████████████▍   | 130/168 [01:16<00:22,  1.70series/s]		[INFO] Processing optimization series:  78%|████████████▍   | 131/168 [01:17<00:20,  1.77series/s]		[INFO] Processing optimization series:  79%|████████████▌   | 132/168 [01:17<00:20,  1.74series/s]		[INFO] Processing optimization series:  79%|████████████▋   | 133/168 [01:18<00:19,  1.78series/s]		[INFO] Processing optimization series:  80%|████████████▊   | 134/168 [01:18<00:18,  1.81series/s]		[INFO] Processing optimization series:  80%|████████████▊   | 135/168 [01:19<00:18,  1.74series/s]		[INFO] Processing optimization series:  81%|████████████▉   | 136/168 [01:20<00:18,  1.75series/s]		[INFO] Processing optimization series:  82%|█████████████   | 137/168 [01:20<00:18,  1.68series/s]		[INFO] Processing optimization series:  82%|█████████████▏  | 138/168 [01:21<00:17,  1.71series/s]		[INFO] Processing optimization series:  83%|█████████████▏  | 139/168 [01:21<00:16,  1.73series/s]		[INFO] Processing optimization series:  83%|█████████████▎  | 140/168 [01:22<00:17,  1.56series/s]		[INFO] Processing optimization series:  84%|█████████████▍  | 141/168 [01:23<00:16,  1.61series/s]		[INFO] Processing optimization series:  85%|█████████████▌  | 142/168 [01:23<00:15,  1.66series/s]		[INFO] Processing optimization series:  85%|█████████████▌  | 143/168 [01:24<00:15,  1.66series/s]		[INFO] Processing optimization series:  86%|█████████████▋  | 144/168 [01:24<00:14,  1.65series/s]		[INFO] Processing optimization series:  86%|█████████████▊  | 145/168 [01:25<00:13,  1.68series/s]		[INFO] Processing optimization series:  87%|█████████████▉  | 146/168 [01:26<00:13,  1.68series/s]		[INFO] Processing optimization series:  88%|██████████████  | 147/168 [01:26<00:12,  1.74series/s]		[INFO] Processing optimization series:  88%|██████████████  | 148/168 [01:27<00:11,  1.79series/s]		[INFO] Processing optimization series:  89%|██████████████▏ | 149/168 [01:27<00:10,  1.77series/s]		[INFO] Processing optimization series:  89%|██████████████▎ | 150/168 [01:28<00:10,  1.66series/s]		[INFO] Processing optimization series:  90%|██████████████▍ | 151/168 [01:28<00:09,  1.73series/s]		[INFO] Processing optimization series:  90%|██████████████▍ | 152/168 [01:29<00:09,  1.75series/s]		[INFO] Processing optimization series:  91%|██████████████▌ | 153/168 [01:30<00:08,  1.80series/s]		[INFO] Processing optimization series:  92%|██████████████▋ | 154/168 [01:30<00:07,  1.83series/s]		[INFO] Processing optimization series:  92%|██████████████▊ | 155/168 [01:31<00:07,  1.82series/s]		[INFO] Processing optimization series:  93%|██████████████▊ | 156/168 [01:31<00:06,  1.85series/s]		[INFO] Processing optimization series:  93%|██████████████▉ | 157/168 [01:32<00:05,  1.88series/s]		[INFO] Processing optimization series:  94%|███████████████ | 158/168 [01:32<00:05,  1.82series/s]		[INFO] Processing optimization series:  95%|███████████████▏| 159/168 [01:33<00:04,  1.84series/s]		[INFO] Processing optimization series:  95%|███████████████▏| 160/168 [01:33<00:04,  1.69series/s]		[INFO] Processing optimization series:  96%|███████████████▎| 161/168 [01:34<00:04,  1.70series/s]		[INFO] Processing optimization series:  96%|███████████████▍| 162/168 [01:35<00:03,  1.75series/s]		[INFO] Processing optimization series:  97%|███████████████▌| 163/168 [01:35<00:02,  1.81series/s]		[INFO] Processing optimization series:  98%|███████████████▌| 164/168 [01:36<00:02,  1.80series/s]		[INFO] Processing optimization series:  98%|███████████████▋| 165/168 [01:36<00:01,  1.84series/s]		[INFO] Processing optimization series:  99%|███████████████▊| 166/168 [01:37<00:01,  1.86series/s]		[INFO] Processing optimization series:  99%|███████████████▉| 167/168 [01:37<00:00,  1.82series/s]		[INFO] Processing optimization series: 100%|████████████████| 168/168 [01:38<00:00,  1.63series/s]		[INFO] Processing optimization series: 100%|████████████████| 168/168 [01:38<00:00,  1.70series/s]
		[INFO] Saving grid_demand results...
		[INFO] Saving pv_loss results...
		[INFO] Saving initial_demand results...
		[INFO] Saving charging_demand results...
		[INFO] Saving G2B results...
		[INFO] Saving P2B results...
		[INFO] Saving G2V results...
		[INFO] Saving P2V results...
		[INFO] Saving V2B results...
		[INFO] Saving SOC results...
		[INFO] Saving unmet results...
		[INFO] Saving objective_value results...
		[INFO] Saving optimization_time_s results...
		[INFO] Saving mip_gap_percent results...
		[INFO] Saving total_cost results...
		[INFO] Saving self_sufficiency results...
		[INFO] Saving pv_utilization results...
		[INFO] Deleted checkpoint after full completion.
		[INFO] Starting fresh run: mode=immediate_charging
		[INFO] Processing immediate_charging series:   0%|                    | 0/168 [00:00<?, ?series/s]		[INFO] Processing immediate_charging series:  11%|█▏        | 19/168 [00:00<00:00, 188.91series/s]		[INFO] Processing immediate_charging series:  23%|██▎       | 38/168 [00:00<00:00, 151.78series/s]		[INFO] Processing immediate_charging series:  32%|███▏      | 54/168 [00:00<00:00, 121.10series/s]		[INFO] Processing immediate_charging series:  40%|███▉      | 67/168 [00:00<00:00, 116.54series/s]		[INFO] Processing immediate_charging series:  48%|█████▏     | 80/168 [00:00<00:00, 89.24series/s]		[INFO] Processing immediate_charging series:  54%|█████▉     | 90/168 [00:00<00:00, 84.18series/s]		[INFO] Processing immediate_charging series:  60%|█████▉    | 100/168 [00:01<00:00, 78.14series/s]		[INFO] Processing immediate_charging series:  65%|██████▌   | 110/168 [00:01<00:00, 72.91series/s]		[INFO] Processing immediate_charging series:  71%|███████▏  | 120/168 [00:01<00:00, 67.69series/s]		[INFO] Processing immediate_charging series:  77%|███████▋  | 130/168 [00:01<00:00, 62.62series/s]		[INFO] Processing immediate_charging series:  83%|████████▎ | 140/168 [00:01<00:00, 58.17series/s]		[INFO] Processing immediate_charging series:  89%|████████▉ | 150/168 [00:01<00:00, 55.08series/s]		[INFO] Processing immediate_charging series:  95%|█████████▌| 160/168 [00:02<00:00, 51.12series/s]		[INFO] Processing immediate_charging series: 100%|██████████| 168/168 [00:02<00:00, 46.72series/s]		[INFO] Processing immediate_charging series: 100%|██████████| 168/168 [00:02<00:00, 69.48series/s]
		[INFO] Saving grid_demand results...
		[INFO] Saving pv_loss results...
		[INFO] Saving initial_demand results...
		[INFO] Saving charging_demand results...
		[INFO] Saving G2B results...
		[INFO] Saving P2B results...
		[INFO] Saving G2V results...
		[INFO] Saving P2V results...
		[INFO] Saving V2B results...
		[INFO] Saving SOC results...
		[INFO] Saving unmet results...
		[INFO] Saving objective_value results...
		[INFO] Saving optimization_time_s results...
		[INFO] Saving mip_gap_percent results...
		[INFO] Saving total_cost results...
		[INFO] Saving self_sufficiency results...
		[INFO] Saving pv_utilization results...
		[INFO] Deleted checkpoint after full completion.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1563 samples from 'data/battery_demand/case2_nan_filled'
		[INFO] Starting fresh run: mode=optimization
		[INFO] Processing optimization series:   0%|                         | 0/1563 [00:00<?, ?series/s]		[INFO] Processing optimization series:   0%|                 | 1/1563 [00:00<14:18,  1.82series/s]		[INFO] Processing optimization series:   0%|                 | 2/1563 [00:01<15:15,  1.70series/s]		[INFO] Processing optimization series:   0%|                 | 3/1563 [00:01<14:51,  1.75series/s]		[INFO] Processing optimization series:   0%|                 | 4/1563 [00:02<14:45,  1.76series/s]		[INFO] Processing optimization series:   0%|                 | 5/1563 [00:02<15:00,  1.73series/s]		[INFO] Processing optimization series:   0%|                 | 6/1563 [00:03<15:05,  1.72series/s]		[INFO] Processing optimization series:   0%|                 | 7/1563 [00:04<14:50,  1.75series/s]		[INFO] Processing optimization series:   1%|                 | 8/1563 [00:04<15:04,  1.72series/s]		[INFO] Processing optimization series:   1%|                 | 9/1563 [00:05<14:48,  1.75series/s]		[INFO] Processing optimization series:   1%|                | 10/1563 [00:05<14:51,  1.74series/s]		[INFO] Processing optimization series:   1%|                | 11/1563 [00:06<15:09,  1.71series/s]		[INFO] Processing optimization series:   1%|                | 12/1563 [00:06<15:06,  1.71series/s]		[INFO] Processing optimization series:   1%|▏               | 13/1563 [00:07<15:12,  1.70series/s]		[INFO] Processing optimization series:   1%|▏               | 14/1563 [00:08<15:35,  1.66series/s]		[INFO] Processing optimization series:   1%|▏               | 15/1563 [00:08<15:12,  1.70series/s]		[INFO] Processing optimization series:   1%|▏               | 16/1563 [00:09<15:21,  1.68series/s]		[INFO] Processing optimization series:   1%|▏               | 17/1563 [00:09<15:10,  1.70series/s]		[INFO] Processing optimization series:   1%|▏               | 18/1563 [00:10<15:00,  1.72series/s]		[INFO] Processing optimization series:   1%|▏               | 19/1563 [00:11<15:13,  1.69series/s]		[INFO] Processing optimization series:   1%|▏               | 20/1563 [00:11<15:01,  1.71series/s]		[INFO] Processing optimization series:   1%|▏               | 21/1563 [00:12<14:47,  1.74series/s]		[INFO] Processing optimization series:   1%|▏               | 22/1563 [00:12<14:53,  1.72series/s]		[INFO] Processing optimization series:   1%|▏               | 23/1563 [00:13<14:33,  1.76series/s]		[INFO] Processing optimization series:   2%|▏               | 24/1563 [00:13<14:18,  1.79series/s]		[INFO] Processing optimization series:   2%|▎               | 25/1563 [00:14<14:22,  1.78series/s]		[INFO] Processing optimization series:   2%|▎               | 26/1563 [00:14<14:09,  1.81series/s]		[INFO] Processing optimization series:   2%|▎               | 27/1563 [00:15<14:02,  1.82series/s]		[INFO] Processing optimization series:   2%|▎               | 28/1563 [00:16<14:15,  1.79series/s]		[INFO] Processing optimization series:   2%|▎               | 29/1563 [00:16<14:13,  1.80series/s]		[INFO] Processing optimization series:   2%|▎               | 30/1563 [00:17<14:31,  1.76series/s]		[INFO] Processing optimization series:   2%|▎               | 31/1563 [00:17<14:43,  1.73series/s]		[INFO] Processing optimization series:   2%|▎               | 32/1563 [00:18<14:51,  1.72series/s]		[INFO] Processing optimization series:   2%|▎               | 33/1563 [00:19<14:45,  1.73series/s]		[INFO] Processing optimization series:   2%|▎               | 34/1563 [00:19<14:55,  1.71series/s]		[INFO] Processing optimization series:   2%|▎               | 35/1563 [00:20<14:37,  1.74series/s]		[INFO] Processing optimization series:   2%|▎               | 36/1563 [00:20<14:33,  1.75series/s]		[INFO] Processing optimization series:   2%|▍               | 37/1563 [00:21<14:47,  1.72series/s]		[INFO] Processing optimization series:   2%|▍               | 38/1563 [00:21<14:36,  1.74series/s]		[INFO] Processing optimization series:   2%|▍               | 39/1563 [00:22<14:29,  1.75series/s]		[INFO] Processing optimization series:   3%|▍               | 40/1563 [00:23<14:59,  1.69series/s]		[INFO] Processing optimization series:   3%|▍               | 41/1563 [00:23<14:33,  1.74series/s]		[INFO] Processing optimization series:   3%|▍               | 42/1563 [00:24<14:27,  1.75series/s]		[INFO] Processing optimization series:   3%|▍               | 43/1563 [00:24<14:43,  1.72series/s]		[INFO] Processing optimization series:   3%|▍               | 44/1563 [00:25<14:33,  1.74series/s]		[INFO] Processing optimization series:   3%|▍               | 45/1563 [00:25<14:43,  1.72series/s]		[INFO] Processing optimization series:   3%|▍               | 46/1563 [00:26<15:01,  1.68series/s]		[INFO] Processing optimization series:   3%|▍               | 47/1563 [00:27<14:47,  1.71series/s]		[INFO] Processing optimization series:   3%|▍               | 48/1563 [00:27<15:03,  1.68series/s]		[INFO] Processing optimization series:   3%|▌               | 49/1563 [00:28<14:49,  1.70series/s]		[INFO] Processing optimization series:   3%|▌               | 50/1563 [00:28<14:56,  1.69series/s]		[INFO] Processing optimization series:   3%|▌               | 51/1563 [00:29<14:46,  1.71series/s]		[INFO] Processing optimization series:   3%|▌               | 52/1563 [00:30<14:25,  1.75series/s]		[INFO] Processing optimization series:   3%|▌               | 53/1563 [00:30<14:06,  1.78series/s]		[INFO] Processing optimization series:   3%|▌               | 54/1563 [00:31<14:23,  1.75series/s]		[INFO] Processing optimization series:   4%|▌               | 55/1563 [00:31<14:08,  1.78series/s]		[INFO] Processing optimization series:   4%|▌               | 56/1563 [00:32<13:58,  1.80series/s]		[INFO] Processing optimization series:   4%|▌               | 57/1563 [00:32<14:11,  1.77series/s]		[INFO] Processing optimization series:   4%|▌               | 58/1563 [00:33<14:06,  1.78series/s]		[INFO] Processing optimization series:   4%|▌               | 59/1563 [00:33<13:53,  1.80series/s]		[INFO] Processing optimization series:   4%|▌               | 60/1563 [00:34<14:36,  1.71series/s]		[INFO] Processing optimization series:   4%|▌               | 61/1563 [00:35<14:16,  1.75series/s]		[INFO] Processing optimization series:   4%|▋               | 62/1563 [00:35<14:01,  1.78series/s]		[INFO] Processing optimization series:   4%|▋               | 63/1563 [00:36<14:10,  1.76series/s]		[INFO] Processing optimization series:   4%|▋               | 64/1563 [00:36<13:47,  1.81series/s]		[INFO] Processing optimization series:   4%|▋               | 65/1563 [00:37<13:35,  1.84series/s]		[INFO] Processing optimization series:   4%|▋               | 66/1563 [00:37<13:52,  1.80series/s]		[INFO] Processing optimization series:   4%|▋               | 67/1563 [00:38<13:46,  1.81series/s]		[INFO] Processing optimization series:   4%|▋               | 68/1563 [00:38<13:43,  1.81series/s]		[INFO] Processing optimization series:   4%|▋               | 69/1563 [00:39<14:04,  1.77series/s]		[INFO] Processing optimization series:   4%|▋               | 70/1563 [00:40<14:37,  1.70series/s]		[INFO] Processing optimization series:   5%|▋               | 71/1563 [00:40<14:23,  1.73series/s]		[INFO] Processing optimization series:   5%|▋               | 72/1563 [00:41<14:35,  1.70series/s]		[INFO] Processing optimization series:   5%|▋               | 73/1563 [00:41<14:23,  1.72series/s]		[INFO] Processing optimization series:   5%|▊               | 74/1563 [00:42<14:41,  1.69series/s]		[INFO] Processing optimization series:   5%|▊               | 75/1563 [00:43<14:26,  1.72series/s]		[INFO] Processing optimization series:   5%|▊               | 76/1563 [00:43<14:09,  1.75series/s]		[INFO] Processing optimization series:   5%|▊               | 77/1563 [00:44<14:22,  1.72series/s]		[INFO] Processing optimization series:   5%|▊               | 78/1563 [00:44<14:02,  1.76series/s]		[INFO] Processing optimization series:   5%|▊               | 79/1563 [00:45<13:42,  1.80series/s]		[INFO] Processing optimization series:   5%|▊               | 80/1563 [00:45<14:32,  1.70series/s]		[INFO] Processing optimization series:   5%|▊               | 81/1563 [00:46<14:03,  1.76series/s]		[INFO] Processing optimization series:   5%|▊               | 82/1563 [00:47<13:44,  1.80series/s]		[INFO] Processing optimization series:   5%|▊               | 83/1563 [00:47<13:52,  1.78series/s]		[INFO] Processing optimization series:   5%|▊               | 84/1563 [00:48<13:32,  1.82series/s]		[INFO] Processing optimization series:   5%|▊               | 85/1563 [00:48<13:22,  1.84series/s]		[INFO] Processing optimization series:   6%|▉               | 86/1563 [00:49<13:37,  1.81series/s]		[INFO] Processing optimization series:   6%|▉               | 87/1563 [00:49<13:33,  1.81series/s]		[INFO] Processing optimization series:   6%|▉               | 88/1563 [00:50<13:35,  1.81series/s]		[INFO] Processing optimization series:   6%|▉               | 89/1563 [00:50<14:14,  1.73series/s]		[INFO] Processing optimization series:   6%|▉               | 90/1563 [00:51<14:52,  1.65series/s]		[INFO] Processing optimization series:   6%|▉               | 91/1563 [00:52<14:27,  1.70series/s]		[INFO] Processing optimization series:   6%|▉               | 92/1563 [00:52<14:30,  1.69series/s]		[INFO] Processing optimization series:   6%|▉               | 93/1563 [00:53<14:15,  1.72series/s]		[INFO] Processing optimization series:   6%|▉               | 94/1563 [00:53<14:10,  1.73series/s]		[INFO] Processing optimization series:   6%|▉               | 95/1563 [00:54<14:27,  1.69series/s]		[INFO] Processing optimization series:   6%|▉               | 96/1563 [00:55<14:43,  1.66series/s]		[INFO] Processing optimization series:   6%|▉               | 97/1563 [00:55<15:07,  1.62series/s]		[INFO] Processing optimization series:   6%|█               | 98/1563 [00:56<14:59,  1.63series/s]		[INFO] Processing optimization series:   6%|█               | 99/1563 [00:57<14:37,  1.67series/s]		[INFO] Processing optimization series:   6%|▉              | 100/1563 [00:57<15:27,  1.58series/s]		[INFO] Processing optimization series:   6%|▉              | 101/1563 [00:58<14:52,  1.64series/s]		[INFO] Processing optimization series:   7%|▉              | 102/1563 [00:58<14:20,  1.70series/s]		[INFO] Processing optimization series:   7%|▉              | 103/1563 [00:59<14:19,  1.70series/s]		[INFO] Processing optimization series:   7%|▉              | 104/1563 [00:59<13:52,  1.75series/s]		[INFO] Processing optimization series:   7%|█              | 105/1563 [01:00<13:30,  1.80series/s]		[INFO] Processing optimization series:   7%|█              | 106/1563 [01:01<13:41,  1.77series/s]		[INFO] Processing optimization series:   7%|█              | 107/1563 [01:01<13:26,  1.81series/s]		[INFO] Processing optimization series:   7%|█              | 108/1563 [01:02<13:18,  1.82series/s]		[INFO] Processing optimization series:   7%|█              | 109/1563 [01:02<13:32,  1.79series/s]Fatal Python error: Segmentation fault

Thread 0x000074ec792ff640 (most recent call first):
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/threading.py", line 363 in wait
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/threading.py", line 659 in wait
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/tqdm/_monitor.py", line 60 in run
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/threading.py", line 1043 in _bootstrap_inner
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/threading.py", line 1014 in _bootstrap

Current thread 0x000074edde4c4440 (most recent call first):
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/MILP/GurobiOptimizer.py", line 139 in <genexpr>
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/MILP/GurobiOptimizer.py", line 139 in optimize
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/MILP/EnergyAllocator.py", line 143 in run_iterations
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/main.py", line 29 in main
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/main.py", line 65 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._mt19937, numpy.random.mtrand, numpy.random._philox, numpy.random._pcg64, numpy.random._sfc64, numpy.random._generator, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, _cffi_backend, scipy._lib._ccallback_c, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_sqrtm_triu, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpack, scipy.sparse.linalg._propack._spropack, scipy.sparse.linalg._propack._dpropack, scipy.sparse.linalg._propack._cpropack, scipy.sparse.linalg._propack._zpropack, scipy.sparse.csgraph._tools, scipy.sparse.csgraph._shortest_path, scipy.sparse.csgraph._traversal, scipy.sparse.csgraph._min_spanning_tree, scipy.sparse.csgraph._flow, scipy.sparse.csgraph._matching, scipy.sparse.csgraph._reordering, scipy.spatial._ckdtree, scipy._lib.messagestream, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._distance_wrap, scipy.spatial._hausdorff, scipy.special._ufuncs_cxx, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.special._ellip_harm_2, scipy.spatial.transform._rotation, scipy.optimize._group_columns, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._cobyla, scipy.optimize._slsqp, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy.optimize._cython_nnls, scipy._lib._uarray._uarray, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.optimize._direct, scipy.integrate._odepack, scipy.integrate._quadpack, scipy.integrate._vode, scipy.integrate._dop, scipy.integrate._lsoda, scipy.interpolate._fitpack, scipy.interpolate._dfitpack, scipy.interpolate._dierckx, scipy.interpolate._ppoly, scipy.interpolate._interpnd, scipy.interpolate._rbfinterp_pythran, scipy.interpolate._rgi_cython, scipy.interpolate._bspl, scipy.special.cython_special, scipy.stats._stats, scipy.stats._sobol, scipy.stats._qmc_cy, scipy.stats._biasedurn, scipy.stats._stats_pythran, scipy.stats._levy_stable.levyst, scipy.stats._ansari_swilk_statistics, scipy.stats._mvn, scipy.stats._rcont.rcont, scipy.ndimage._nd_image, scipy.ndimage._rank_filter_1d, _ni_label, scipy.ndimage._ni_label, PIL._imaging, kiwisolver._cext, gurobipy._util, gurobipy._exception, gurobipy._attrutil, gurobipy._core, gurobipy._batch, gurobipy._matrixapi, gurobipy._helpers, gurobipy._modelutil, gurobipy._model, psutil._psutil_linux, psutil._psutil_posix, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, sklearn.__check_build._check_build, sklearn.utils._isfinite, sklearn.utils.sparsefuncs_fast, sklearn.utils.murmurhash, sklearn.utils._openmp_helpers, sklearn.metrics.cluster._expected_mutual_info_fast, sklearn.preprocessing._csr_polynomial_expansion, sklearn.preprocessing._target_encoder_fast, sklearn.metrics._dist_metrics, sklearn.metrics._pairwise_distances_reduction._datasets_pair, sklearn.utils._cython_blas, sklearn.metrics._pairwise_distances_reduction._base, sklearn.metrics._pairwise_distances_reduction._middle_term_computer, sklearn.utils._heap, sklearn.utils._sorting, sklearn.metrics._pairwise_distances_reduction._argkmin, sklearn.metrics._pairwise_distances_reduction._argkmin_classmode, sklearn.utils._vector_sentinel, sklearn.metrics._pairwise_distances_reduction._radius_neighbors, sklearn.metrics._pairwise_distances_reduction._radius_neighbors_classmode, sklearn.metrics._pairwise_fast, sklearn.utils._random (total: 181)
