nohup: ignoring input
Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at 'data/battery_demand/resample_full.csv' and 'data/battery_demand/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1395, 37)
		[INFO] Case 1 exists — loaded battery demand from 'data/battery_demand/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists — loaded battery demand from 'data/battery_demand/case2_nan_filled/battery_demand.npy' with shape (1563, 37).
		[INFO] Case 0: Successfully added test pair 2024-03-15 & 2024-03-16
		Data: [10536, 28, 30, 35, 37, 37, 36, 33, 26, 10, 6, 10, 14, 19, 18, 15, 20, 26, 15, 9, 16, 21, 20, 8, 12, 15, 24, 31, 35, 32, 35, 34, 32, 31, 30, 22, 14, 18, 27, 18, 19, 19, 25, 25, 25, 26, 27, 17, 19]
		[INFO] Case 0: Successfully added test pair 2024-03-29 & 2024-03-30
		Data: [10872, 13, 26, 31, 33, 33, 33, 31, 15, 8, 19, 11, 15, 18, 16, 18, 18, 19, 7, 4, 23, 23, 16, 17, 18, 18, 19, 24, 29, 30, 30, 22, 27, 21, 14, 15, 16, 20, 18, 23, 27, 18, 2, 10, 23, 22, 22, 17, 21]

	1.6 Generating battery schedule...
		[INFO] Case 1 exists — loaded from 'data/battery_demand/case1_real_only/battery_availability.npy' and 'data/battery_demand/case1_real_only/battery_details.npy' shape (168, 385, 36) and (4, 168, 385)
		[INFO] Case 2 exists — loaded from 'data/battery_demand/case2_nan_filled/battery_availability.npy' and 'data/battery_demand/case2_nan_filled/battery_details.npy' shape (1563, 385, 36) and (4, 1563, 385)
[ERROR] Could not load battery demand from 'data/battery_demand/case3_extended_generated/battery_demand.npy': [Errno 2] No such file or directory: 'data/battery_demand/case3_extended_generated/battery_demand.npy'


==================================================
PART 2: MILP Optimization...
==================================================

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from 'data/battery_demand/case1_real_only'
		[INFO] Results already exist at './data/optimization_results/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at './data/optimization_results/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1563 samples from 'data/battery_demand/case2_nan_filled'
		[INFO] Results already exist at './data/optimization_results/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at './data/optimization_results/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 2 completed.


==================================================
PART 3: Supervised Learning...
==================================================

	3.1 Training Case 1...
		=== Training Log Started: 2025-12-03 19:33:52.817873 ===
		Run Name: STAFV2_33_CASE1
		Device: cuda
		Epochs: 1000, Batch Size: 4, LR: 0.05
		============================================================
		[INFO] Unique quantized indices: 6686
		[INFO] Suggested num_embeddings: 8023
		[INFO] Processed 168 series with 2016 valid samples.
		[INFO] Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_33_CASE1.csv  (shape: (2016, 201))
		[INFO] Saved feature metadata: ./data/training_results/feature_info_STAFV2_33_CASE1.json
		[INFO] Dataset split: 1612 train, 404 val
		[INFO] Scalers fitted and saved.

		✅ Model initialized with 23074 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train R²  |   Val R²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/1000 | 0.050000   |    6.60792   |    5.76564   |     -0.339 |      0.067 |    0/150  
		    2/1000 | 0.050000   |    5.65357   |    5.58708   |      0.020 |      0.124 |    0/150  
		    3/1000 | 0.050000   |    5.53517   |    5.72758   |      0.061 |      0.080 |    0/150  
		    4/1000 | 0.050000   |    5.50152   |    5.64231   |      0.072 |      0.107 |    1/150  
		    5/1000 | 0.050000   |    5.47740   |    5.60248   |      0.080 |      0.119 |    2/150  
		    6/1000 | 0.050000   |    5.49163   |    5.69095   |      0.075 |      0.091 |    3/150  
		    7/1000 | 0.050000   |    5.51180   |    5.56341   |      0.069 |      0.132 |    4/150  
		    8/1000 | 0.050000   |    5.47116   |    5.61744   |      0.082 |      0.115 |    0/150  
		    9/1000 | 0.050000   |    5.54880   |    5.61743   |      0.056 |      0.115 |    1/150  
		   10/1000 | 0.050000   |    5.48742   |    5.69007   |      0.077 |      0.092 |    2/150  
		   11/1000 | 0.050000   |    5.52270   |    5.63726   |      0.065 |      0.108 |    3/150  
		   12/1000 | 0.050000   |    5.56954   |    5.73544   |      0.049 |      0.077 |    4/150  
		   13/1000 | 0.050000   |    5.53972   |    5.62934   |      0.059 |      0.111 |    5/150  
		   14/1000 | 0.050000   |    5.54541   |    5.54464   |      0.057 |      0.138 |    6/150  
		   15/1000 | 0.050000   |    5.55096   |    5.63269   |      0.055 |      0.110 |    0/150  
		   16/1000 | 0.050000   |    5.50267   |    5.58672   |      0.072 |      0.124 |    1/150  
		   17/1000 | 0.050000   |    5.50516   |    5.59473   |      0.071 |      0.122 |    2/150  
		   18/1000 | 0.050000   |    5.50970   |    5.70195   |      0.069 |      0.088 |    3/150  
		   19/1000 | 0.050000   |    5.52417   |    5.55178   |      0.064 |      0.135 |    4/150  
		   20/1000 | 0.050000   |    5.60031   |    5.45181   |      0.038 |      0.166 |    5/150  
		   21/1000 | 0.050000   |    5.48109   |    5.68151   |      0.079 |      0.094 |    0/150  
		   22/1000 | 0.050000   |    5.51298   |    5.60959   |      0.068 |      0.117 |    1/150  
		   23/1000 | 0.050000   |    5.57943   |    5.59598   |      0.046 |      0.121 |    2/150  
		   24/1000 | 0.050000   |    5.55003   |    5.65592   |      0.056 |      0.103 |    3/150  
		   25/1000 | 0.050000   |    5.45429   |    5.61450   |      0.088 |      0.116 |    4/150  
		   26/1000 | 0.050000   |    5.50592   |    5.74435   |      0.071 |      0.074 |    5/150  
		   27/1000 | 0.050000   |    5.46176   |    5.59873   |      0.085 |      0.121 |    6/150  
		   28/1000 | 0.050000   |    5.52620   |    5.56386   |      0.064 |      0.132 |    7/150  
		   29/1000 | 0.050000   |    5.47880   |    5.52101   |      0.080 |      0.145 |    8/150  
		   30/1000 | 0.050000   |    5.51545   |    5.67297   |      0.067 |      0.097 |    9/150  
		   31/1000 | 0.050000   |    5.52815   |    5.54254   |      0.063 |      0.138 |   10/150  
		   32/1000 | 0.050000   |    5.50499   |    5.61188   |      0.071 |      0.116 |   11/150  
		   33/1000 | 0.050000   |    5.49126   |    5.52211   |      0.075 |      0.145 |   12/150  
		   34/1000 | 0.050000   |    5.55185   |    5.60972   |      0.055 |      0.117 |   13/150  
		   35/1000 | 0.050000   |    5.51363   |    5.65699   |      0.068 |      0.102 |   14/150  
		   36/1000 | 0.012500   |    5.46008   |    5.78327   |      0.086 |      0.062 |   15/150  
		   37/1000 | 0.012500   |    5.53063   |    5.53447   |      0.062 |      0.141 |   16/150  
		   38/1000 | 0.012500   |    5.47682   |    5.56573   |      0.080 |      0.131 |   17/150  
		   39/1000 | 0.012500   |    5.46721   |    5.55291   |      0.084 |      0.135 |   18/150  
		   40/1000 | 0.012500   |    5.46217   |    5.43635   |      0.085 |      0.171 |   19/150  
		   41/1000 | 0.012500   |    5.44810   |    5.58995   |      0.090 |      0.123 |    0/150  
		   42/1000 | 0.012500   |    5.46502   |    5.54293   |      0.084 |      0.138 |    1/150  
		   43/1000 | 0.012500   |    5.46021   |    5.49290   |      0.086 |      0.154 |    2/150  
		   44/1000 | 0.012500   |    5.45380   |    5.39607   |      0.088 |      0.183 |    3/150  
		   45/1000 | 0.012500   |    5.39594   |    5.51019   |      0.107 |      0.148 |    0/150  
		   46/1000 | 0.012500   |    5.40831   |    5.48029   |      0.103 |      0.157 |    1/150  
		   47/1000 | 0.012500   |    5.43025   |    5.49455   |      0.096 |      0.153 |    2/150  
		   48/1000 | 0.012500   |    5.44931   |    5.41590   |      0.090 |      0.177 |    3/150  
		   49/1000 | 0.012500   |    5.46312   |    5.60263   |      0.085 |      0.119 |    4/150  
		   50/1000 | 0.012500   |    5.43601   |    5.41633   |      0.094 |      0.177 |    5/150  
		   51/1000 | 0.012500   |    5.42431   |    5.45314   |      0.098 |      0.166 |    6/150  
		   52/1000 | 0.012500   |    5.41043   |    5.46742   |      0.103 |      0.161 |    7/150  
		   53/1000 | 0.012500   |    5.41119   |    5.45641   |      0.102 |      0.165 |    8/150  
		   54/1000 | 0.012500   |    5.41601   |    5.49311   |      0.101 |      0.153 |    9/150  
		   55/1000 | 0.012500   |    5.40629   |    5.47098   |      0.104 |      0.160 |   10/150  
		   56/1000 | 0.012500   |    5.47982   |    5.60633   |      0.079 |      0.118 |   11/150  
		   57/1000 | 0.012500   |    5.42803   |    5.42924   |      0.097 |      0.173 |   12/150  
		   58/1000 | 0.012500   |    5.42724   |    5.50070   |      0.097 |      0.151 |   13/150  
		   59/1000 | 0.012500   |    5.44910   |    5.34351   |      0.090 |      0.199 |   14/150  
		   60/1000 | 0.012500   |    5.38596   |    5.40359   |      0.111 |      0.181 |    0/150  
		   61/1000 | 0.012500   |    5.40249   |    5.40746   |      0.105 |      0.180 |    1/150  
		   62/1000 | 0.012500   |    5.42464   |    5.59279   |      0.098 |      0.122 |    2/150  
		   63/1000 | 0.012500   |    5.43605   |    5.52344   |      0.094 |      0.144 |    3/150  
		   64/1000 | 0.012500   |    5.47411   |    5.41579   |      0.081 |      0.177 |    4/150  
		   65/1000 | 0.012500   |    5.42261   |    5.43665   |      0.098 |      0.171 |    5/150  
		   66/1000 | 0.012500   |    5.46953   |    5.48986   |      0.083 |      0.154 |    6/150  
		   67/1000 | 0.012500   |    5.42362   |    5.40769   |      0.098 |      0.180 |    7/150  
		   68/1000 | 0.012500   |    5.41561   |    5.42920   |      0.101 |      0.173 |    8/150  
		   69/1000 | 0.012500   |    5.50849   |    5.38931   |      0.070 |      0.185 |    9/150  
		   70/1000 | 0.012500   |    5.41921   |    5.46086   |      0.100 |      0.163 |   10/150  
		   71/1000 | 0.012500   |    5.43380   |    5.49790   |      0.095 |      0.152 |   11/150  
		   72/1000 | 0.012500   |    5.39201   |    5.44107   |      0.109 |      0.169 |   12/150  
		   73/1000 | 0.012500   |    5.43708   |    5.49508   |      0.094 |      0.153 |   13/150  
		   74/1000 | 0.012500   |    5.49271   |    5.47733   |      0.075 |      0.158 |   14/150  
		   75/1000 | 0.003125   |    5.44838   |    5.46303   |      0.090 |      0.163 |   15/150  
		   76/1000 | 0.003125   |    5.39374   |    5.45960   |      0.108 |      0.164 |   16/150  
		   77/1000 | 0.003125   |    5.43176   |    5.53031   |      0.095 |      0.142 |   17/150  
		   78/1000 | 0.003125   |    5.39126   |    5.59603   |      0.109 |      0.121 |   18/150  
		   79/1000 | 0.003125   |    5.34133   |    5.48080   |      0.125 |      0.157 |   19/150  
		   80/1000 | 0.003125   |    5.40034   |    5.45393   |      0.106 |      0.166 |   20/150  
		   81/1000 | 0.003125   |    5.34747   |    5.39975   |      0.123 |      0.182 |   21/150  
		   82/1000 | 0.003125   |    5.37276   |    5.41756   |      0.115 |      0.177 |   22/150  
		   83/1000 | 0.003125   |    5.34449   |    5.47544   |      0.124 |      0.159 |   23/150  
		   84/1000 | 0.003125   |    5.41266   |    5.47699   |      0.102 |      0.158 |   24/150  
