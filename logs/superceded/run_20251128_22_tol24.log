Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at './data/battery_demand/tol24/resample_full.csv' and './data/battery_demand/tol24/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1377, 37)
		[INFO] Number of seeds ready for Case 3  = (2000, 36)

		[INFO] Case 1 exists — loaded battery demand from './data/battery_demand/tol24/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists — loaded battery demand from './data/battery_demand/tol24/case2_nan_filled/battery_demand.npy' with shape (1545, 37).
		[INFO] Case 3 exists — loaded battery demand from './data/battery_demand/tol24/case3_extended_generated/battery_demand.npy' with shape (3545, 37).
		[INFO] Case 0: Successfully added test pair 2024-03-15 & 2024-03-16
		Data: [10536, 28, 30, 35, 37, 37, 36, 33, 26, 10, 6, 10, 14, 19, 18, 15, 20, 26, 15, 9, 16, 21, 20, 8, 12, 15, 24, 31, 35, 32, 35, 34, 32, 31, 30, 22, 14, 18, 27, 18, 19, 19, 25, 25, 25, 26, 27, 17, 19]
		[INFO] Case 0: Successfully added test pair 2024-03-29 & 2024-03-30
		Data: [10872, 13, 26, 31, 33, 33, 33, 31, 15, 8, 19, 11, 15, 18, 16, 18, 18, 19, 7, 4, 23, 23, 16, 17, 18, 18, 19, 24, 29, 30, 30, 22, 27, 21, 14, 15, 16, 20, 18, 23, 27, 18, 2, 10, 23, 22, 22, 17, 21]

	1.6 Generating battery schedule...
		[INFO] Case 1 exists — loaded from './data/battery_demand/tol24/case1_real_only/battery_availability.npy' and './data/battery_demand/tol24/case1_real_only/battery_details.npy' shape (168, 263, 36) and (4, 168, 263)
		[INFO] Case 2 exists — loaded from './data/battery_demand/tol24/case2_nan_filled/battery_availability.npy' and './data/battery_demand/tol24/case2_nan_filled/battery_details.npy' shape (1545, 311, 36) and (4, 1545, 311)
		[INFO] Case 3 exists — loaded from './data/battery_demand/tol24/case3_extended_generated/battery_availability.npy' and './data/battery_demand/tol24/case3_extended_generated/battery_details.npy' shape (3545, 422, 36) and (4, 3545, 422)


==================================================
PART 2: MILP Optimization...
==================================================

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from './data/battery_demand/tol24/case1_real_only'
		[INFO] Results already exist at './data/optimization_results/tol24/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol24/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1545 samples from './data/battery_demand/tol24/case2_nan_filled'
		[INFO] Results already exist at './data/optimization_results/tol24/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol24/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 2 completed.

	2.3 Optimizing Case 3...
		[INFO] Loaded 3545 samples from './data/battery_demand/tol24/case3_extended_generated'
		[INFO] Results already exist at './data/optimization_results/tol24/case3_extended_generated/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol24/case3_extended_generated/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 3 completed.


==================================================
PART 3: Supervised Learning...
==================================================

	3.1 Training Case 1...
		=== Training Log Started: 2025-11-28 22:07:21.405835 ===
		Run Name: STAFV2_24_CASE1
		Device: cuda
		Epochs: 1000, Batch Size: 128, LR: 0.01
		============================================================
		[INFO] Unique quantized indices: 6686
		[INFO] Suggested num_embeddings: 8023
		[INFO] Processed 168 valid samples.
		[INFO] Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_24_CASE1.csv  (shape: (168, 429))
		[INFO] Saved feature metadata: ./data/training_results/feature_info_STAFV2_24_CASE1.json
		[INFO] Dataset split: 134 train, 34 val
		[INFO] Scalers fitted and saved.

		✅ Model initialized with 715620 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train R²  |   Val R²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/1000 | 0.010000   |    9.18643   |    8.62715   |     -1.085 |     -0.766 |    0/150  
		    2/1000 | 0.010000   |    7.38198   |    8.04761   |     -0.942 |     -0.537 |    0/150  
		    3/1000 | 0.010000   |    8.09241   |    7.65517   |     -0.854 |     -0.390 |    0/150  
		    4/1000 | 0.010000   |    8.64711   |    7.49736   |     -0.796 |     -0.334 |    0/150  
		    5/1000 | 0.010000   |    8.19020   |    7.27576   |     -0.717 |     -0.256 |    0/150  
		    6/1000 | 0.010000   |    8.04472   |    7.08857   |     -0.624 |     -0.192 |    0/150  
		    7/1000 | 0.010000   |    7.29505   |    6.79292   |     -0.589 |     -0.095 |    0/150  
		    8/1000 | 0.010000   |    7.95457   |    6.71884   |     -0.498 |     -0.071 |    0/150  
		    9/1000 | 0.010000   |    8.49051   |    6.50114   |     -0.389 |     -0.003 |    0/150  
		   10/1000 | 0.010000   |    7.51779   |    6.52041   |     -0.303 |     -0.009 |    0/150  
		   11/1000 | 0.010000   |    6.46394   |    6.24783   |     -0.236 |      0.074 |    1/150  
		   12/1000 | 0.010000   |    6.80770   |    6.03064   |     -0.100 |      0.137 |    0/150  
		   13/1000 | 0.010000   |    6.72268   |    5.77483   |     -0.003 |      0.209 |    0/150  
		   14/1000 | 0.010000   |    7.36104   |    6.04590   |      0.032 |      0.133 |    0/150  
		   15/1000 | 0.010000   |    5.36252   |    6.09420   |      0.147 |      0.119 |    1/150  
		   16/1000 | 0.010000   |    5.35261   |    6.27475   |      0.240 |      0.066 |    2/150  
		   17/1000 | 0.010000   |    5.96022   |    6.48400   |      0.314 |      0.003 |    3/150  
		   18/1000 | 0.010000   |    4.83803   |    6.47017   |      0.431 |      0.007 |    4/150  
		   19/1000 | 0.010000   |    4.34041   |    6.38402   |      0.451 |      0.033 |    5/150  
		   20/1000 | 0.010000   |    3.78636   |    6.24908   |      0.544 |      0.073 |    6/150  
		   21/1000 | 0.010000   |    3.20147   |    6.06741   |      0.602 |      0.127 |    7/150  
		   22/1000 | 0.010000   |    5.32791   |    5.92842   |      0.630 |      0.166 |    8/150  
		   23/1000 | 0.010000   |    5.20957   |    5.62472   |      0.668 |      0.249 |    9/150  
		   24/1000 | 0.010000   |    2.68371   |    5.30541   |      0.698 |      0.332 |    0/150  
		   25/1000 | 0.010000   |    4.55421   |    5.17680   |      0.721 |      0.364 |    0/150  
		   26/1000 | 0.010000   |    2.70965   |    5.24584   |      0.758 |      0.347 |    0/150  
		   27/1000 | 0.010000   |    2.85410   |    5.33047   |      0.776 |      0.326 |    1/150  
		   28/1000 | 0.010000   |    2.79082   |    5.36709   |      0.772 |      0.317 |    2/150  
		   29/1000 | 0.010000   |    3.51918   |    5.47188   |      0.776 |      0.290 |    3/150  
		   30/1000 | 0.010000   |    4.98587   |    5.56015   |      0.733 |      0.267 |    4/150  
		   31/1000 | 0.010000   |    4.27347   |    5.52255   |      0.795 |      0.276 |    5/150  
		   32/1000 | 0.010000   |    3.10615   |    5.49958   |      0.772 |      0.282 |    6/150  
		   33/1000 | 0.010000   |    3.87315   |    5.50765   |      0.781 |      0.280 |    7/150  
		   34/1000 | 0.010000   |    3.07263   |    5.56051   |      0.772 |      0.266 |    8/150  
		   35/1000 | 0.010000   |    2.86592   |    5.64480   |      0.792 |      0.244 |    9/150  
		   36/1000 | 0.010000   |    4.54730   |    5.66033   |      0.789 |      0.240 |   10/150  
		   37/1000 | 0.010000   |    2.53253   |    5.63856   |      0.783 |      0.246 |   11/150  
		   38/1000 | 0.010000   |    2.49710   |    5.60182   |      0.801 |      0.255 |   12/150  
		   39/1000 | 0.010000   |    2.73822   |    5.55257   |      0.815 |      0.269 |   13/150  
		   40/1000 | 0.010000   |    2.35010   |    5.49440   |      0.814 |      0.284 |   14/150  
		   41/1000 | 0.005000   |    3.11283   |    5.43760   |      0.798 |      0.298 |   15/150  
		   42/1000 | 0.005000   |    3.88266   |    5.38932   |      0.817 |      0.311 |   16/150  
		   43/1000 | 0.005000   |    5.19929   |    5.36202   |      0.791 |      0.318 |   17/150  
		   44/1000 | 0.005000   |    4.48325   |    5.33085   |      0.809 |      0.326 |   18/150  
		   45/1000 | 0.005000   |    3.67898   |    5.25859   |      0.804 |      0.344 |   19/150  
		   46/1000 | 0.005000   |    5.29052   |    5.20466   |      0.809 |      0.357 |   20/150  
		   47/1000 | 0.005000   |    2.10251   |    5.11235   |      0.837 |      0.380 |   21/150  
		   48/1000 | 0.005000   |    2.69114   |    4.97451   |      0.843 |      0.413 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.9745)
		   49/1000 | 0.005000   |    3.24007   |    4.88575   |      0.836 |      0.434 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.8857)
		   50/1000 | 0.005000   |    2.48366   |    4.78597   |      0.840 |      0.457 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.7860)
		   51/1000 | 0.005000   |    2.83732   |    4.76162   |      0.849 |      0.462 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.7616)
		   52/1000 | 0.005000   |    2.94956   |    4.71549   |      0.854 |      0.472 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.7155)
		   53/1000 | 0.005000   |    2.59606   |    4.73930   |      0.856 |      0.467 |    0/150  
		   54/1000 | 0.005000   |    2.27760   |    4.69511   |      0.872 |      0.477 |    1/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.6951)
		   55/1000 | 0.005000   |    2.61055   |    4.64942   |      0.854 |      0.487 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.6494)
		   56/1000 | 0.005000   |    2.64171   |    4.67875   |      0.856 |      0.481 |    0/150  
		   57/1000 | 0.005000   |    6.67913   |    4.74477   |      0.790 |      0.466 |    1/150  
		   58/1000 | 0.005000   |    4.71262   |    4.73766   |      0.831 |      0.467 |    2/150  
		   59/1000 | 0.005000   |    2.07352   |    4.66405   |      0.864 |      0.484 |    3/150  
		   60/1000 | 0.005000   |    2.24054   |    4.59826   |      0.855 |      0.498 |    4/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.5983)
		   61/1000 | 0.005000   |    4.84031   |    4.54726   |      0.841 |      0.509 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.5473)
		   62/1000 | 0.005000   |    2.44500   |    4.56030   |      0.862 |      0.507 |    0/150  
		   63/1000 | 0.005000   |    2.93379   |    4.57456   |      0.857 |      0.504 |    1/150  
		   64/1000 | 0.005000   |    2.67467   |    4.56017   |      0.846 |      0.507 |    2/150  
		   65/1000 | 0.005000   |    2.06018   |    4.54743   |      0.867 |      0.509 |    3/150  
		   66/1000 | 0.005000   |    3.44210   |    4.56928   |      0.845 |      0.505 |    4/150  
		   67/1000 | 0.005000   |    2.97752   |    4.63231   |      0.847 |      0.491 |    5/150  
		   68/1000 | 0.005000   |    2.25337   |    4.64062   |      0.874 |      0.489 |    6/150  
		   69/1000 | 0.005000   |    2.45269   |    4.75092   |      0.874 |      0.464 |    7/150  
		   70/1000 | 0.005000   |    2.83404   |    4.77463   |      0.857 |      0.459 |    8/150  
		   71/1000 | 0.005000   |    3.75515   |    4.79853   |      0.854 |      0.454 |    9/150  
		   72/1000 | 0.005000   |    2.30833   |    4.82600   |      0.848 |      0.447 |   10/150  
		   73/1000 | 0.005000   |    1.85793   |    4.87298   |      0.845 |      0.437 |   11/150  
		   74/1000 | 0.005000   |    2.27125   |    4.91582   |      0.867 |      0.427 |   12/150  
		   75/1000 | 0.005000   |    2.52376   |    4.93477   |      0.869 |      0.422 |   13/150  
		   76/1000 | 0.005000   |    2.51250   |    4.98678   |      0.836 |      0.410 |   14/150  
		   77/1000 | 0.002500   |    2.69166   |    5.00172   |      0.879 |      0.406 |   15/150  
		   78/1000 | 0.002500   |    2.35846   |    5.01997   |      0.865 |      0.402 |   16/150  
		   79/1000 | 0.002500   |    3.92072   |    5.04133   |      0.854 |      0.397 |   17/150  
		   80/1000 | 0.002500   |    2.77115   |    5.01072   |      0.870 |      0.404 |   18/150  
		   81/1000 | 0.002500   |    2.17418   |    4.90672   |      0.873 |      0.429 |   19/150  
		   82/1000 | 0.002500   |    3.65203   |    4.90678   |      0.882 |      0.429 |   20/150  
		   83/1000 | 0.002500   |    2.15996   |    4.86844   |      0.867 |      0.438 |   21/150  
		   84/1000 | 0.002500   |    2.92248   |    4.87501   |      0.855 |      0.436 |   22/150  
		   85/1000 | 0.002500   |    2.27533   |    4.87880   |      0.868 |      0.435 |   23/150  
		   86/1000 | 0.002500   |    2.19119   |    4.88492   |      0.864 |      0.434 |   24/150  
		   87/1000 | 0.002500   |    2.82600   |    4.89935   |      0.892 |      0.431 |   25/150  
		   88/1000 | 0.002500   |    1.97569   |    4.91758   |      0.888 |      0.426 |   26/150  
		   89/1000 | 0.002500   |    2.53200   |    4.91757   |      0.856 |      0.426 |   27/150  
		   90/1000 | 0.002500   |    1.89217   |    4.90760   |      0.875 |      0.429 |   28/150  
		   91/1000 | 0.002500   |    3.84260   |    4.89906   |      0.857 |      0.431 |   29/150  
		   92/1000 | 0.002500   |    2.87334   |    4.92085   |      0.864 |      0.425 |   30/150  
		   93/1000 | 0.001250   |    3.78749   |    4.94112   |      0.867 |      0.421 |   31/150  
		   94/1000 | 0.001250   |    2.00594   |    4.90748   |      0.865 |      0.429 |   32/150  
		   95/1000 | 0.001250   |    2.24293   |    4.92255   |      0.871 |      0.425 |   33/150  
		   96/1000 | 0.001250   |    1.83448   |    4.93272   |      0.861 |      0.423 |   34/150  
		   97/1000 | 0.001250   |    4.47095   |    4.98999   |      0.845 |      0.409 |   35/150  
		   98/1000 | 0.001250   |    2.74660   |    4.99481   |      0.882 |      0.408 |   36/150  
		   99/1000 | 0.001250   |    3.37930   |    4.90187   |      0.857 |      0.430 |   37/150  
		  100/1000 | 0.001250   |    2.86329   |    4.86905   |      0.858 |      0.438 |   38/150  
		  101/1000 | 0.001250   |    2.60335   |    4.86695   |      0.881 |      0.438 |   39/150  
		  102/1000 | 0.001250   |    4.00938   |    4.85383   |      0.862 |      0.441 |   40/150  
		  103/1000 | 0.001250   |    3.07608   |    4.86328   |      0.886 |      0.439 |   41/150  
		  104/1000 | 0.001250   |    2.83999   |    4.85106   |      0.884 |      0.442 |   42/150  
		  105/1000 | 0.001250   |    3.05260   |    4.87946   |      0.882 |      0.435 |   43/150  
		  106/1000 | 0.001250   |    1.82443   |    4.84070   |      0.909 |      0.444 |   44/150  
		  107/1000 | 0.001250   |    2.37820   |    4.88280   |      0.877 |      0.434 |   45/150  
		  108/1000 | 0.001250   |    1.74246   |    4.83554   |      0.912 |      0.445 |   46/150  
		  109/1000 | 0.000625   |    1.97163   |    4.80228   |      0.899 |      0.453 |   47/150  
		  110/1000 | 0.000625   |    1.79435   |    4.80042   |      0.863 |      0.453 |   48/150  
		  111/1000 | 0.000625   |    2.30851   |    4.84742   |      0.884 |      0.443 |   49/150  
		  112/1000 | 0.000625   |    2.53774   |    4.79037   |      0.885 |      0.456 |   50/150  
		  113/1000 | 0.000625   |    2.25524   |    4.78638   |      0.875 |      0.456 |   51/150  
		  114/1000 | 0.000625   |    4.29679   |    4.78868   |      0.869 |      0.456 |   52/150  
		  115/1000 | 0.000625   |    2.59721   |    4.77514   |      0.910 |      0.459 |   53/150  
		  116/1000 | 0.000625   |    1.79218   |    4.77896   |      0.916 |      0.458 |   54/150  
		  117/1000 | 0.000625   |    2.98201   |    4.80578   |      0.897 |      0.452 |   55/150  
		  118/1000 | 0.000625   |    1.71573   |    4.80386   |      0.902 |      0.452 |   56/150  
		  119/1000 | 0.000625   |    2.17649   |    4.80155   |      0.883 |      0.453 |   57/150  
		  120/1000 | 0.000625   |    2.60723   |    4.81817   |      0.900 |      0.449 |   58/150  
		  121/1000 | 0.000625   |    2.12971   |    4.80459   |      0.914 |      0.452 |   59/150  
		  122/1000 | 0.000625   |    2.21381   |    4.80421   |      0.902 |      0.452 |   60/150  
		  123/1000 | 0.000625   |    2.61176   |    4.79182   |      0.876 |      0.455 |   61/150  
		  124/1000 | 0.000625   |    2.48419   |    4.80158   |      0.871 |      0.453 |   62/150  
		  125/1000 | 0.000313   |    2.03333   |    4.82630   |      0.906 |      0.447 |   63/150  
		  126/1000 | 0.000313   |    3.15987   |    4.93191   |      0.896 |      0.423 |   64/150  
		  127/1000 | 0.000313   |    2.89950   |    4.99154   |      0.891 |      0.409 |   65/150  
		  128/1000 | 0.000313   |    2.65816   |    4.97299   |      0.897 |      0.413 |   66/150  
		  129/1000 | 0.000313   |    2.85024   |    4.83567   |      0.900 |      0.445 |   67/150  
		  130/1000 | 0.000313   |    1.92459   |    4.80795   |      0.912 |      0.452 |   68/150  
		  131/1000 | 0.000313   |    2.47657   |    4.82278   |      0.883 |      0.448 |   69/150  
		  132/1000 | 0.000313   |    2.23387   |    4.78893   |      0.905 |      0.456 |   70/150  
		  133/1000 | 0.000313   |    2.74348   |    4.78825   |      0.886 |      0.456 |   71/150  
		  134/1000 | 0.000313   |    2.98768   |    4.79102   |      0.887 |      0.455 |   72/150  
		  135/1000 | 0.000313   |    1.59907   |    4.79351   |      0.902 |      0.455 |   73/150  
		  136/1000 | 0.000313   |    2.75579   |    4.79840   |      0.903 |      0.454 |   74/150  
		  137/1000 | 0.000313   |    2.10152   |    4.82541   |      0.880 |      0.448 |   75/150  
		  138/1000 | 0.000313   |    1.79434   |    4.83825   |      0.887 |      0.445 |   76/150  
		  139/1000 | 0.000313   |    2.37519   |    4.87897   |      0.896 |      0.435 |   77/150  
		  140/1000 | 0.000313   |    1.85995   |    4.84802   |      0.903 |      0.442 |   78/150  
		  141/1000 | 0.000156   |    1.53389   |    4.81922   |      0.910 |      0.449 |   79/150  
		  142/1000 | 0.000156   |    1.70165   |    4.80970   |      0.924 |      0.451 |   80/150  
		  143/1000 | 0.000156   |    2.48047   |    4.81568   |      0.896 |      0.450 |   81/150  
		  144/1000 | 0.000156   |    1.71997   |    4.82384   |      0.892 |      0.448 |   82/150  
		  145/1000 | 0.000156   |    2.46983   |    4.80525   |      0.885 |      0.452 |   83/150  
		  146/1000 | 0.000156   |    3.20603   |    4.84084   |      0.892 |      0.444 |   84/150  
		  147/1000 | 0.000156   |    2.81319   |    4.77549   |      0.890 |      0.459 |   85/150  
		  148/1000 | 0.000156   |    1.64398   |    4.76762   |      0.913 |      0.461 |   86/150  
		  149/1000 | 0.000156   |    4.17908   |    4.73179   |      0.862 |      0.469 |   87/150  
		  150/1000 | 0.000156   |    2.49152   |    4.73165   |      0.909 |      0.469 |   88/150  
		  151/1000 | 0.000156   |    2.44136   |    4.74525   |      0.884 |      0.466 |   89/150  
		  152/1000 | 0.000156   |    2.82249   |    4.82066   |      0.883 |      0.449 |   90/150  
		  153/1000 | 0.000156   |    2.18516   |    4.82426   |      0.895 |      0.448 |   91/150  
		  154/1000 | 0.000156   |    3.73777   |    4.78442   |      0.890 |      0.457 |   92/150  
		  155/1000 | 0.000156   |    2.63412   |    4.80493   |      0.896 |      0.452 |   93/150  
		  156/1000 | 0.000156   |    3.41122   |    4.76737   |      0.889 |      0.461 |   94/150  
		  157/1000 | 0.000078   |    4.19274   |    4.81692   |      0.863 |      0.450 |   95/150  
		  158/1000 | 0.000078   |    2.17716   |    4.77927   |      0.887 |      0.458 |   96/150  
		  159/1000 | 0.000078   |    3.32582   |    4.79532   |      0.882 |      0.454 |   97/150  
		  160/1000 | 0.000078   |    1.82737   |    4.76859   |      0.902 |      0.460 |   98/150  
		  161/1000 | 0.000078   |    3.31488   |    4.75593   |      0.877 |      0.463 |   99/150  
		  162/1000 | 0.000078   |    3.69301   |    4.78252   |      0.881 |      0.457 |  100/150  
		  163/1000 | 0.000078   |    1.65336   |    4.77518   |      0.924 |      0.459 |  101/150  
		  164/1000 | 0.000078   |    2.06574   |    4.77644   |      0.907 |      0.459 |  102/150  
		  165/1000 | 0.000078   |    4.52259   |    4.81061   |      0.859 |      0.451 |  103/150  
		  166/1000 | 0.000078   |    2.18230   |    4.83951   |      0.922 |      0.444 |  104/150  
		  167/1000 | 0.000078   |    2.23014   |    4.81850   |      0.899 |      0.449 |  105/150  
		  168/1000 | 0.000078   |    2.71097   |    4.79199   |      0.885 |      0.455 |  106/150  
		  169/1000 | 0.000078   |    4.05018   |    4.83442   |      0.885 |      0.445 |  107/150  
		  170/1000 | 0.000078   |    3.83826   |    4.81494   |      0.889 |      0.450 |  108/150  
		  171/1000 | 0.000078   |    4.78762   |    4.83379   |      0.882 |      0.446 |  109/150  
		  172/1000 | 0.000078   |    3.09194   |    4.79903   |      0.901 |      0.454 |  110/150  
		  173/1000 | 0.000039   |    2.04803   |    4.79174   |      0.900 |      0.455 |  111/150  
		  174/1000 | 0.000039   |    1.82157   |    4.79062   |      0.913 |      0.455 |  112/150  
		  175/1000 | 0.000039   |    4.00001   |    4.80501   |      0.899 |      0.452 |  113/150  
		  176/1000 | 0.000039   |    2.85957   |    4.85350   |      0.896 |      0.441 |  114/150  
		  177/1000 | 0.000039   |    1.83424   |    4.80604   |      0.938 |      0.452 |  115/150  
		  178/1000 | 0.000039   |    2.57999   |    4.77209   |      0.871 |      0.460 |  116/150  
		  179/1000 | 0.000039   |    2.28322   |    4.79311   |      0.921 |      0.455 |  117/150  
		  180/1000 | 0.000039   |    3.28086   |    4.79405   |      0.893 |      0.455 |  118/150  
		  181/1000 | 0.000039   |    2.67198   |    4.80095   |      0.919 |      0.453 |  119/150  
		  182/1000 | 0.000039   |    3.28537   |    4.83305   |      0.886 |      0.446 |  120/150  
		  183/1000 | 0.000039   |    1.74043   |    4.79657   |      0.896 |      0.454 |  121/150  
		  184/1000 | 0.000039   |    1.65392   |    4.79507   |      0.906 |      0.454 |  122/150  
		  185/1000 | 0.000039   |    3.28964   |    4.86272   |      0.894 |      0.439 |  123/150  
		  186/1000 | 0.000039   |    1.75263   |    4.88120   |      0.915 |      0.435 |  124/150  
		  187/1000 | 0.000039   |    4.19646   |    4.77242   |      0.865 |      0.460 |  125/150  
		  188/1000 | 0.000039   |    2.33407   |    4.76785   |      0.899 |      0.461 |  126/150  
		  189/1000 | 0.000020   |    1.74991   |    4.74944   |      0.923 |      0.465 |  127/150  
		  190/1000 | 0.000020   |    1.85686   |    4.74268   |      0.913 |      0.466 |  128/150  
		  191/1000 | 0.000020   |    1.97687   |    4.75289   |      0.912 |      0.464 |  129/150  
		  192/1000 | 0.000020   |    3.62842   |    4.77975   |      0.912 |      0.458 |  130/150  
		  193/1000 | 0.000020   |    3.07055   |    4.77669   |      0.876 |      0.459 |  131/150  
		  194/1000 | 0.000020   |    2.58057   |    4.79821   |      0.910 |      0.454 |  132/150  
		  195/1000 | 0.000020   |    2.63222   |    4.77569   |      0.912 |      0.459 |  133/150  
		  196/1000 | 0.000020   |    2.00045   |    4.77137   |      0.888 |      0.460 |  134/150  
		  197/1000 | 0.000020   |    1.93856   |    4.80589   |      0.892 |      0.452 |  135/150  
		  198/1000 | 0.000020   |    1.69642   |    4.77718   |      0.912 |      0.459 |  136/150  
		  199/1000 | 0.000020   |    1.81048   |    4.78463   |      0.903 |      0.457 |  137/150  
		  200/1000 | 0.000020   |    3.43450   |    4.73890   |      0.897 |      0.467 |  138/150  
		  201/1000 | 0.000020   |    5.38791   |    4.74538   |      0.857 |      0.466 |  139/150  
		  202/1000 | 0.000020   |    2.37441   |    4.77748   |      0.916 |      0.458 |  140/150  
		  203/1000 | 0.000020   |    2.23887   |    4.82749   |      0.897 |      0.447 |  141/150  
		  204/1000 | 0.000020   |    1.75184   |    4.77619   |      0.911 |      0.459 |  142/150  
		  205/1000 | 0.000010   |    2.48131   |    4.76628   |      0.909 |      0.461 |  143/150  
		  206/1000 | 0.000010   |    2.07034   |    4.77157   |      0.904 |      0.460 |  144/150  
		  207/1000 | 0.000010   |    4.23928   |    4.79316   |      0.886 |      0.455 |  145/150  
		  208/1000 | 0.000010   |    1.78442   |    4.75794   |      0.911 |      0.463 |  146/150  
		  209/1000 | 0.000010   |    2.76684   |    4.79137   |      0.906 |      0.455 |  147/150  
		  210/1000 | 0.000010   |    1.73069   |    4.76387   |      0.896 |      0.462 |  148/150  
		  211/1000 | 0.000010   |    5.27930   |    4.82317   |      0.870 |      0.448 |  149/150  

		Early stopping triggered.
		[INFO] Case 1 completed.

	3.2 Training Case 2...
		=== Training Log Started: 2025-11-28 22:08:52.018511 ===
		Run Name: STAFV2_24_CASE2
		Device: cuda
		Epochs: 1000, Batch Size: 128, LR: 0.01
		============================================================
		[INFO] Unique quantized indices: 24142
		[INFO] Suggested num_embeddings: 28970
		[INFO] Processed 1545 valid samples.
		[INFO] Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_24_CASE2.csv  (shape: (1545, 429))
		[INFO] Saved feature metadata: ./data/training_results/feature_info_STAFV2_24_CASE2.json
		[INFO] Dataset split: 1236 train, 309 val
		[INFO] Scalers fitted and saved.

		✅ Model initialized with 715620 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train R²  |   Val R²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/1000 | 0.010000   |    9.21672   |    7.99165   |     -1.087 |     -0.516 |    0/150  
		    2/1000 | 0.010000   |    8.14779   |    6.50447   |     -0.643 |      0.009 |    0/150  
		    3/1000 | 0.010000   |    6.89547   |    5.76748   |     -0.158 |      0.220 |    0/150  
		    4/1000 | 0.010000   |    5.51821   |    5.03729   |      0.250 |      0.392 |    0/150  
		    5/1000 | 0.010000   |    4.14097   |    4.83023   |      0.578 |      0.443 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.8302)
		    6/1000 | 0.010000   |    3.45842   |    4.25046   |      0.705 |      0.544 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.2505)
		    7/1000 | 0.010000   |    3.02415   |    4.09587   |      0.775 |      0.574 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.0959)
		    8/1000 | 0.010000   |    2.76514   |    4.02552   |      0.811 |      0.595 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.0255)
		    9/1000 | 0.010000   |    2.60869   |    3.93406   |      0.833 |      0.603 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 3.9341)
		   10/1000 | 0.010000   |    2.42188   |    4.46455   |      0.855 |      0.523 |    0/150  
		   11/1000 | 0.010000   |    2.37489   |    3.99368   |      0.865 |      0.595 |    1/150  
		   12/1000 | 0.010000   |    2.35086   |    3.94344   |      0.865 |      0.600 |    2/150  
		   13/1000 | 0.010000   |    2.26991   |    4.02022   |      0.874 |      0.589 |    3/150  
		   14/1000 | 0.010000   |    2.15391   |    4.04104   |      0.886 |      0.584 |    4/150  
		   15/1000 | 0.010000   |    2.05485   |    4.19332   |      0.896 |      0.552 |    5/150  
		   16/1000 | 0.010000   |    2.04663   |    3.97253   |      0.898 |      0.594 |    6/150  
		   17/1000 | 0.010000   |    2.09073   |    3.93635   |      0.892 |      0.605 |    7/150  
		   18/1000 | 0.010000   |    2.04055   |    4.02347   |      0.898 |      0.589 |    8/150  
		   19/1000 | 0.010000   |    1.93379   |    4.07133   |      0.907 |      0.588 |    9/150  
		   20/1000 | 0.010000   |    2.09412   |    4.02171   |      0.892 |      0.586 |   10/150  
		   21/1000 | 0.010000   |    1.86329   |    4.01266   |      0.916 |      0.598 |   11/150  
		   22/1000 | 0.010000   |    1.96952   |    4.04689   |      0.905 |      0.585 |   12/150  
		   23/1000 | 0.010000   |    1.99889   |    3.89182   |      0.901 |      0.611 |   13/150  
		                                          ╚══> ✅ SAVED (RMSE: 3.8918)
		   24/1000 | 0.010000   |    1.97243   |    3.96734   |      0.904 |      0.604 |    0/150  
		   25/1000 | 0.010000   |    1.87354   |    4.06762   |      0.913 |      0.584 |    1/150  
		   26/1000 | 0.010000   |    1.78780   |    3.92898   |      0.922 |      0.604 |    2/150  
		   27/1000 | 0.010000   |    1.76168   |    3.93614   |      0.923 |      0.608 |    3/150  
		   28/1000 | 0.010000   |    1.92149   |    3.98721   |      0.910 |      0.598 |    4/150  
		   29/1000 | 0.010000   |    1.74564   |    4.08187   |      0.925 |      0.573 |    5/150  
		   30/1000 | 0.010000   |    1.71870   |    3.94234   |      0.927 |      0.600 |    6/150  
		   31/1000 | 0.010000   |    1.73431   |    4.09048   |      0.925 |      0.569 |    7/150  
		   32/1000 | 0.010000   |    1.83097   |    3.93271   |      0.919 |      0.602 |    8/150  
		   33/1000 | 0.010000   |    1.68828   |    4.08254   |      0.930 |      0.580 |    9/150  
		   34/1000 | 0.010000   |    1.74152   |    4.12577   |      0.927 |      0.573 |   10/150  
		   35/1000 | 0.010000   |    1.60498   |    4.07972   |      0.936 |      0.588 |   11/150  
		   36/1000 | 0.010000   |    1.64276   |    4.07264   |      0.934 |      0.582 |   12/150  
		   37/1000 | 0.010000   |    1.76796   |    3.94491   |      0.925 |      0.603 |   13/150  
		   38/1000 | 0.010000   |    1.82533   |    4.12669   |      0.918 |      0.571 |   14/150  
		   39/1000 | 0.005000   |    1.60202   |    4.03606   |      0.937 |      0.580 |   15/150  
		   40/1000 | 0.005000   |    1.53923   |    4.06353   |      0.942 |      0.577 |   16/150  
		   41/1000 | 0.005000   |    1.72300   |    4.11347   |      0.927 |      0.563 |   17/150  
		   42/1000 | 0.005000   |    1.58513   |    4.04411   |      0.938 |      0.578 |   18/150  
		   43/1000 | 0.005000   |    1.67231   |    4.09088   |      0.931 |      0.567 |   19/150  
		   44/1000 | 0.005000   |    1.70712   |    4.15454   |      0.929 |      0.558 |   20/150  
		   45/1000 | 0.005000   |    1.58949   |    4.07003   |      0.938 |      0.580 |   21/150  
		   46/1000 | 0.005000   |    1.60949   |    4.04460   |      0.936 |      0.580 |   22/150  
		   47/1000 | 0.005000   |    1.61217   |    4.02392   |      0.936 |      0.588 |   23/150  
		   48/1000 | 0.005000   |    1.69907   |    4.11437   |      0.929 |      0.564 |   24/150  
		   49/1000 | 0.005000   |    1.76589   |    4.03903   |      0.926 |      0.581 |   25/150  
		   50/1000 | 0.005000   |    1.61719   |    4.03503   |      0.936 |      0.582 |   26/150  
		   51/1000 | 0.005000   |    1.64353   |    3.97049   |      0.934 |      0.595 |   27/150  
		   52/1000 | 0.005000   |    1.61329   |    3.96636   |      0.936 |      0.596 |   28/150  
		   53/1000 | 0.005000   |    1.52550   |    4.03653   |      0.944 |      0.583 |   29/150  
		   54/1000 | 0.005000   |    1.53989   |    3.95508   |      0.942 |      0.596 |   30/150  
		   55/1000 | 0.002500   |    1.52392   |    3.98221   |      0.943 |      0.591 |   31/150  
		   56/1000 | 0.002500   |    1.62361   |    4.03171   |      0.935 |      0.587 |   32/150  
		   57/1000 | 0.002500   |    1.52779   |    4.04744   |      0.943 |      0.584 |   33/150  
		   58/1000 | 0.002500   |    1.49180   |    4.02580   |      0.945 |      0.585 |   34/150  
		   59/1000 | 0.002500   |    1.52772   |    4.00574   |      0.943 |      0.586 |   35/150  
		   60/1000 | 0.002500   |    1.48689   |    3.97448   |      0.947 |      0.596 |   36/150  
		   61/1000 | 0.002500   |    1.53147   |    3.96283   |      0.944 |      0.595 |   37/150  
		   62/1000 | 0.002500   |    1.42968   |    4.00645   |      0.950 |      0.586 |   38/150  
		   63/1000 | 0.002500   |    1.53483   |    4.01342   |      0.941 |      0.588 |   39/150  
		   64/1000 | 0.002500   |    1.55600   |    4.00009   |      0.941 |      0.591 |   40/150  
		   65/1000 | 0.002500   |    1.56296   |    3.99832   |      0.941 |      0.589 |   41/150  
		   66/1000 | 0.002500   |    1.61897   |    4.02863   |      0.937 |      0.581 |   42/150  
		   67/1000 | 0.002500   |    1.63425   |    4.00099   |      0.934 |      0.584 |   43/150  
		   68/1000 | 0.002500   |    1.47797   |    3.99437   |      0.946 |      0.585 |   44/150  
		   69/1000 | 0.002500   |    1.53695   |    4.00316   |      0.942 |      0.586 |   45/150  
		   70/1000 | 0.002500   |    1.42692   |    4.03535   |      0.950 |      0.581 |   46/150  
		   71/1000 | 0.001250   |    1.59729   |    4.05124   |      0.938 |      0.578 |   47/150  
		   72/1000 | 0.001250   |    1.62725   |    4.01073   |      0.935 |      0.586 |   48/150  
		   73/1000 | 0.001250   |    1.53692   |    4.00001   |      0.942 |      0.587 |   49/150  
		   74/1000 | 0.001250   |    1.43130   |    4.01923   |      0.950 |      0.585 |   50/150  
		   75/1000 | 0.001250   |    1.41690   |    4.03232   |      0.950 |      0.581 |   51/150  
		   76/1000 | 0.001250   |    1.49033   |    4.02910   |      0.946 |      0.582 |   52/150  
		   77/1000 | 0.001250   |    1.61404   |    4.02386   |      0.937 |      0.583 |   53/150  
		   78/1000 | 0.001250   |    1.43902   |    4.04041   |      0.949 |      0.580 |   54/150  
		   79/1000 | 0.001250   |    1.56016   |    4.05468   |      0.940 |      0.575 |   55/150  
		   80/1000 | 0.001250   |    1.43780   |    4.02648   |      0.949 |      0.580 |   56/150  
		   81/1000 | 0.001250   |    1.53294   |    4.01362   |      0.942 |      0.586 |   57/150  
		   82/1000 | 0.001250   |    1.44820   |    4.02328   |      0.948 |      0.586 |   58/150  
		   83/1000 | 0.001250   |    1.42484   |    4.05857   |      0.950 |      0.578 |   59/150  
		   84/1000 | 0.001250   |    1.45403   |    4.07789   |      0.948 |      0.575 |   60/150  
		   85/1000 | 0.001250   |    1.46361   |    4.09810   |      0.948 |      0.568 |   61/150  
		   86/1000 | 0.001250   |    1.61138   |    4.07460   |      0.937 |      0.572 |   62/150  
		   87/1000 | 0.000625   |    1.49505   |    4.05836   |      0.945 |      0.577 |   63/150  
		   88/1000 | 0.000625   |    1.38802   |    4.05981   |      0.953 |      0.577 |   64/150  
		   89/1000 | 0.000625   |    1.49928   |    4.06310   |      0.945 |      0.574 |   65/150  
		   90/1000 | 0.000625   |    1.37144   |    4.05923   |      0.953 |      0.576 |   66/150  
		   91/1000 | 0.000625   |    1.44920   |    4.06130   |      0.948 |      0.577 |   67/150  
		   92/1000 | 0.000625   |    1.47705   |    4.07026   |      0.946 |      0.574 |   68/150  
		   93/1000 | 0.000625   |    1.54921   |    4.07079   |      0.940 |      0.573 |   69/150  
		   94/1000 | 0.000625   |    1.48703   |    4.07195   |      0.946 |      0.573 |   70/150  
		   95/1000 | 0.000625   |    1.51361   |    4.08132   |      0.944 |      0.570 |   71/150  
		   96/1000 | 0.000625   |    1.48937   |    4.10275   |      0.946 |      0.565 |   72/150  
		   97/1000 | 0.000625   |    1.47552   |    4.09081   |      0.946 |      0.567 |   73/150  
		   98/1000 | 0.000625   |    1.42759   |    4.09656   |      0.950 |      0.566 |   74/150  
		   99/1000 | 0.000625   |    1.68531   |    4.10275   |      0.930 |      0.566 |   75/150  
		  100/1000 | 0.000625   |    1.57134   |    4.10639   |      0.939 |      0.568 |   76/150  
		  101/1000 | 0.000625   |    1.51460   |    4.10276   |      0.944 |      0.568 |   77/150  
		  102/1000 | 0.000625   |    1.47162   |    4.09465   |      0.946 |      0.568 |   78/150  
		  103/1000 | 0.000313   |    1.60623   |    4.10920   |      0.938 |      0.565 |   79/150  
		  104/1000 | 0.000313   |    1.47852   |    4.11693   |      0.946 |      0.565 |   80/150  
		  105/1000 | 0.000313   |    1.39465   |    4.11529   |      0.952 |      0.565 |   81/150  
		  106/1000 | 0.000313   |    1.35442   |    4.10305   |      0.955 |      0.567 |   82/150  
		  107/1000 | 0.000313   |    1.39238   |    4.09831   |      0.953 |      0.568 |   83/150  
		  108/1000 | 0.000313   |    1.44917   |    4.10152   |      0.948 |      0.568 |   84/150  
		  109/1000 | 0.000313   |    1.50047   |    4.10845   |      0.945 |      0.567 |   85/150  
		  110/1000 | 0.000313   |    1.55746   |    4.11270   |      0.940 |      0.564 |   86/150  
		  111/1000 | 0.000313   |    1.42513   |    4.10586   |      0.950 |      0.566 |   87/150  
		  112/1000 | 0.000313   |    1.51673   |    4.10129   |      0.943 |      0.566 |   88/150  
		  113/1000 | 0.000313   |    1.46192   |    4.10011   |      0.947 |      0.568 |   89/150  
		  114/1000 | 0.000313   |    1.49431   |    4.11699   |      0.945 |      0.563 |   90/150  
		  115/1000 | 0.000313   |    1.45096   |    4.10505   |      0.948 |      0.567 |   91/150  
		  116/1000 | 0.000313   |    1.55148   |    4.08995   |      0.943 |      0.571 |   92/150  
		  117/1000 | 0.000313   |    1.45421   |    4.07910   |      0.948 |      0.573 |   93/150  
		  118/1000 | 0.000313   |    1.47955   |    4.08013   |      0.947 |      0.571 |   94/150  
		  119/1000 | 0.000156   |    1.48636   |    4.09097   |      0.946 |      0.569 |   95/150  
		  120/1000 | 0.000156   |    1.51902   |    4.10064   |      0.944 |      0.566 |   96/150  
		  121/1000 | 0.000156   |    1.42046   |    4.09777   |      0.951 |      0.568 |   97/150  
		  122/1000 | 0.000156   |    1.46848   |    4.11207   |      0.947 |      0.564 |   98/150  
		  123/1000 | 0.000156   |    1.46871   |    4.10137   |      0.947 |      0.568 |   99/150  
		  124/1000 | 0.000156   |    1.46648   |    4.09956   |      0.947 |      0.569 |  100/150  
		  125/1000 | 0.000156   |    1.38502   |    4.10589   |      0.953 |      0.566 |  101/150  
		  126/1000 | 0.000156   |    1.52779   |    4.11121   |      0.943 |      0.566 |  102/150  
		  127/1000 | 0.000156   |    1.54345   |    4.12725   |      0.941 |      0.562 |  103/150  
		  128/1000 | 0.000156   |    1.42384   |    4.11199   |      0.950 |      0.565 |  104/150  
		  129/1000 | 0.000156   |    1.39108   |    4.10611   |      0.952 |      0.567 |  105/150  
		  130/1000 | 0.000156   |    1.50480   |    4.10422   |      0.945 |      0.567 |  106/150  
		  131/1000 | 0.000156   |    1.61732   |    4.09360   |      0.935 |      0.571 |  107/150  
		  132/1000 | 0.000156   |    1.54052   |    4.08152   |      0.943 |      0.573 |  108/150  
		  133/1000 | 0.000156   |    1.44123   |    4.08151   |      0.948 |      0.573 |  109/150  
		  134/1000 | 0.000156   |    1.43501   |    4.08824   |      0.949 |      0.572 |  110/150  
		  135/1000 | 0.000078   |    1.50361   |    4.08894   |      0.944 |      0.571 |  111/150  
		  136/1000 | 0.000078   |    1.42172   |    4.09606   |      0.950 |      0.569 |  112/150  
		  137/1000 | 0.000078   |    1.38449   |    4.10396   |      0.953 |      0.566 |  113/150  
		  138/1000 | 0.000078   |    1.47855   |    4.10023   |      0.947 |      0.567 |  114/150  
		  139/1000 | 0.000078   |    1.36693   |    4.10601   |      0.954 |      0.565 |  115/150  
		  140/1000 | 0.000078   |    1.44745   |    4.09805   |      0.949 |      0.567 |  116/150  
		  141/1000 | 0.000078   |    1.41405   |    4.10490   |      0.951 |      0.565 |  117/150  
		  142/1000 | 0.000078   |    1.40398   |    4.12003   |      0.952 |      0.561 |  118/150  
		  143/1000 | 0.000078   |    1.41709   |    4.10402   |      0.951 |      0.565 |  119/150  
		  144/1000 | 0.000078   |    1.55121   |    4.09799   |      0.941 |      0.567 |  120/150  
		  145/1000 | 0.000078   |    1.51883   |    4.11960   |      0.944 |      0.561 |  121/150  
		  146/1000 | 0.000078   |    1.48801   |    4.10214   |      0.946 |      0.565 |  122/150  
		  147/1000 | 0.000078   |    1.43161   |    4.11548   |      0.949 |      0.562 |  123/150  
		  148/1000 | 0.000078   |    1.51278   |    4.10203   |      0.943 |      0.566 |  124/150  
		  149/1000 | 0.000078   |    1.41873   |    4.10981   |      0.950 |      0.564 |  125/150  
		  150/1000 | 0.000078   |    1.40662   |    4.09562   |      0.952 |      0.569 |  126/150  
		  151/1000 | 0.000039   |    1.45567   |    4.11628   |      0.948 |      0.562 |  127/150  
		  152/1000 | 0.000039   |    1.48719   |    4.10398   |      0.946 |      0.566 |  128/150  
		  153/1000 | 0.000039   |    1.45347   |    4.10491   |      0.948 |      0.566 |  129/150  
		  154/1000 | 0.000039   |    1.50670   |    4.10312   |      0.945 |      0.566 |  130/150  
		  155/1000 | 0.000039   |    1.48719   |    4.10544   |      0.946 |      0.565 |  131/150  
		  156/1000 | 0.000039   |    1.48253   |    4.10570   |      0.946 |      0.567 |  132/150  
		  157/1000 | 0.000039   |    1.42015   |    4.12115   |      0.950 |      0.561 |  133/150  
		  158/1000 | 0.000039   |    1.42923   |    4.12439   |      0.951 |      0.560 |  134/150  
		  159/1000 | 0.000039   |    1.44781   |    4.12489   |      0.948 |      0.560 |  135/150  
		  160/1000 | 0.000039   |    1.43168   |    4.10895   |      0.949 |      0.565 |  136/150  
		  161/1000 | 0.000039   |    1.48891   |    4.11486   |      0.945 |      0.564 |  137/150  
		  162/1000 | 0.000039   |    1.39266   |    4.11803   |      0.952 |      0.563 |  138/150  
		  163/1000 | 0.000039   |    1.38821   |    4.11962   |      0.953 |      0.562 |  139/150  
		  164/1000 | 0.000039   |    1.43111   |    4.11204   |      0.950 |      0.564 |  140/150  
		  165/1000 | 0.000039   |    1.55809   |    4.10899   |      0.941 |      0.565 |  141/150  
		  166/1000 | 0.000039   |    1.56262   |    4.11566   |      0.940 |      0.563 |  142/150  
		  167/1000 | 0.000020   |    1.56902   |    4.12482   |      0.938 |      0.561 |  143/150  
		  168/1000 | 0.000020   |    1.57804   |    4.12362   |      0.940 |      0.561 |  144/150  
		  169/1000 | 0.000020   |    1.43186   |    4.12806   |      0.950 |      0.560 |  145/150  
		  170/1000 | 0.000020   |    1.43158   |    4.12785   |      0.950 |      0.560 |  146/150  
		  171/1000 | 0.000020   |    1.40787   |    4.11817   |      0.951 |      0.563 |  147/150  
		  172/1000 | 0.000020   |    1.43925   |    4.11305   |      0.949 |      0.564 |  148/150  
		  173/1000 | 0.000020   |    1.48157   |    4.11925   |      0.946 |      0.563 |  149/150  

		Early stopping triggered.
		[INFO] Case 2 completed.

	3.3 Training Case 3...
		=== Training Log Started: 2025-11-28 22:12:26.114544 ===
		Run Name: STAFV2_24_CASE3
		Device: cuda
		Epochs: 1000, Batch Size: 128, LR: 0.01
		============================================================
		[INFO] Unique quantized indices: 36535
		[INFO] Suggested num_embeddings: 43842
		[INFO] Processed 3545 valid samples.
		[INFO] Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_24_CASE3.csv  (shape: (3545, 429))
		[INFO] Saved feature metadata: ./data/training_results/feature_info_STAFV2_24_CASE3.json
		[INFO] Dataset split: 2836 train, 709 val
		[INFO] Scalers fitted and saved.

		✅ Model initialized with 715620 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train R²  |   Val R²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/1000 | 0.010000   |    8.34675   |    6.27020   |     -0.758 |      0.022 |    0/150  
		    2/1000 | 0.010000   |    5.81527   |    4.77083   |      0.152 |      0.429 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.7708)
		    3/1000 | 0.010000   |    4.08448   |    4.29758   |      0.578 |      0.531 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.2976)
		    4/1000 | 0.010000   |    3.63858   |    4.09873   |      0.679 |      0.583 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.0987)
		    5/1000 | 0.010000   |    3.25528   |    4.07956   |      0.738 |      0.581 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.0796)
		    6/1000 | 0.010000   |    2.77144   |    4.07688   |      0.805 |      0.581 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.0769)
		    7/1000 | 0.010000   |    2.62502   |    3.98965   |      0.838 |      0.599 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 3.9897)
		    8/1000 | 0.010000   |    2.40262   |    3.92658   |      0.854 |      0.608 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 3.9266)
		    9/1000 | 0.010000   |    2.32139   |    3.98961   |      0.864 |      0.601 |    0/150  
		   10/1000 | 0.010000   |    2.14406   |    4.03456   |      0.885 |      0.590 |    1/150  
		   11/1000 | 0.010000   |    2.15632   |    3.97619   |      0.886 |      0.599 |    2/150  
		   12/1000 | 0.010000   |    2.05646   |    4.16115   |      0.892 |      0.566 |    3/150  
		   13/1000 | 0.010000   |    1.99809   |    4.02046   |      0.898 |      0.594 |    4/150  
		   14/1000 | 0.010000   |    2.00282   |    4.02271   |      0.907 |      0.595 |    5/150  
		   15/1000 | 0.010000   |    2.03523   |    4.05270   |      0.898 |      0.588 |    6/150  
		   16/1000 | 0.010000   |    2.04634   |    4.23619   |      0.902 |      0.548 |    7/150  
		   17/1000 | 0.010000   |    2.02418   |    4.02094   |      0.900 |      0.594 |    8/150  
		   18/1000 | 0.010000   |    1.97240   |    3.97902   |      0.909 |      0.604 |    9/150  
		   19/1000 | 0.010000   |    1.92177   |    4.23921   |      0.912 |      0.546 |   10/150  
		   20/1000 | 0.010000   |    1.91687   |    4.07685   |      0.909 |      0.576 |   11/150  
		   21/1000 | 0.010000   |    1.98174   |    4.33616   |      0.908 |      0.520 |   12/150  
		   22/1000 | 0.010000   |    1.87807   |    4.23433   |      0.914 |      0.542 |   13/150  
		   23/1000 | 0.010000   |    1.75088   |    4.19156   |      0.924 |      0.552 |   14/150  
		   24/1000 | 0.005000   |    1.98851   |    4.08101   |      0.918 |      0.575 |   15/150  
		   25/1000 | 0.005000   |    1.83585   |    4.08610   |      0.917 |      0.573 |   16/150  
		   26/1000 | 0.005000   |    1.66858   |    4.17214   |      0.931 |      0.553 |   17/150  
		   27/1000 | 0.005000   |    1.58425   |    4.17379   |      0.938 |      0.556 |   18/150  
		   28/1000 | 0.005000   |    1.69913   |    4.19235   |      0.928 |      0.550 |   19/150  
		   29/1000 | 0.005000   |    1.73278   |    4.15284   |      0.925 |      0.562 |   20/150  
		   30/1000 | 0.005000   |    1.66426   |    4.23288   |      0.932 |      0.543 |   21/150  
		   31/1000 | 0.005000   |    1.60434   |    4.15044   |      0.935 |      0.563 |   22/150  
		   32/1000 | 0.005000   |    1.63854   |    4.09192   |      0.936 |      0.574 |   23/150  
		   33/1000 | 0.005000   |    1.58338   |    4.29711   |      0.937 |      0.526 |   24/150  
		   34/1000 | 0.005000   |    1.63097   |    4.12098   |      0.932 |      0.566 |   25/150  
		   35/1000 | 0.005000   |    1.61390   |    4.12175   |      0.937 |      0.568 |   26/150  
		   36/1000 | 0.005000   |    1.58319   |    4.15632   |      0.939 |      0.560 |   27/150  
		   37/1000 | 0.005000   |    1.62329   |    4.18193   |      0.937 |      0.556 |   28/150  
		   38/1000 | 0.005000   |    1.61547   |    4.12679   |      0.934 |      0.568 |   29/150  
		   39/1000 | 0.005000   |    1.88676   |    4.16852   |      0.932 |      0.558 |   30/150  
		   40/1000 | 0.002500   |    1.73519   |    4.18782   |      0.924 |      0.555 |   31/150  
		   41/1000 | 0.002500   |    1.72934   |    4.18426   |      0.931 |      0.553 |   32/150  
		   42/1000 | 0.002500   |    1.56788   |    4.12076   |      0.938 |      0.568 |   33/150  
		   43/1000 | 0.002500   |    1.49961   |    4.16393   |      0.945 |      0.558 |   34/150  
		   44/1000 | 0.002500   |    1.65167   |    4.16317   |      0.938 |      0.557 |   35/150  
		   45/1000 | 0.002500   |    1.51768   |    4.21269   |      0.941 |      0.547 |   36/150  
		   46/1000 | 0.002500   |    1.47486   |    4.16429   |      0.946 |      0.557 |   37/150  
		   47/1000 | 0.002500   |    1.57469   |    4.14639   |      0.939 |      0.562 |   38/150  
		   48/1000 | 0.002500   |    1.51185   |    4.12034   |      0.942 |      0.567 |   39/150  
		   49/1000 | 0.002500   |    1.44840   |    4.12688   |      0.947 |      0.565 |   40/150  
		   50/1000 | 0.002500   |    1.51084   |    4.08261   |      0.943 |      0.575 |   41/150  
		   51/1000 | 0.002500   |    1.55195   |    4.11319   |      0.944 |      0.570 |   42/150  
		   52/1000 | 0.002500   |    1.61499   |    4.11520   |      0.943 |      0.567 |   43/150  
		   53/1000 | 0.002500   |    1.56081   |    4.12815   |      0.938 |      0.566 |   44/150  
		   54/1000 | 0.002500   |    1.48151   |    4.14739   |      0.947 |      0.562 |   45/150  
		   55/1000 | 0.002500   |    1.47166   |    4.08348   |      0.946 |      0.575 |   46/150  
		   56/1000 | 0.001250   |    1.59656   |    4.14422   |      0.944 |      0.564 |   47/150  
		   57/1000 | 0.001250   |    1.55878   |    4.12008   |      0.943 |      0.567 |   48/150  
		   58/1000 | 0.001250   |    1.53952   |    4.14338   |      0.942 |      0.562 |   49/150  
		   59/1000 | 0.001250   |    1.42290   |    4.15748   |      0.950 |      0.560 |   50/150  
		   60/1000 | 0.001250   |    1.50487   |    4.11064   |      0.943 |      0.569 |   51/150  
		   61/1000 | 0.001250   |    1.47827   |    4.14173   |      0.947 |      0.562 |   52/150  
		   62/1000 | 0.001250   |    1.40062   |    4.16647   |      0.951 |      0.558 |   53/150  
		   63/1000 | 0.001250   |    1.52852   |    4.10385   |      0.945 |      0.570 |   54/150  
		   64/1000 | 0.001250   |    1.50036   |    4.07596   |      0.948 |      0.577 |   55/150  
		   65/1000 | 0.001250   |    1.49262   |    4.10521   |      0.946 |      0.572 |   56/150  
		   66/1000 | 0.001250   |    1.46593   |    4.14749   |      0.946 |      0.562 |   57/150  
		   67/1000 | 0.001250   |    1.49738   |    4.11352   |      0.943 |      0.568 |   58/150  
		   68/1000 | 0.001250   |    1.43935   |    4.10718   |      0.948 |      0.569 |   59/150  
		   69/1000 | 0.001250   |    1.49764   |    4.12391   |      0.947 |      0.566 |   60/150  
		   70/1000 | 0.001250   |    1.39845   |    4.11749   |      0.953 |      0.568 |   61/150  
		   71/1000 | 0.001250   |    1.56356   |    4.12352   |      0.947 |      0.565 |   62/150  
		   72/1000 | 0.000625   |    1.42614   |    4.17029   |      0.951 |      0.556 |   63/150  
		   73/1000 | 0.000625   |    1.45011   |    4.15552   |      0.949 |      0.561 |   64/150  
		   74/1000 | 0.000625   |    1.49056   |    4.12486   |      0.944 |      0.568 |   65/150  
		   75/1000 | 0.000625   |    1.48080   |    4.13744   |      0.949 |      0.565 |   66/150  
		   76/1000 | 0.000625   |    1.49599   |    4.11807   |      0.945 |      0.568 |   67/150  
		   77/1000 | 0.000625   |    1.47433   |    4.14840   |      0.947 |      0.562 |   68/150  
		   78/1000 | 0.000625   |    1.42096   |    4.16041   |      0.949 |      0.559 |   69/150  
		   79/1000 | 0.000625   |    1.41709   |    4.18903   |      0.951 |      0.553 |   70/150  
		   80/1000 | 0.000625   |    1.51808   |    4.20425   |      0.948 |      0.549 |   71/150  
		   81/1000 | 0.000625   |    1.47088   |    4.20710   |      0.948 |      0.549 |   72/150  
		   82/1000 | 0.000625   |    1.40914   |    4.16615   |      0.950 |      0.558 |   73/150  
		   83/1000 | 0.000625   |    1.48843   |    4.17444   |      0.946 |      0.556 |   74/150  
		   84/1000 | 0.000625   |    1.51293   |    4.18472   |      0.949 |      0.552 |   75/150  
		   85/1000 | 0.000625   |    1.40337   |    4.16816   |      0.952 |      0.558 |   76/150  
		   86/1000 | 0.000625   |    1.48302   |    4.16019   |      0.945 |      0.560 |   77/150  
		   87/1000 | 0.000625   |    1.41956   |    4.16521   |      0.950 |      0.559 |   78/150  
		   88/1000 | 0.000313   |    1.49721   |    4.19259   |      0.944 |      0.553 |   79/150  
		   89/1000 | 0.000313   |    1.34075   |    4.18293   |      0.955 |      0.555 |   80/150  
		   90/1000 | 0.000313   |    1.53808   |    4.15384   |      0.945 |      0.560 |   81/150  
		   91/1000 | 0.000313   |    1.57990   |    4.16340   |      0.946 |      0.558 |   82/150  
		   92/1000 | 0.000313   |    1.47634   |    4.18835   |      0.946 |      0.554 |   83/150  
		   93/1000 | 0.000313   |    1.40569   |    4.19280   |      0.951 |      0.552 |   84/150  
		   94/1000 | 0.000313   |    1.44245   |    4.17577   |      0.948 |      0.557 |   85/150  
		   95/1000 | 0.000313   |    1.43395   |    4.16750   |      0.949 |      0.557 |   86/150  
		   96/1000 | 0.000313   |    1.44004   |    4.17882   |      0.948 |      0.555 |   87/150  
		   97/1000 | 0.000313   |    1.44517   |    4.18699   |      0.950 |      0.554 |   88/150  
		   98/1000 | 0.000313   |    1.51316   |    4.17404   |      0.952 |      0.555 |   89/150  
		   99/1000 | 0.000313   |    1.46068   |    4.19740   |      0.950 |      0.551 |   90/150  
		  100/1000 | 0.000313   |    1.45515   |    4.16807   |      0.947 |      0.559 |   91/150  
		  101/1000 | 0.000313   |    1.46378   |    4.19199   |      0.946 |      0.554 |   92/150  
		  102/1000 | 0.000313   |    1.42408   |    4.20266   |      0.949 |      0.551 |   93/150  
		  103/1000 | 0.000313   |    1.33979   |    4.17750   |      0.955 |      0.556 |   94/150  
		  104/1000 | 0.000156   |    1.60562   |    4.21012   |      0.943 |      0.551 |   95/150  
		  105/1000 | 0.000156   |    1.54496   |    4.19132   |      0.944 |      0.553 |   96/150  
		  106/1000 | 0.000156   |    1.46704   |    4.16965   |      0.948 |      0.558 |   97/150  
		  107/1000 | 0.000156   |    1.51673   |    4.19121   |      0.951 |      0.553 |   98/150  
		  108/1000 | 0.000156   |    1.48670   |    4.17402   |      0.946 |      0.557 |   99/150  
		  109/1000 | 0.000156   |    1.53609   |    4.19042   |      0.942 |      0.554 |  100/150  
		  110/1000 | 0.000156   |    1.48114   |    4.19080   |      0.948 |      0.553 |  101/150  
		  111/1000 | 0.000156   |    1.34829   |    4.19454   |      0.954 |      0.553 |  102/150  
		  112/1000 | 0.000156   |    1.47769   |    4.20161   |      0.948 |      0.552 |  103/150  
		  113/1000 | 0.000156   |    1.44095   |    4.18589   |      0.948 |      0.556 |  104/150  
		  114/1000 | 0.000156   |    1.37153   |    4.19733   |      0.952 |      0.553 |  105/150  
		  115/1000 | 0.000156   |    1.59787   |    4.18838   |      0.945 |      0.554 |  106/150  
		  116/1000 | 0.000156   |    1.42558   |    4.16208   |      0.948 |      0.560 |  107/150  
		  117/1000 | 0.000156   |    1.43685   |    4.17624   |      0.948 |      0.556 |  108/150  
		  118/1000 | 0.000156   |    1.43097   |    4.19291   |      0.949 |      0.553 |  109/150  
		  119/1000 | 0.000156   |    1.37608   |    4.19401   |      0.952 |      0.553 |  110/150  
		  120/1000 | 0.000078   |    1.39146   |    4.18087   |      0.952 |      0.555 |  111/150  
		  121/1000 | 0.000078   |    1.49302   |    4.19069   |      0.948 |      0.554 |  112/150  
		  122/1000 | 0.000078   |    1.43132   |    4.17938   |      0.948 |      0.556 |  113/150  
		  123/1000 | 0.000078   |    1.41546   |    4.18763   |      0.949 |      0.554 |  114/150  
		  124/1000 | 0.000078   |    1.41709   |    4.17345   |      0.949 |      0.557 |  115/150  
		  125/1000 | 0.000078   |    1.47203   |    4.20282   |      0.952 |      0.550 |  116/150  
		  126/1000 | 0.000078   |    1.40998   |    4.19735   |      0.951 |      0.552 |  117/150  
		  127/1000 | 0.000078   |    1.45941   |    4.19818   |      0.948 |      0.553 |  118/150  
		  128/1000 | 0.000078   |    1.51449   |    4.17397   |      0.942 |      0.557 |  119/150  
		  129/1000 | 0.000078   |    1.43363   |    4.19148   |      0.949 |      0.553 |  120/150  
		  130/1000 | 0.000078   |    1.40989   |    4.17419   |      0.952 |      0.557 |  121/150  
		  131/1000 | 0.000078   |    1.42536   |    4.20380   |      0.951 |      0.551 |  122/150  
		  132/1000 | 0.000078   |    1.41914   |    4.20524   |      0.950 |      0.551 |  123/150  
		  133/1000 | 0.000078   |    1.47827   |    4.19449   |      0.947 |      0.552 |  124/150  
		  134/1000 | 0.000078   |    1.50006   |    4.19590   |      0.944 |      0.553 |  125/150  
		  135/1000 | 0.000078   |    1.50342   |    4.19433   |      0.951 |      0.552 |  126/150  
		  136/1000 | 0.000039   |    1.44243   |    4.21004   |      0.950 |      0.549 |  127/150  
		  137/1000 | 0.000039   |    1.37707   |    4.20490   |      0.954 |      0.551 |  128/150  
		  138/1000 | 0.000039   |    1.45251   |    4.20500   |      0.950 |      0.551 |  129/150  
		  139/1000 | 0.000039   |    1.36150   |    4.21750   |      0.954 |      0.549 |  130/150  
		  140/1000 | 0.000039   |    1.37832   |    4.19817   |      0.952 |      0.552 |  131/150  
		  141/1000 | 0.000039   |    1.49694   |    4.20183   |      0.946 |      0.551 |  132/150  
		  142/1000 | 0.000039   |    1.57690   |    4.20050   |      0.944 |      0.552 |  133/150  
		  143/1000 | 0.000039   |    1.38719   |    4.21602   |      0.953 |      0.549 |  134/150  
		  144/1000 | 0.000039   |    1.57753   |    4.20024   |      0.944 |      0.550 |  135/150  
		  145/1000 | 0.000039   |    1.54963   |    4.19332   |      0.944 |      0.552 |  136/150  
		  146/1000 | 0.000039   |    1.33049   |    4.19839   |      0.956 |      0.553 |  137/150  
		  147/1000 | 0.000039   |    1.38572   |    4.19500   |      0.952 |      0.553 |  138/150  
		  148/1000 | 0.000039   |    1.38926   |    4.20591   |      0.951 |      0.551 |  139/150  
		  149/1000 | 0.000039   |    1.42528   |    4.20549   |      0.949 |      0.551 |  140/150  
		  150/1000 | 0.000039   |    1.49152   |    4.18914   |      0.951 |      0.553 |  141/150  
		  151/1000 | 0.000039   |    1.42149   |    4.18836   |      0.950 |      0.553 |  142/150  
		  152/1000 | 0.000020   |    1.39361   |    4.19952   |      0.953 |      0.552 |  143/150  
		  153/1000 | 0.000020   |    1.44042   |    4.20678   |      0.949 |      0.551 |  144/150  
		  154/1000 | 0.000020   |    1.52396   |    4.18609   |      0.948 |      0.554 |  145/150  
		  155/1000 | 0.000020   |    1.40352   |    4.19458   |      0.950 |      0.553 |  146/150  
		  156/1000 | 0.000020   |    1.39469   |    4.19433   |      0.951 |      0.553 |  147/150  
		  157/1000 | 0.000020   |    1.50885   |    4.18680   |      0.948 |      0.554 |  148/150  
		  158/1000 | 0.000020   |    1.40708   |    4.19177   |      0.951 |      0.553 |  149/150  

		Early stopping triggered.
		[INFO] Case 3 completed.
