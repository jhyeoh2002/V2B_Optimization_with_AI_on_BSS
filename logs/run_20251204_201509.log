nohup: ignoring input
Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at 'data/battery_demandV2/resample_full.csv' and 'data/battery_demandV2/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1395, 37)
		[INFO] Case 1 exists â€” loaded battery demand from 'data/battery_demandV2/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists â€” loaded battery demand from 'data/battery_demandV2/case2_nan_filled/battery_demand.npy' with shape (1563, 37).
		[INFO] Case 0 exists â€” loaded battery demand from 'data/battery_demandV2/case0_test/battery_demand.npy' with shape (2, 49).

	1.6 Generating battery schedule...
		[INFO] Case 0 exists â€” loaded from 'data/battery_demandV2/case0_test/battery_availability.npy' and 'data/battery_demandV2/case0_test/battery_details.npy' shape (2, 272, 48) and (4, 2, 272)
		[INFO] Case 1 exists â€” loaded from 'data/battery_demandV2/case1_real_only/battery_availability.npy' and 'data/battery_demandV2/case1_real_only/battery_details.npy' shape (168, 237, 36) and (4, 168, 237)
		[INFO] Case 2 exists â€” loaded from 'data/battery_demandV2/case2_nan_filled/battery_availability.npy' and 'data/battery_demandV2/case2_nan_filled/battery_details.npy' shape (1563, 237, 36) and (4, 1563, 237)
		[ERROR] Could not load battery demand from 'data/battery_demandV2/case3_extended_generated/battery_demand.npy': [Errno 2] No such file or directory: 'data/battery_demandV2/case3_extended_generated/battery_demand.npy'


==================================================
PART 2: MILP Optimization...
==================================================

	2.0 Optimizing Case 0...
		[INFO] Loaded 2 samples from 'data/battery_demandV2/case0_test'
		[INFO] Results already exist at 'data/optimization_resultsV2/case0_test/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at 'data/optimization_resultsV2/case0_test/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 0 completed.

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from 'data/battery_demandV2/case1_real_only'
		[INFO] Results already exist at 'data/optimization_resultsV2/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at 'data/optimization_resultsV2/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1563 samples from 'data/battery_demandV2/case2_nan_filled'
		[INFO] Results already exist at 'data/optimization_resultsV2/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at 'data/optimization_resultsV2/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 2 completed.


==================================================
PART 3: Supervised Learning...
==================================================

	3.1 Training Case 1...

=== Starting Training Run: STAFV5_CASE1 ===
Device: cuda
		[INFO] Starting Preprocessing for Case 1...
		[INFO] Unique quantized indices: 6686
		[INFO] Suggested num_embeddings: 8023
		[INFO] Generating sliding windows...
		[INFO] Saved dataset: ./data/training_results/STAFV5_CASE1/merged_dataset_STAFV5_CASE1.csv (Shape: (2016, 225))
		[INFO] Saved metadata: ./data/training_results/STAFV5_CASE1/feature_info_STAFV5_CASE1.json
	[Model Config] Detected Dims: {'static': 4, 'series_count': 6, 'seq_len': 24, 'vehicle': 76, 'emb_vocab': 8023}
		[INFO] Data loaded. Train: 1411, Val: 605
		[INFO] Fitting new scalers on training data...
		[INFO] Calculating weights for imbalanced regression...
		[INFO] 
==================================================
		[INFO] ðŸš€ TRAINING SESSION: STAFV5_CASE1
		[INFO] ==================================================
		[INFO] Device:             cuda
		[INFO] Model Parameters:   204,738
		[INFO] --------------------------------------------------
		[INFO] Epochs:             5000
		[INFO] Batch Size:         64
		[INFO] Learning Rate:      0.01
		[INFO] Weight Decay:       0.005
		[INFO] Dropout:            0.5
		[INFO] --------------------------------------------------
		[INFO] Hidden Layers:      [256, 64]
		[INFO] Embedding Dim:      16
		[INFO] Attention Heads:    4
		[INFO]==================================================


		[INFO]Epoch |    LR    | Trn RMSE | Val RMSE | Trn R2 | Val R2 | Stop
-----------------------------------------------------------------
		[INFO]    1 | 0.010000 |   6.2885 |  11.3811 |  0.398 | -1.542 | 0/100
		[INFO]    2 | 0.010000 |   5.8221 |   8.5018 |  0.554 | -0.421 | 0/100
		[INFO]    3 | 0.010000 |   4.6894 |   7.1272 |  0.681 | -0.001 | 0/100
		[INFO]    4 | 0.010000 |   4.5106 |   6.6468 |  0.704 |  0.132 | 0/100
		[INFO]    5 | 0.010000 |   4.3757 |   5.9997 |  0.733 |  0.296 | 0/100
		[INFO]    6 | 0.010000 |   4.7905 |   6.1535 |  0.715 |  0.261 | 0/100
		[INFO]    7 | 0.010000 |   4.1989 |   5.4829 |  0.771 |  0.406 | 1/100
		[INFO]    8 | 0.010000 |   4.1183 |   6.1572 |  0.746 |  0.259 | 0/100
		[INFO]    9 | 0.010000 |   4.1679 |   5.9347 |  0.770 |  0.310 | 1/100
		[INFO]   10 | 0.010000 |   3.8825 |   5.5539 |  0.786 |  0.395 | 2/100
		[INFO]   11 | 0.010000 |   3.6742 |   5.9167 |  0.802 |  0.313 | 3/100
		[INFO]   12 | 0.010000 |   4.1814 |   5.5140 |  0.784 |  0.399 | 4/100
		[INFO]   13 | 0.010000 |   3.6465 |   5.5636 |  0.795 |  0.392 | 5/100
		[INFO]   14 | 0.010000 |   3.9609 |   6.1482 |  0.783 |  0.259 | 6/100
		[INFO]   15 | 0.010000 |   3.9510 |   5.6158 |  0.785 |  0.383 | 7/100
		[INFO]   16 | 0.010000 |   3.9322 |   5.6277 |  0.802 |  0.381 | 8/100
		[INFO]   17 | 0.010000 |   4.0344 |   5.7819 |  0.766 |  0.349 | 9/100
		[INFO]   18 | 0.010000 |   3.9660 |   5.6060 |  0.789 |  0.387 | 10/100
		[INFO]   19 | 0.010000 |   3.7196 |   5.6018 |  0.791 |  0.392 | 11/100
		[INFO]   20 | 0.010000 |   4.2887 |   5.5535 |  0.784 |  0.394 | 12/100
		[INFO]   21 | 0.010000 |   4.9535 |   6.5781 |  0.757 |  0.153 | 13/100
		[INFO]   22 | 0.010000 |   3.8468 |   6.2128 |  0.779 |  0.242 | 14/100
		[INFO]   23 | 0.010000 |   3.4795 |   5.4868 |  0.822 |  0.410 | 15/100
		[INFO]   24 | 0.010000 |   3.7747 |   5.9177 |  0.789 |  0.314 | 16/100
		[INFO]   25 | 0.010000 |   3.9688 |   5.1367 |  0.797 |  0.484 | 17/100
		[INFO]   26 | 0.010000 |   3.9107 |   5.4209 |  0.805 |  0.428 | 0/100
		[INFO]   27 | 0.010000 |   3.4316 |   5.6578 |  0.810 |  0.376 | 1/100
		[INFO]   28 | 0.010000 |   3.4908 |   5.8631 |  0.822 |  0.331 | 2/100
		[INFO]   29 | 0.010000 |   3.4112 |   5.4183 |  0.823 |  0.428 | 3/100
		[INFO]   30 | 0.010000 |   3.1809 |   5.1018 |  0.847 |  0.492 | 4/100
		[INFO]   31 | 0.010000 |   4.0002 |   5.5681 |  0.843 |  0.393 | 0/100
		[INFO]   32 | 0.010000 |   3.5392 |   5.4835 |  0.803 |  0.415 | 1/100
		[INFO]   33 | 0.010000 |   3.6217 |   6.5404 |  0.809 |  0.170 | 2/100
		[INFO]   34 | 0.010000 |   3.1963 |   5.4037 |  0.843 |  0.434 | 3/100
		[INFO]   35 | 0.010000 |   3.5052 |   5.4380 |  0.830 |  0.428 | 4/100
		[INFO]   36 | 0.010000 |   3.4761 |   5.4364 |  0.825 |  0.428 | 5/100
		[INFO]   37 | 0.010000 |   3.4237 |   5.2199 |  0.838 |  0.469 | 6/100
		[INFO]   38 | 0.010000 |   3.6197 |   5.8324 |  0.827 |  0.339 | 7/100
		[INFO]   39 | 0.010000 |   3.4513 |   5.3809 |  0.818 |  0.442 | 8/100
		[INFO]   40 | 0.010000 |   3.4959 |   5.6680 |  0.846 |  0.373 | 9/100
		[INFO]   41 | 0.010000 |   3.5703 |   5.7404 |  0.832 |  0.362 | 10/100
		[INFO]   42 | 0.010000 |   3.8864 |   5.7502 |  0.822 |  0.365 | 11/100
		[INFO]   43 | 0.010000 |   3.5626 |   5.6633 |  0.810 |  0.371 | 12/100
		[INFO]   44 | 0.010000 |   4.4177 |   6.0322 |  0.799 |  0.290 | 13/100
		[INFO]   45 | 0.010000 |   3.9756 |   5.8306 |  0.771 |  0.336 | 14/100
		[INFO]   46 | 0.010000 |   3.5284 |   5.4832 |  0.818 |  0.413 | 15/100
		[INFO]   47 | 0.010000 |   3.6457 |   5.8101 |  0.826 |  0.343 | 16/100
		[INFO]   48 | 0.010000 |   3.9358 |   5.9211 |  0.757 |  0.315 | 17/100
		[INFO]   49 | 0.010000 |   3.9085 |   5.2743 |  0.796 |  0.459 | 18/100
		[INFO]   50 | 0.010000 |   3.6698 |   5.9912 |  0.797 |  0.300 | 19/100
		[INFO]   51 | 0.010000 |   4.2900 |   5.1339 |  0.809 |  0.485 | 20/100
		[INFO]   52 | 0.007500 |   3.7230 |   5.4449 |  0.810 |  0.426 | 21/100
		[INFO]   53 | 0.007500 |   3.4561 |   5.2743 |  0.811 |  0.461 | 22/100
		[INFO]   54 | 0.007500 |   3.8888 |   5.7554 |  0.808 |  0.354 | 23/100
		[INFO]   55 | 0.007500 |   3.8095 |   5.4258 |  0.812 |  0.424 | 24/100
		[INFO]   56 | 0.007500 |   3.7179 |   5.7556 |  0.822 |  0.354 | 25/100
		[INFO]   57 | 0.007500 |   3.2129 |   5.6421 |  0.847 |  0.379 | 26/100
		[INFO]   58 | 0.007500 |   3.4429 |   5.2727 |  0.840 |  0.456 | 27/100
		[INFO]   59 | 0.007500 |   3.4520 |   5.2562 |  0.820 |  0.461 | 28/100
		[INFO]   60 | 0.007500 |   3.6330 |   5.1622 |  0.830 |  0.480 | 29/100
		[INFO]   61 | 0.007500 |   3.2934 |   5.3240 |  0.838 |  0.448 | 30/100
		[INFO]   62 | 0.007500 |   3.0823 |   5.6223 |  0.851 |  0.382 | 31/100
		[INFO]   63 | 0.007500 |   3.3694 |   5.0907 |  0.839 |  0.495 | 32/100
		[INFO]   64 | 0.007500 |   3.3504 |   5.3529 |  0.835 |  0.442 | 0/100
		[INFO]   65 | 0.007500 |   3.4714 |   5.1337 |  0.838 |  0.486 | 1/100
		[INFO]   66 | 0.007500 |   3.2484 |   5.3089 |  0.858 |  0.446 | 2/100
		[INFO]   67 | 0.007500 |   4.2348 |   4.7761 |  0.848 |  0.553 | 3/100
		[INFO]   68 | 0.007500 |   4.0725 |   5.5423 |  0.835 |  0.400 | 0/100
		[INFO]   69 | 0.007500 |   3.5843 |   5.1447 |  0.838 |  0.483 | 1/100
		[INFO]   70 | 0.007500 |   3.3313 |   5.9723 |  0.848 |  0.304 | 2/100
		[INFO]   71 | 0.007500 |   3.4498 |   5.5278 |  0.841 |  0.403 | 3/100
		[INFO]   72 | 0.007500 |   3.3248 |   4.9666 |  0.843 |  0.521 | 4/100
		[INFO]   73 | 0.007500 |   3.2951 |   4.9831 |  0.842 |  0.516 | 5/100
		[INFO]   74 | 0.007500 |   3.2842 |   5.4876 |  0.844 |  0.414 | 6/100
		[INFO]   75 | 0.007500 |   3.1814 |   5.4234 |  0.847 |  0.426 | 7/100
		[INFO]   76 | 0.007500 |   4.0778 |   5.5627 |  0.851 |  0.389 | 8/100
		[INFO]   77 | 0.007500 |   3.5397 |   5.5334 |  0.815 |  0.393 | 9/100
		[INFO]   78 | 0.007500 |   3.6284 |   4.8243 |  0.795 |  0.541 | 10/100
		[INFO]   79 | 0.007500 |   3.5418 |   5.1451 |  0.825 |  0.478 | 11/100
		[INFO]   80 | 0.007500 |   3.5876 |   5.1195 |  0.845 |  0.487 | 12/100
		[INFO]   81 | 0.007500 |   3.5225 |   5.4221 |  0.831 |  0.419 | 13/100
		[INFO]   82 | 0.007500 |   3.3670 |   5.5722 |  0.827 |  0.391 | 14/100
		[INFO]   83 | 0.007500 |   3.8201 |   5.1534 |  0.832 |  0.477 | 15/100
		[INFO]   84 | 0.007500 |   3.4868 |   5.2558 |  0.814 |  0.456 | 16/100
		[INFO]   85 | 0.007500 |   4.2209 |   4.7890 |  0.825 |  0.548 | 17/100
		[INFO]   86 | 0.007500 |   3.8279 |   5.2039 |  0.834 |  0.469 | 18/100
		[INFO]   87 | 0.007500 |   3.3565 |   5.1017 |  0.830 |  0.489 | 19/100
		[INFO]   88 | 0.007500 |   3.4656 |   5.2684 |  0.817 |  0.456 | 20/100
		[INFO]   89 | 0.005625 |   3.1672 |   5.2653 |  0.852 |  0.456 | 21/100
		[INFO]   90 | 0.005625 |   3.4777 |   5.2875 |  0.854 |  0.452 | 22/100
		[INFO]   91 | 0.005625 |   3.1904 |   4.9566 |  0.865 |  0.518 | 23/100
		[INFO]   92 | 0.005625 |   3.3128 |   5.5520 |  0.844 |  0.396 | 24/100
		[INFO]   93 | 0.005625 |   3.4782 |   4.7629 |  0.849 |  0.555 | 25/100
		[INFO]   94 | 0.005625 |   3.1089 |   4.8945 |  0.857 |  0.530 | 0/100
		[INFO]   95 | 0.005625 |   3.3235 |   4.9096 |  0.846 |  0.524 | 1/100
		[INFO]   96 | 0.005625 |   3.1988 |   5.0658 |  0.864 |  0.494 | 2/100
		[INFO]   97 | 0.005625 |   3.4933 |   5.4537 |  0.849 |  0.417 | 3/100
		[INFO]   98 | 0.005625 |   3.2117 |   4.9684 |  0.839 |  0.515 | 4/100
		[INFO]   99 | 0.005625 |   3.2637 |   4.8670 |  0.853 |  0.534 | 5/100
		[INFO]  100 | 0.005625 |   3.1440 |   4.6599 |  0.860 |  0.573 | 6/100
		[INFO]  101 | 0.005625 |   3.2008 |   4.5867 |  0.858 |  0.588 | 0/100
		[INFO]  102 | 0.005625 |   3.3518 |   4.9184 |  0.864 |  0.526 | 0/100
		[INFO]  103 | 0.005625 |   3.2448 |   4.7202 |  0.854 |  0.565 | 1/100
		[INFO]  104 | 0.005625 |   3.1778 |   4.9673 |  0.856 |  0.517 | 2/100
		[INFO]  105 | 0.005625 |   3.3854 |   4.8538 |  0.844 |  0.538 | 3/100
		[INFO]  106 | 0.005625 |   3.2031 |   5.1407 |  0.854 |  0.480 | 4/100
		[INFO]  107 | 0.005625 |   3.0776 |   5.1344 |  0.868 |  0.483 | 5/100
		[INFO]  108 | 0.005625 |   3.3662 |   5.3550 |  0.861 |  0.441 | 6/100
		[INFO]  109 | 0.005625 |   3.1798 |   5.5322 |  0.864 |  0.404 | 7/100
		[INFO]  110 | 0.005625 |   3.2217 |   4.7512 |  0.857 |  0.562 | 8/100
		[INFO]  111 | 0.005625 |   3.0323 |   5.1305 |  0.865 |  0.487 | 9/100
		[INFO]  112 | 0.005625 |   3.0350 |   4.9498 |  0.859 |  0.521 | 10/100
		[INFO]  113 | 0.005625 |   2.9035 |   5.2519 |  0.872 |  0.460 | 11/100
		[INFO]  114 | 0.005625 |   2.9787 |   4.7294 |  0.858 |  0.560 | 12/100
		[INFO]  115 | 0.005625 |   3.9244 |   4.8259 |  0.858 |  0.540 | 13/100
		[INFO]  116 | 0.005625 |   4.3140 |   5.1346 |  0.818 |  0.480 | 14/100
		[INFO]  117 | 0.005625 |   4.0871 |   5.5145 |  0.830 |  0.403 | 15/100
		[INFO]  118 | 0.005625 |   3.4676 |   4.9524 |  0.821 |  0.517 | 16/100
		[INFO]  119 | 0.005625 |   3.3870 |   5.1368 |  0.847 |  0.482 | 17/100
		[INFO]  120 | 0.005625 |   3.5180 |   5.4522 |  0.843 |  0.418 | 18/100
		[INFO]  121 | 0.005625 |   3.1699 |   4.8892 |  0.845 |  0.532 | 19/100
		[INFO]  122 | 0.005625 |   3.4008 |   4.9605 |  0.833 |  0.518 | 20/100
		[INFO]  123 | 0.004219 |   3.9666 |   5.2369 |  0.851 |  0.464 | 21/100
		[INFO]  124 | 0.004219 |   3.4666 |   5.1454 |  0.848 |  0.481 | 22/100
		[INFO]  125 | 0.004219 |   3.7169 |   5.1290 |  0.844 |  0.484 | 23/100
		[INFO]  126 | 0.004219 |   3.1828 |   4.7619 |  0.848 |  0.555 | 24/100
		[INFO]  127 | 0.004219 |   3.9007 |   5.0971 |  0.845 |  0.491 | 25/100
		[INFO]  128 | 0.004219 |   4.2527 |   5.2175 |  0.838 |  0.464 | 26/100
		[INFO]  129 | 0.004219 |   4.1322 |   5.8224 |  0.838 |  0.335 | 27/100
		[INFO]  130 | 0.004219 |   3.8431 |   4.5345 |  0.840 |  0.596 | 28/100
		[INFO]  131 | 0.004219 |   4.1179 |   5.6032 |  0.822 |  0.385 | 0/100
		[INFO]  132 | 0.004219 |   3.7550 |   4.9295 |  0.828 |  0.523 | 1/100
		[INFO]  133 | 0.004219 |   3.4782 |   5.0445 |  0.834 |  0.500 | 2/100
		[INFO]  134 | 0.004219 |   3.2231 |   4.9556 |  0.835 |  0.520 | 3/100
		[INFO]  135 | 0.004219 |   3.6104 |   4.5929 |  0.846 |  0.586 | 4/100
		[INFO]  136 | 0.004219 |   3.6744 |   5.1210 |  0.856 |  0.487 | 5/100
		[INFO]  137 | 0.004219 |   3.0915 |   4.5751 |  0.870 |  0.587 | 6/100
		[INFO]  138 | 0.004219 |   3.3169 |   4.8783 |  0.843 |  0.531 | 7/100
		[INFO]  139 | 0.004219 |   3.3628 |   4.6212 |  0.859 |  0.579 | 8/100
		[INFO]  140 | 0.004219 |   3.1073 |   5.2708 |  0.864 |  0.455 | 9/100
		[INFO]  141 | 0.004219 |   3.2538 |   5.2428 |  0.861 |  0.459 | 10/100
		[INFO]  142 | 0.004219 |   3.3095 |   4.5338 |  0.833 |  0.593 | 11/100
		[INFO]  143 | 0.004219 |   3.1543 |   4.7964 |  0.871 |  0.547 | 0/100
		[INFO]  144 | 0.004219 |   3.1196 |   4.5822 |  0.858 |  0.586 | 1/100
		[INFO]  145 | 0.004219 |   2.8954 |   5.2551 |  0.871 |  0.457 | 2/100
		[INFO]  146 | 0.004219 |   3.2197 |   4.6673 |  0.871 |  0.571 | 3/100
		[INFO]  147 | 0.004219 |   3.3641 |   4.9637 |  0.860 |  0.516 | 4/100
		[INFO]  148 | 0.004219 |   2.9374 |   4.8584 |  0.873 |  0.534 | 5/100
		[INFO]  149 | 0.004219 |   3.3051 |   4.8400 |  0.869 |  0.538 | 6/100
		[INFO]  150 | 0.004219 |   3.4518 |   4.9718 |  0.861 |  0.513 | 7/100
		[INFO]  151 | 0.004219 |   3.2052 |   4.8728 |  0.836 |  0.534 | 8/100
		[INFO]  152 | 0.003164 |   4.0137 |   5.5233 |  0.835 |  0.403 | 9/100
		[INFO]  153 | 0.003164 |   3.3719 |   5.0794 |  0.847 |  0.494 | 10/100
		[INFO]  154 | 0.003164 |   3.4716 |   5.5769 |  0.844 |  0.388 | 11/100
		[INFO]  155 | 0.003164 |   3.5627 |   5.6446 |  0.824 |  0.377 | 12/100
		[INFO]  156 | 0.003164 |   3.3687 |   5.4830 |  0.836 |  0.413 | 13/100
		[INFO]  157 | 0.003164 |   3.1417 |   5.1759 |  0.849 |  0.476 | 14/100
		[INFO]  158 | 0.003164 |   3.4737 |   5.6214 |  0.853 |  0.382 | 15/100
		[INFO]  159 | 0.003164 |   3.6133 |   4.7110 |  0.862 |  0.565 | 16/100
		[INFO]  160 | 0.003164 |   2.9793 |   5.6025 |  0.868 |  0.384 | 17/100
		[INFO]  161 | 0.003164 |   2.9032 |   4.9304 |  0.870 |  0.524 | 18/100
		[INFO]  162 | 0.003164 |   3.3238 |   5.3094 |  0.858 |  0.448 | 19/100
		[INFO]  163 | 0.003164 |   2.9526 |   4.9799 |  0.869 |  0.515 | 20/100
		[INFO]  164 | 0.003164 |   3.1479 |   4.7180 |  0.865 |  0.564 | 21/100
		[INFO]  165 | 0.003164 |   3.0244 |   4.9405 |  0.884 |  0.523 | 22/100
		[INFO]  166 | 0.003164 |   4.1484 |   5.1049 |  0.847 |  0.492 | 23/100
		[INFO]  167 | 0.003164 |   2.8852 |   5.0327 |  0.870 |  0.505 | 24/100
		[INFO]  168 | 0.003164 |   3.5912 |   5.2109 |  0.851 |  0.469 | 25/100
		[INFO]  169 | 0.003164 |   3.0001 |   5.4514 |  0.877 |  0.420 | 26/100
		[INFO]  170 | 0.003164 |   3.1043 |   5.1904 |  0.871 |  0.473 | 27/100
		[INFO]  171 | 0.003164 |   2.9140 |   5.2393 |  0.874 |  0.465 | 28/100
		[INFO]  172 | 0.003164 |   3.8414 |   4.9454 |  0.865 |  0.524 | 29/100
		[INFO]  173 | 0.002373 |   2.8723 |   5.3816 |  0.876 |  0.434 | 30/100
		[INFO]  174 | 0.002373 |   3.1681 |   5.0451 |  0.868 |  0.501 | 31/100
		[INFO]  175 | 0.002373 |   3.7082 |   5.1933 |  0.874 |  0.471 | 32/100
		[INFO]  176 | 0.002373 |   2.9301 |   4.9485 |  0.868 |  0.519 | 33/100
		[INFO]  177 | 0.002373 |   2.8991 |   4.8811 |  0.878 |  0.534 | 34/100
		[INFO]  178 | 0.002373 |   2.8788 |   4.9254 |  0.878 |  0.524 | 35/100
		[INFO]  179 | 0.002373 |   2.7905 |   4.9851 |  0.880 |  0.514 | 36/100
		[INFO]  180 | 0.002373 |   2.8755 |   4.7883 |  0.882 |  0.550 | 37/100
		[INFO]  181 | 0.002373 |   2.8002 |   5.3006 |  0.878 |  0.450 | 38/100
		[INFO]  182 | 0.002373 |   3.0779 |   4.6550 |  0.878 |  0.575 | 39/100
		[INFO]  183 | 0.002373 |   2.8675 |   4.8552 |  0.873 |  0.538 | 40/100
		[INFO]  184 | 0.002373 |   3.7698 |   5.5667 |  0.865 |  0.392 | 41/100
		[INFO]  185 | 0.002373 |   2.9843 |   4.8457 |  0.872 |  0.538 | 42/100
		[INFO]  186 | 0.002373 |   3.7532 |   4.6769 |  0.876 |  0.570 | 43/100
		[INFO]  187 | 0.002373 |   2.7546 |   5.0542 |  0.886 |  0.500 | 44/100
		[INFO]  188 | 0.002373 |   2.7445 |   4.7295 |  0.893 |  0.563 | 45/100
		[INFO]  189 | 0.002373 |   3.0813 |   4.7684 |  0.877 |  0.555 | 46/100
		[INFO]  190 | 0.002373 |   3.3083 |   4.5533 |  0.880 |  0.591 | 47/100
		[INFO]  191 | 0.002373 |   3.0341 |   5.2673 |  0.871 |  0.457 | 48/100
		[INFO]  192 | 0.002373 |   2.9776 |   5.7986 |  0.885 |  0.340 | 49/100
		[INFO]  193 | 0.002373 |   2.8221 |   5.0504 |  0.877 |  0.499 | 50/100
		[INFO]  194 | 0.001780 |   2.9953 |   5.1139 |  0.889 |  0.489 | 51/100
		[INFO]  195 | 0.001780 |   3.0576 |   5.0664 |  0.888 |  0.497 | 52/100
		[INFO]  196 | 0.001780 |   2.7396 |   5.3678 |  0.891 |  0.437 | 53/100
		[INFO]  197 | 0.001780 |   3.3099 |   5.0785 |  0.874 |  0.494 | 54/100
		[INFO]  198 | 0.001780 |   3.1473 |   4.8302 |  0.864 |  0.543 | 55/100
		[INFO]  199 | 0.001780 |   2.9454 |   5.4298 |  0.878 |  0.422 | 56/100
		[INFO]  200 | 0.001780 |   2.8339 |   4.9366 |  0.888 |  0.525 | 57/100
		[INFO]  201 | 0.001780 |   2.9053 |   4.8290 |  0.878 |  0.544 | 58/100
		[INFO]  202 | 0.001780 |   2.8917 |   4.8128 |  0.892 |  0.546 | 59/100
		[INFO]  203 | 0.001780 |   3.2116 |   4.6060 |  0.889 |  0.583 | 60/100
		[INFO]  204 | 0.001780 |   2.7730 |   5.0594 |  0.885 |  0.499 | 61/100
		[INFO]  205 | 0.001780 |   2.6038 |   4.7937 |  0.894 |  0.550 | 62/100
		[INFO]  206 | 0.001780 |   2.9084 |   4.8212 |  0.883 |  0.544 | 63/100
		[INFO]  207 | 0.001780 |   2.7931 |   5.0189 |  0.883 |  0.509 | 64/100
		[INFO]  208 | 0.001780 |   3.5191 |   5.0240 |  0.880 |  0.505 | 65/100
		[INFO]  209 | 0.001780 |   2.8969 |   5.3028 |  0.891 |  0.451 | 66/100
		[INFO]  210 | 0.001780 |   3.5194 |   4.8922 |  0.880 |  0.531 | 67/100
		[INFO]  211 | 0.001780 |   2.8037 |   4.6410 |  0.892 |  0.576 | 68/100
		[INFO]  212 | 0.001780 |   2.7765 |   5.0174 |  0.881 |  0.506 | 69/100
		[INFO]  213 | 0.001780 |   3.0365 |   4.9381 |  0.883 |  0.522 | 70/100
		[INFO]  214 | 0.001780 |   3.2193 |   5.0674 |  0.891 |  0.497 | 71/100
		[INFO]  215 | 0.001335 |   3.7766 |   4.7219 |  0.881 |  0.561 | 72/100
		[INFO]  216 | 0.001335 |   3.5890 |   4.7908 |  0.874 |  0.551 | 73/100
		[INFO]  217 | 0.001335 |   3.0273 |   5.1336 |  0.887 |  0.486 | 74/100
		[INFO]  218 | 0.001335 |   2.7705 |   4.8816 |  0.887 |  0.535 | 75/100
		[INFO]  219 | 0.001335 |   2.8421 |   4.8972 |  0.893 |  0.532 | 76/100
		[INFO]  220 | 0.001335 |   3.5252 |   4.8869 |  0.877 |  0.534 | 77/100
		[INFO]  221 | 0.001335 |   2.7855 |   4.7667 |  0.885 |  0.556 | 78/100
		[INFO]  222 | 0.001335 |   3.0688 |   4.9967 |  0.884 |  0.513 | 79/100
		[INFO]  223 | 0.001335 |   2.9652 |   5.2804 |  0.891 |  0.457 | 80/100
		[INFO]  224 | 0.001335 |   3.6324 |   4.7310 |  0.878 |  0.563 | 81/100
		[INFO]  225 | 0.001335 |   2.8448 |   5.0263 |  0.893 |  0.508 | 82/100
		[INFO]  226 | 0.001335 |   2.7835 |   5.2068 |  0.886 |  0.470 | 83/100
		[INFO]  227 | 0.001335 |   2.6799 |   5.2202 |  0.898 |  0.469 | 84/100
		[INFO]  228 | 0.001335 |   2.7879 |   4.9050 |  0.898 |  0.531 | 85/100
		[INFO]  229 | 0.001335 |   2.8381 |   5.2283 |  0.880 |  0.466 | 86/100
		[INFO]  230 | 0.001335 |   2.7229 |   4.8410 |  0.897 |  0.540 | 87/100
		[INFO]  231 | 0.001335 |   3.1465 |   5.3100 |  0.891 |  0.449 | 88/100
		[INFO]  232 | 0.001335 |   3.5647 |   4.5642 |  0.867 |  0.592 | 89/100
		[INFO]  233 | 0.001335 |   2.6082 |   4.8520 |  0.891 |  0.540 | 90/100
		[INFO]  234 | 0.001335 |   3.0812 |   5.1011 |  0.875 |  0.491 | 91/100
		[INFO]  235 | 0.001335 |   3.0597 |   4.8990 |  0.891 |  0.531 | 92/100
		[INFO]  236 | 0.001001 |   3.3129 |   5.1312 |  0.885 |  0.486 | 93/100
		[INFO]  237 | 0.001001 |   2.6101 |   4.9307 |  0.894 |  0.525 | 94/100
		[INFO]  238 | 0.001001 |   3.1216 |   4.8089 |  0.889 |  0.549 | 95/100
		[INFO]  239 | 0.001001 |   2.7981 |   4.8883 |  0.886 |  0.535 | 96/100
		[INFO]  240 | 0.001001 |   2.9334 |   5.1542 |  0.888 |  0.481 | 97/100
		[INFO]  241 | 0.001001 |   2.7974 |   4.9623 |  0.887 |  0.519 | 98/100
		[INFO]  242 | 0.001001 |   2.8671 |   4.8669 |  0.895 |  0.539 | 99/100

[Stopping] Early stopping triggered after 242 epochs.
Training Complete. Results saved to: ./data/training_results/STAFV5_CASE1
		[INFO] Case 1 completed.

	3.2 Training Case 2...

=== Starting Training Run: STAFV5_CASE2 ===
Device: cuda
		[INFO] Starting Preprocessing for Case 2...
		[INFO] Unique quantized indices: 28274
		[INFO] Suggested num_embeddings: 33928
		[INFO] Generating sliding windows...
		[INFO] Saved dataset: ./data/training_results/STAFV5_CASE2/merged_dataset_STAFV5_CASE2.csv (Shape: (18756, 225))
		[INFO] Saved metadata: ./data/training_results/STAFV5_CASE2/feature_info_STAFV5_CASE2.json
	[Model Config] Detected Dims: {'static': 4, 'series_count': 6, 'seq_len': 24, 'vehicle': 76, 'emb_vocab': 33928}
		[INFO] Data loaded. Train: 13129, Val: 5627
		[INFO] Fitting new scalers on training data...
		[INFO] Calculating weights for imbalanced regression...
		[INFO] 
==================================================
		[INFO] ðŸš€ TRAINING SESSION: STAFV5_CASE2
		[INFO] ==================================================
		[INFO] Device:             cuda
		[INFO] Model Parameters:   619,218
		[INFO] --------------------------------------------------
		[INFO] Epochs:             5000
		[INFO] Batch Size:         64
		[INFO] Learning Rate:      0.01
		[INFO] Weight Decay:       0.005
		[INFO] Dropout:            0.5
		[INFO] --------------------------------------------------
		[INFO] Hidden Layers:      [256, 64]
		[INFO] Embedding Dim:      16
		[INFO] Attention Heads:    4
		[INFO]==================================================


		[INFO]Epoch |    LR    | Trn RMSE | Val RMSE | Trn R2 | Val R2 | Stop
-----------------------------------------------------------------
		[INFO]    1 | 0.010000 |   5.3307 |   5.8486 |  0.566 |  0.347 | 0/100
		[INFO]    2 | 0.010000 |   4.5655 |   5.5901 |  0.678 |  0.403 | 0/100
		[INFO]    3 | 0.010000 |   4.5069 |   5.8420 |  0.689 |  0.348 | 0/100
		[INFO]    4 | 0.010000 |   4.3434 |   5.5670 |  0.709 |  0.408 | 1/100
		[INFO]    5 | 0.010000 |   4.2709 |   5.7955 |  0.724 |  0.358 | 0/100
		[INFO]    6 | 0.010000 |   4.2954 |   6.3142 |  0.718 |  0.238 | 1/100
		[INFO]    7 | 0.010000 |   4.2777 |   5.7968 |  0.721 |  0.358 | 2/100
		[INFO]    8 | 0.010000 |   4.1847 |   5.7409 |  0.734 |  0.370 | 3/100
		[INFO]    9 | 0.010000 |   4.1806 |   4.9168 |  0.735 |  0.538 | 4/100
		[INFO]   10 | 0.010000 |   4.1570 |   5.0435 |  0.741 |  0.514 | 0/100
		[INFO]   11 | 0.010000 |   4.2521 |   5.3105 |  0.722 |  0.461 | 1/100
		[INFO]   12 | 0.010000 |   4.1945 |   5.3793 |  0.729 |  0.447 | 2/100
		[INFO]   13 | 0.010000 |   4.0865 |   5.1076 |  0.747 |  0.502 | 3/100
		[INFO]   14 | 0.010000 |   4.0815 |   5.1410 |  0.748 |  0.495 | 4/100
		[INFO]   15 | 0.010000 |   4.1301 |   4.9675 |  0.740 |  0.529 | 5/100
		[INFO]   16 | 0.010000 |   4.1393 |   5.0832 |  0.736 |  0.506 | 6/100
		[INFO]   17 | 0.010000 |   4.1016 |   4.9951 |  0.745 |  0.523 | 7/100
		[INFO]   18 | 0.010000 |   4.1666 |   5.4818 |  0.738 |  0.426 | 8/100
		[INFO]   19 | 0.010000 |   4.1288 |   5.0371 |  0.739 |  0.515 | 9/100
		[INFO]   20 | 0.010000 |   4.0432 |   5.3697 |  0.753 |  0.449 | 10/100
		[INFO]   21 | 0.010000 |   4.0304 |   5.1197 |  0.749 |  0.499 | 11/100
		[INFO]   22 | 0.010000 |   4.1138 |   5.7551 |  0.741 |  0.367 | 12/100
		[INFO]   23 | 0.010000 |   4.0465 |   5.2471 |  0.750 |  0.474 | 13/100
		[INFO]   24 | 0.010000 |   4.0983 |   4.7772 |  0.745 |  0.564 | 14/100
		[INFO]   25 | 0.010000 |   4.1621 |   5.3459 |  0.734 |  0.454 | 0/100
		[INFO]   26 | 0.010000 |   4.0199 |   5.3409 |  0.752 |  0.455 | 1/100
		[INFO]   27 | 0.010000 |   4.0061 |   4.5185 |  0.761 |  0.610 | 2/100
		[INFO]   28 | 0.010000 |   4.1326 |   5.6899 |  0.743 |  0.382 | 0/100
		[INFO]   29 | 0.010000 |   4.1043 |   4.9273 |  0.742 |  0.536 | 1/100
		[INFO]   30 | 0.010000 |   4.0886 |   5.3853 |  0.745 |  0.446 | 2/100
		[INFO]   31 | 0.010000 |   4.0263 |   5.3887 |  0.753 |  0.445 | 3/100
		[INFO]   32 | 0.010000 |   4.1174 |   5.2131 |  0.739 |  0.481 | 4/100
		[INFO]   33 | 0.010000 |   3.9898 |   4.8507 |  0.755 |  0.551 | 5/100
		[INFO]   34 | 0.010000 |   3.9866 |   5.1611 |  0.756 |  0.491 | 6/100
		[INFO]   35 | 0.010000 |   4.0172 |   5.4229 |  0.754 |  0.438 | 7/100
		[INFO]   36 | 0.010000 |   3.9896 |   5.2811 |  0.759 |  0.467 | 8/100
		[INFO]   37 | 0.010000 |   4.0879 |   4.8802 |  0.746 |  0.545 | 9/100
		[INFO]   38 | 0.010000 |   4.0458 |   5.3757 |  0.750 |  0.448 | 10/100
		[INFO]   39 | 0.010000 |   4.2168 |   5.1903 |  0.732 |  0.485 | 11/100
		[INFO]   40 | 0.010000 |   4.0321 |   5.9004 |  0.751 |  0.335 | 12/100
		[INFO]   41 | 0.010000 |   4.0133 |   5.1067 |  0.753 |  0.502 | 13/100
		[INFO]   42 | 0.010000 |   3.9924 |   5.2691 |  0.756 |  0.470 | 14/100
		[INFO]   43 | 0.010000 |   4.0938 |   4.8925 |  0.746 |  0.543 | 15/100
		[INFO]   44 | 0.010000 |   4.0555 |   4.8189 |  0.748 |  0.556 | 16/100
		[INFO]   45 | 0.010000 |   4.0643 |   5.0999 |  0.747 |  0.503 | 17/100
		[INFO]   46 | 0.010000 |   4.1234 |   4.9776 |  0.749 |  0.527 | 18/100
		[INFO]   47 | 0.010000 |   3.9927 |   5.3058 |  0.755 |  0.462 | 19/100
		[INFO]   48 | 0.010000 |   4.0396 |   5.1422 |  0.752 |  0.495 | 20/100
		[INFO]   49 | 0.007500 |   3.9586 |   5.0127 |  0.766 |  0.520 | 21/100
		[INFO]   50 | 0.007500 |   3.9424 |   5.4367 |  0.763 |  0.435 | 22/100
		[INFO]   51 | 0.007500 |   3.9084 |   5.5611 |  0.767 |  0.409 | 23/100
