nohup: ignoring input
Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at 'data/battery_demandV2/resample_full.csv' and 'data/battery_demandV2/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1395, 37)
		[INFO] Case 1 exists â€” loaded battery demand from 'data/battery_demandV2/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists â€” loaded battery demand from 'data/battery_demandV2/case2_nan_filled/battery_demand.npy' with shape (1563, 37).
		[INFO] Case 0 exists â€” loaded battery demand from 'data/battery_demandV2/case0_test/battery_demand.npy' with shape (2, 49).

	1.6 Generating battery schedule...
		[INFO] Case 0 exists â€” loaded from 'data/battery_demandV2/case0_test/battery_availability.npy' and 'data/battery_demandV2/case0_test/battery_details.npy' shape (2, 272, 48) and (4, 2, 272)
		[INFO] Case 1 exists â€” loaded from 'data/battery_demandV2/case1_real_only/battery_availability.npy' and 'data/battery_demandV2/case1_real_only/battery_details.npy' shape (168, 237, 36) and (4, 168, 237)
		[INFO] Case 2 exists â€” loaded from 'data/battery_demandV2/case2_nan_filled/battery_availability.npy' and 'data/battery_demandV2/case2_nan_filled/battery_details.npy' shape (1563, 237, 36) and (4, 1563, 237)
		[ERROR] Could not load battery demand from 'data/battery_demandV2/case3_extended_generated/battery_demand.npy': [Errno 2] No such file or directory: 'data/battery_demandV2/case3_extended_generated/battery_demand.npy'


==================================================
PART 2: MILP Optimization...
==================================================

	2.0 Optimizing Case 0...
		[INFO] Loaded 2 samples from 'data/battery_demandV2/case0_test'
		[INFO] Results already exist at 'data/optimization_resultsV2/case0_test/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at 'data/optimization_resultsV2/case0_test/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 0 completed.

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from 'data/battery_demandV2/case1_real_only'
		[INFO] Results already exist at 'data/optimization_resultsV2/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at 'data/optimization_resultsV2/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1563 samples from 'data/battery_demandV2/case2_nan_filled'
		[INFO] Results already exist at 'data/optimization_resultsV2/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at 'data/optimization_resultsV2/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 2 completed.


==================================================
PART 3: Supervised Learning...
==================================================

	3.2 Training Case 2...

=== Starting Training Run: STAFV7_CASE2 ===
Device: cuda
		[INFO] Starting Preprocessing for Case 2...
		[INFO] Unique quantized indices: 28274
		[INFO] Suggested num_embeddings: 33928
		[INFO] Generating sliding windows...
		[INFO] Saved dataset: ./data/training_results/STAFV7_CASE2/merged_dataset_STAFV7_CASE2.csv (Shape: (18756, 225))
		[INFO] Saved metadata: ./data/training_results/STAFV7_CASE2/feature_info_STAFV7_CASE2.json
	[Model Config] Detected Dims: {'static': 4, 'series_count': 6, 'seq_len': 24, 'vehicle': 76, 'emb_vocab': 10000}
		[INFO] Data loaded. Train: 13129, Val: 5627
		[INFO] Fitting new scalers on training data...
		[INFO] Calculating weights for imbalanced regression...
		[INFO] 
==================================================
		[INFO] ðŸš€ TRAINING SESSION: STAFV7_CASE2
		[INFO] ==================================================
		[INFO] Device:             cuda
		[INFO] Model Parameters:   114,058
		[INFO] --------------------------------------------------
		[INFO] Epochs:             5000
		[INFO] Batch Size:         64
		[INFO] Learning Rate:      0.001
		[INFO] Weight Decay:       0.001
		[INFO] Dropout:            0.6
		[INFO] --------------------------------------------------
		[INFO] Hidden Layers:      [128, 32]
		[INFO] Embedding Dim:      8
		[INFO] Attention Heads:    4
		[INFO]==================================================


		[INFO]Epoch |    LR    | Trn RMSE | Val RMSE | Trn R2 | Val R2 | Stop
-----------------------------------------------------------------
		[INFO]    1 | 0.001000 |   7.4011 |   6.9821 |  0.191 |  0.069 | 0/150
		[INFO]    2 | 0.001000 |   5.6819 |   6.0528 |  0.518 |  0.300 | 0/150
		[INFO]    3 | 0.001000 |   5.3975 |   5.1897 |  0.560 |  0.486 | 0/150
		[INFO]    4 | 0.001000 |   5.2415 |   4.8743 |  0.594 |  0.546 | 0/150
		[INFO]    5 | 0.001000 |   5.1721 |   5.2750 |  0.595 |  0.469 | 0/150
		[INFO]    6 | 0.001000 |   5.1162 |   4.7210 |  0.614 |  0.574 | 1/150
		[INFO]    7 | 0.001000 |   5.0118 |   4.9829 |  0.627 |  0.526 | 0/150
		[INFO]    8 | 0.001000 |   4.9784 |   4.6731 |  0.633 |  0.583 | 1/150
		[INFO]    9 | 0.001000 |   4.9589 |   4.7442 |  0.637 |  0.570 | 0/150
		[INFO]   10 | 0.001000 |   4.9107 |   4.6035 |  0.642 |  0.595 | 1/150
		[INFO]   11 | 0.001000 |   4.9050 |   4.7662 |  0.646 |  0.566 | 0/150
		[INFO]   12 | 0.001000 |   4.7986 |   4.7746 |  0.662 |  0.565 | 1/150
		[INFO]   13 | 0.001000 |   4.7530 |   4.4370 |  0.661 |  0.624 | 2/150
		[INFO]   14 | 0.001000 |   4.8338 |   4.4371 |  0.653 |  0.624 | 0/150
		[INFO]   15 | 0.001000 |   4.7011 |   4.5021 |  0.675 |  0.613 | 1/150
		[INFO]   16 | 0.001000 |   4.7147 |   4.3520 |  0.665 |  0.638 | 2/150
		[INFO]   17 | 0.001000 |   4.6156 |   4.5147 |  0.684 |  0.611 | 0/150
		[INFO]   18 | 0.001000 |   4.6234 |   4.4983 |  0.681 |  0.613 | 1/150
		[INFO]   19 | 0.001000 |   4.6409 |   4.4963 |  0.680 |  0.614 | 2/150
		[INFO]   20 | 0.001000 |   4.6497 |   4.6403 |  0.677 |  0.589 | 3/150
		[INFO]   21 | 0.001000 |   4.5976 |   4.7065 |  0.686 |  0.577 | 4/150
		[INFO]   22 | 0.001000 |   4.5944 |   4.3852 |  0.691 |  0.633 | 5/150
		[INFO]   23 | 0.001000 |   4.5451 |   4.1903 |  0.695 |  0.665 | 6/150
		[INFO]   24 | 0.001000 |   4.5038 |   4.4478 |  0.697 |  0.622 | 0/150
		[INFO]   25 | 0.001000 |   4.4796 |   4.2814 |  0.701 |  0.650 | 1/150
		[INFO]   26 | 0.001000 |   4.5137 |   4.3301 |  0.696 |  0.642 | 2/150
		[INFO]   27 | 0.001000 |   4.4696 |   4.4644 |  0.704 |  0.619 | 3/150
		[INFO]   28 | 0.001000 |   4.4527 |   4.2402 |  0.705 |  0.657 | 4/150
		[INFO]   29 | 0.001000 |   4.4474 |   4.2662 |  0.706 |  0.652 | 5/150
		[INFO]   30 | 0.001000 |   4.4659 |   4.3979 |  0.707 |  0.631 | 6/150
		[INFO]   31 | 0.001000 |   4.5159 |   4.2939 |  0.703 |  0.648 | 7/150
		[INFO]   32 | 0.001000 |   4.4279 |   4.4686 |  0.710 |  0.619 | 8/150
		[INFO]   33 | 0.001000 |   4.3700 |   4.2540 |  0.718 |  0.654 | 9/150
		[INFO]   34 | 0.001000 |   4.3775 |   4.3105 |  0.710 |  0.645 | 10/150
		[INFO]   35 | 0.001000 |   4.3670 |   4.5161 |  0.720 |  0.610 | 11/150
		[INFO]   36 | 0.001000 |   4.3582 |   4.4088 |  0.716 |  0.629 | 12/150
		[INFO]   37 | 0.001000 |   4.3767 |   4.4955 |  0.716 |  0.614 | 13/150
		[INFO]   38 | 0.001000 |   4.3505 |   4.1410 |  0.718 |  0.672 | 14/150
		[INFO]   39 | 0.001000 |   4.2986 |   4.3493 |  0.724 |  0.639 | 0/150
		[INFO]   40 | 0.001000 |   4.3910 |   4.5373 |  0.712 |  0.607 | 1/150
		[INFO]   41 | 0.001000 |   4.3518 |   4.4839 |  0.723 |  0.616 | 2/150
		[INFO]   42 | 0.001000 |   4.3786 |   4.2802 |  0.714 |  0.650 | 3/150
		[INFO]   43 | 0.001000 |   4.3502 |   4.2289 |  0.720 |  0.658 | 4/150
		[INFO]   44 | 0.001000 |   4.3968 |   4.3928 |  0.716 |  0.631 | 5/150
		[INFO]   45 | 0.001000 |   4.3199 |   4.1335 |  0.719 |  0.674 | 6/150
		[INFO]   46 | 0.001000 |   4.2750 |   4.1951 |  0.728 |  0.664 | 0/150
		[INFO]   47 | 0.001000 |   4.3012 |   4.2571 |  0.726 |  0.654 | 1/150
		[INFO]   48 | 0.001000 |   4.2873 |   4.1357 |  0.727 |  0.673 | 2/150
		[INFO]   49 | 0.001000 |   4.3141 |   4.1521 |  0.723 |  0.671 | 3/150
		[INFO]   50 | 0.001000 |   4.2814 |   4.3146 |  0.730 |  0.644 | 4/150
		[INFO]   51 | 0.001000 |   4.2921 |   4.1505 |  0.728 |  0.671 | 5/150
		[INFO]   52 | 0.001000 |   4.2910 |   4.1621 |  0.728 |  0.669 | 6/150
		[INFO]   53 | 0.001000 |   4.3007 |   4.3513 |  0.719 |  0.638 | 7/150
		[INFO]   54 | 0.001000 |   4.3331 |   4.2411 |  0.725 |  0.656 | 8/150
		[INFO]   55 | 0.001000 |   4.2965 |   4.2714 |  0.728 |  0.651 | 9/150
		[INFO]   56 | 0.001000 |   4.2438 |   4.1303 |  0.735 |  0.674 | 10/150
		[INFO]   57 | 0.001000 |   4.2685 |   4.4155 |  0.732 |  0.628 | 0/150
		[INFO]   58 | 0.001000 |   4.2312 |   4.3930 |  0.735 |  0.631 | 1/150
		[INFO]   59 | 0.001000 |   4.1729 |   4.4318 |  0.739 |  0.625 | 2/150
		[INFO]   60 | 0.001000 |   4.1986 |   4.1871 |  0.737 |  0.665 | 3/150
		[INFO]   61 | 0.001000 |   4.2296 |   4.3470 |  0.736 |  0.639 | 4/150
		[INFO]   62 | 0.001000 |   4.2526 |   4.0948 |  0.737 |  0.680 | 5/150
		[INFO]   63 | 0.001000 |   4.2242 |   4.0772 |  0.733 |  0.682 | 0/150
