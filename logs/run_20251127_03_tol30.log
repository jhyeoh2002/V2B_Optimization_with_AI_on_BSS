Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at './data/battery_demand/tol30/resample_full.csv' and './data/battery_demand/tol30/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1391, 37)
		[INFO] Number of seeds ready for Case 3  = (2000, 36)

		[INFO] Case 1 exists — loaded battery demand from './data/battery_demand/tol30/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists — loaded battery demand from './data/battery_demand/tol30/case2_nan_filled/battery_demand.npy' with shape (1559, 37).
		[INFO] Case 3 exists — loaded battery demand from './data/battery_demand/tol30/case3_extended_generated/battery_demand.npy' with shape (3559, 37).

	1.6 Generating battery schedule...
		[INFO] Case 1 exists — loaded from './data/battery_demand/tol30/case1_real_only/battery_availability.npy' and './data/battery_demand/tol30/case1_real_only/battery_details.npy' shape (168, 263, 36) and (4, 168, 263)
		[INFO] Case 2 exists — loaded from './data/battery_demand/tol30/case2_nan_filled/battery_availability.npy' and './data/battery_demand/tol30/case2_nan_filled/battery_details.npy' shape (1559, 429, 36) and (4, 1559, 429)
		[INFO] Case 3 exists — loaded from './data/battery_demand/tol30/case3_extended_generated/battery_availability.npy' and './data/battery_demand/tol30/case3_extended_generated/battery_details.npy' shape (3559, 429, 36) and (4, 3559, 429)


==================================================
PART 2: MILP Optimization...
==================================================

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from './data/battery_demand/tol30/case1_real_only'
		[INFO] Results already exist at './data/optimization_results/tol30/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol30/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1559 samples from './data/battery_demand/tol30/case2_nan_filled'
		[INFO] Results already exist at './data/optimization_results/tol30/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol30/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 2 completed.

	2.3 Optimizing Case 3...
		[INFO] Loaded 3559 samples from './data/battery_demand/tol30/case3_extended_generated'
		[INFO] Found checkpoint: './data/optimization_results/tol30/case3_extended_generated/optimization_checkpoint.npz'
		[INFO] Resuming from iteration 2750
		[INFO] Processing optimization series:   0%|                          | 0/809 [00:00<?, ?series/s]		[INFO] Processing optimization series:   0%|                  | 1/809 [00:01<24:29,  1.82s/series]		[INFO] Processing optimization series:   0%|                  | 2/809 [00:02<13:57,  1.04s/series]		[INFO] Processing optimization series:   0%|                  | 3/809 [00:03<15:19,  1.14s/series]		[INFO] Processing optimization series:   0%|                  | 4/809 [00:04<12:45,  1.05series/s]		[INFO] Processing optimization series:   1%|                  | 5/809 [00:05<13:38,  1.02s/series]		[INFO] Processing optimization series:   1%|▏                 | 6/809 [00:06<14:16,  1.07s/series]		[INFO] Processing optimization series:   1%|▏                 | 7/809 [00:09<21:20,  1.60s/series]		[INFO] Processing optimization series:   1%|▏                 | 8/809 [00:10<20:13,  1.51s/series]		[INFO] Processing optimization series:   1%|▏                 | 9/809 [00:11<19:38,  1.47s/series]		[INFO] Processing optimization series:   1%|▏              | 10/809 [00:25<1:08:57,  5.18s/series]		[INFO] Processing optimization series:   1%|▏              | 11/809 [00:28<1:01:24,  4.62s/series]		[INFO] Processing optimization series:   1%|▎                | 12/809 [00:30<47:44,  3.59s/series]		[INFO] Processing optimization series:   2%|▎                | 13/809 [00:31<38:40,  2.92s/series]		[INFO] Processing optimization series:   2%|▎                | 14/809 [00:34<39:27,  2.98s/series]		[INFO] Processing optimization series:   2%|▎                | 15/809 [00:34<29:25,  2.22s/series]		[INFO] Processing optimization series:   2%|▎                | 16/809 [00:35<22:20,  1.69s/series]		[INFO] Processing optimization series:   2%|▎                | 17/809 [00:35<17:33,  1.33s/series]		[INFO] Processing optimization series:   2%|▍                | 18/809 [00:37<17:11,  1.30s/series]		[INFO] Processing optimization series:   2%|▍                | 19/809 [00:37<13:57,  1.06s/series]		[INFO] Processing optimization series:   2%|▍                | 20/809 [00:46<46:02,  3.50s/series]		[INFO] Processing optimization series:   3%|▍                | 21/809 [00:47<33:58,  2.59s/series]		[INFO] Processing optimization series:   3%|▍                | 22/809 [00:48<30:06,  2.30s/series]		[INFO] Processing optimization series:   3%|▍                | 23/809 [00:49<22:41,  1.73s/series]		[INFO] Processing optimization series:   3%|▌                | 24/809 [00:49<17:53,  1.37s/series]		[INFO] Processing optimization series:   3%|▌                | 25/809 [00:51<17:44,  1.36s/series]		[INFO] Processing optimization series:   3%|▌                | 26/809 [00:51<14:06,  1.08s/series]		[INFO] Processing optimization series:   3%|▌                | 27/809 [00:52<11:30,  1.13series/s]		[INFO] Processing optimization series:   3%|▌                | 28/809 [00:52<10:05,  1.29series/s]		[INFO] Processing optimization series:   4%|▌                | 29/809 [00:54<12:49,  1.01series/s]		[INFO] Processing optimization series:   4%|▋                | 30/809 [01:03<47:10,  3.63s/series]		[INFO] Processing optimization series:   4%|▋                | 31/809 [01:04<35:04,  2.70s/series]		[INFO] Processing optimization series:   4%|▋                | 32/809 [01:04<26:11,  2.02s/series]		[INFO] Processing optimization series:   4%|▋                | 33/809 [01:06<23:39,  1.83s/series]		[INFO] Processing optimization series:   4%|▋                | 34/809 [01:06<18:46,  1.45s/series]		[INFO] Processing optimization series:   4%|▋                | 35/809 [01:07<15:02,  1.17s/series]		[INFO] Processing optimization series:   4%|▊                | 36/809 [01:07<12:38,  1.02series/s]		[INFO] Processing optimization series:   5%|▊                | 37/809 [01:09<14:15,  1.11s/series]		[INFO] Processing optimization series:   5%|▊                | 38/809 [01:09<11:52,  1.08series/s]		[INFO] Processing optimization series:   5%|▊                | 39/809 [01:10<10:03,  1.28series/s]		[INFO] Processing optimization series:   5%|▊                | 40/809 [01:18<39:00,  3.04s/series]		[INFO] Processing optimization series:   5%|▊                | 41/809 [01:18<29:00,  2.27s/series]		[INFO] Processing optimization series:   5%|▉                | 42/809 [01:19<21:59,  1.72s/series]		[INFO] Processing optimization series:   5%|▉                | 43/809 [01:20<19:30,  1.53s/series]		[INFO] Processing optimization series:   5%|▉                | 44/809 [01:23<24:05,  1.89s/series]		[INFO] Processing optimization series:   6%|▉                | 45/809 [01:24<22:19,  1.75s/series]		[INFO] Processing optimization series:   6%|▉                | 46/809 [01:25<20:13,  1.59s/series]		[INFO] Processing optimization series:   6%|▉                | 47/809 [01:27<19:14,  1.52s/series]		[INFO] Processing optimization series:   6%|█                | 48/809 [01:30<25:12,  1.99s/series]		[INFO] Processing optimization series:   6%|█                | 49/809 [01:31<22:34,  1.78s/series]		[INFO] Processing optimization series:   6%|█                | 50/809 [01:39<45:37,  3.61s/series]		[INFO] Processing optimization series:   6%|█                | 51/809 [01:40<37:12,  2.95s/series]		[INFO] Processing optimization series:   6%|█                | 52/809 [01:41<28:09,  2.23s/series]		[INFO] Processing optimization series:   7%|█                | 53/809 [01:41<21:40,  1.72s/series]		[INFO] Processing optimization series:   7%|█▏               | 54/809 [01:42<17:23,  1.38s/series]		[INFO] Processing optimization series:   7%|█▏               | 55/809 [01:44<19:14,  1.53s/series]		[INFO] Processing optimization series:   7%|█▏               | 56/809 [01:45<17:50,  1.42s/series]		[INFO] Processing optimization series:   7%|█▏               | 57/809 [01:46<16:47,  1.34s/series]		[INFO] Processing optimization series:   7%|█▏               | 58/809 [01:49<20:58,  1.68s/series]		[INFO] Processing optimization series:   7%|█▏               | 59/809 [01:50<19:39,  1.57s/series]		[INFO] Processing optimization series:   7%|█▎               | 60/809 [02:01<56:00,  4.49s/series]		[INFO] Processing optimization series:   8%|█▎               | 61/809 [02:03<43:48,  3.51s/series]		[INFO] Processing optimization series:   8%|█▎               | 62/809 [02:05<38:24,  3.08s/series]		[INFO] Processing optimization series:   8%|█▎               | 63/809 [02:05<28:34,  2.30s/series]		[INFO] Processing optimization series:   8%|█▎               | 64/809 [02:06<21:50,  1.76s/series]		[INFO] Processing optimization series:   8%|█▎               | 65/809 [02:07<19:55,  1.61s/series]		[INFO] Processing optimization series:   8%|█▍               | 66/809 [02:07<16:06,  1.30s/series]		[INFO] Processing optimization series:   8%|█▍               | 67/809 [02:08<13:12,  1.07s/series]		[INFO] Processing optimization series:   8%|█▍               | 68/809 [02:08<11:06,  1.11series/s]		[INFO] Processing optimization series:   9%|█▍               | 69/809 [02:10<13:08,  1.07s/series]		[INFO] Processing optimization series:   9%|█▍               | 70/809 [02:19<41:10,  3.34s/series]		[INFO] Processing optimization series:   9%|█▍               | 71/809 [02:19<30:33,  2.48s/series]		[INFO] Processing optimization series:   9%|█▌               | 72/809 [02:21<27:28,  2.24s/series]		[INFO] Processing optimization series:   9%|█▌               | 73/809 [02:21<21:05,  1.72s/series]		[INFO] Processing optimization series:   9%|█▌               | 74/809 [02:22<19:02,  1.55s/series]		[INFO] Processing optimization series:   9%|█▌               | 75/809 [02:23<17:02,  1.39s/series]		[INFO] Processing optimization series:   9%|█▌               | 76/809 [02:25<16:50,  1.38s/series]		[INFO] Processing optimization series:  10%|█▌               | 77/809 [02:25<13:44,  1.13s/series]		[INFO] Processing optimization series:  10%|█▋               | 78/809 [02:26<11:21,  1.07series/s]		[INFO] Processing optimization series:  10%|█▋               | 79/809 [02:26<09:34,  1.27series/s]		[INFO] Processing optimization series:  10%|█▋               | 80/809 [02:34<36:30,  3.00s/series]		[INFO] Processing optimization series:  10%|█▋               | 81/809 [02:35<27:11,  2.24s/series]		[INFO] Processing optimization series:  10%|█▋               | 82/809 [02:35<21:09,  1.75s/series]		[INFO] Processing optimization series:  10%|█▋               | 83/809 [02:37<19:29,  1.61s/series]		[INFO] Processing optimization series:  10%|█▊               | 84/809 [02:37<15:20,  1.27s/series]		[INFO] Processing optimization series:  11%|█▊               | 85/809 [02:38<12:41,  1.05s/series]		[INFO] Processing optimization series:  11%|█▊               | 86/809 [02:38<10:45,  1.12series/s]		[INFO] Processing optimization series:  11%|█▊               | 87/809 [02:39<11:47,  1.02series/s]		[INFO] Processing optimization series:  11%|█▊               | 88/809 [02:40<09:52,  1.22series/s]Fatal Python error: Segmentation fault

Thread 0x000079fbea3ff640 (most recent call first):
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/threading.py", line 363 in wait
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/threading.py", line 659 in wait
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/tqdm/_monitor.py", line 60 in run
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/threading.py", line 1043 in _bootstrap_inner
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/threading.py", line 1014 in _bootstrap

Current thread 0x000079fca25bf440 (most recent call first):
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/MILP/GurobiOptimizer.py", line 144 in <genexpr>
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/MILP/GurobiOptimizer.py", line 144 in optimize
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/MILP/EnergyAllocator.py", line 143 in run_iterations
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/main.py", line 28 in main
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/main.py", line 53 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._mt19937, numpy.random.mtrand, numpy.random._philox, numpy.random._pcg64, numpy.random._sfc64, numpy.random._generator, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, _cffi_backend, scipy._lib._ccallback_c, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_sqrtm_triu, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpack, scipy.sparse.linalg._propack._spropack, scipy.sparse.linalg._propack._dpropack, scipy.sparse.linalg._propack._cpropack, scipy.sparse.linalg._propack._zpropack, scipy.sparse.csgraph._tools, scipy.sparse.csgraph._shortest_path, scipy.sparse.csgraph._traversal, scipy.sparse.csgraph._min_spanning_tree, scipy.sparse.csgraph._flow, scipy.sparse.csgraph._matching, scipy.sparse.csgraph._reordering, scipy.spatial._ckdtree, scipy._lib.messagestream, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._distance_wrap, scipy.spatial._hausdorff, scipy.special._ufuncs_cxx, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.special._ellip_harm_2, scipy.spatial.transform._rotation, scipy.optimize._group_columns, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._cobyla, scipy.optimize._slsqp, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy.optimize._cython_nnls, scipy._lib._uarray._uarray, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.optimize._direct, scipy.integrate._odepack, scipy.integrate._quadpack, scipy.integrate._vode, scipy.integrate._dop, scipy.integrate._lsoda, scipy.interpolate._fitpack, scipy.interpolate._dfitpack, scipy.interpolate._dierckx, scipy.interpolate._ppoly, scipy.interpolate._interpnd, scipy.interpolate._rbfinterp_pythran, scipy.interpolate._rgi_cython, scipy.interpolate._bspl, scipy.special.cython_special, scipy.stats._stats, scipy.stats._sobol, scipy.stats._qmc_cy, scipy.stats._biasedurn, scipy.stats._stats_pythran, scipy.stats._levy_stable.levyst, scipy.stats._ansari_swilk_statistics, scipy.stats._mvn, scipy.stats._rcont.rcont, scipy.ndimage._nd_image, scipy.ndimage._rank_filter_1d, _ni_label, scipy.ndimage._ni_label, PIL._imaging, kiwisolver._cext, sklearn.__check_build._check_build, psutil._psutil_linux, psutil._psutil_posix, sklearn.utils._isfinite, sklearn.utils.sparsefuncs_fast, sklearn.utils.murmurhash, sklearn.utils._openmp_helpers, sklearn.metrics.cluster._expected_mutual_info_fast, sklearn.preprocessing._csr_polynomial_expansion, sklearn.preprocessing._target_encoder_fast, sklearn.metrics._dist_metrics, sklearn.metrics._pairwise_distances_reduction._datasets_pair, sklearn.utils._cython_blas, sklearn.metrics._pairwise_distances_reduction._base, sklearn.metrics._pairwise_distances_reduction._middle_term_computer, sklearn.utils._heap, sklearn.utils._sorting, sklearn.metrics._pairwise_distances_reduction._argkmin, sklearn.metrics._pairwise_distances_reduction._argkmin_classmode, sklearn.utils._vector_sentinel, sklearn.metrics._pairwise_distances_reduction._radius_neighbors, sklearn.metrics._pairwise_distances_reduction._radius_neighbors_classmode, sklearn.metrics._pairwise_fast, sklearn.neighbors._partition_nodes, sklearn.neighbors._ball_tree, sklearn.neighbors._kd_tree, sklearn.utils.arrayfuncs, sklearn.utils._random, sklearn.utils._seq_dataset, sklearn.linear_model._cd_fast, _loss, sklearn._loss._loss, sklearn.svm._liblinear, sklearn.svm._libsvm, sklearn.svm._libsvm_sparse, sklearn.linear_model._sag_fast, sklearn.utils._weight_vector, sklearn.linear_model._sgd_fast, sklearn.decomposition._online_lda_fast, sklearn.decomposition._cdnmf_fast, dtaidistance.dtw_cc, dtaidistance.dtw_cc_omp, dtaidistance.dtw_cc_numpy, dtaidistance.ed_cc, gurobipy._util, gurobipy._exception, gurobipy._attrutil, gurobipy._core, gurobipy._batch, gurobipy._matrixapi, gurobipy._helpers, gurobipy._modelutil, gurobipy._model (total: 190)
