Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at './data/battery_demand/tol29/resample_full.csv' and './data/battery_demand/tol29/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1388, 37)
		[INFO] Number of seeds ready for Case 3  = (2000, 36)

		[INFO] Case 1 exists — loaded battery demand from './data/battery_demand/tol29/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists — loaded battery demand from './data/battery_demand/tol29/case2_nan_filled/battery_demand.npy' with shape (1556, 37).
		[INFO] Case 3 exists — loaded battery demand from './data/battery_demand/tol29/case3_extended_generated/battery_demand.npy' with shape (3556, 37).

	1.6 Generating battery schedule...
		[INFO] Case 1 exists — loaded from './data/battery_demand/tol29/case1_real_only/battery_availability.npy' and './data/battery_demand/tol29/case1_real_only/battery_details.npy' shape (168, 263, 36) and (4, 168, 263)
		[INFO] Case 2 exists — loaded from './data/battery_demand/tol29/case2_nan_filled/battery_availability.npy' and './data/battery_demand/tol29/case2_nan_filled/battery_details.npy' shape (1556, 429, 36) and (4, 1556, 429)
		[INFO] Case 3 exists — loaded from './data/battery_demand/tol29/case3_extended_generated/battery_availability.npy' and './data/battery_demand/tol29/case3_extended_generated/battery_details.npy' shape (3556, 429, 36) and (4, 3556, 429)


==================================================
PART 2: MILP Optimization...
==================================================

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from './data/battery_demand/tol29/case1_real_only'
		[INFO] Results already exist at './data/optimization_results/tol29/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol29/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1556 samples from './data/battery_demand/tol29/case2_nan_filled'
		[INFO] Results already exist at './data/optimization_results/tol29/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol29/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 2 completed.

	2.3 Optimizing Case 3...
		[INFO] Loaded 3556 samples from './data/battery_demand/tol29/case3_extended_generated'
		[INFO] Found checkpoint: './data/optimization_results/tol29/case3_extended_generated/optimization_checkpoint.npz'
		[INFO] Resuming from iteration 2030
		[INFO] Processing optimization series:   0%|                         | 0/1526 [00:00<?, ?series/s]		[INFO] Processing optimization series:   0%|               | 1/1526 [00:02<1:10:23,  2.77s/series]		[INFO] Processing optimization series:   0%|                 | 2/1526 [00:04<49:45,  1.96s/series]		[INFO] Processing optimization series:   0%|                 | 3/1526 [00:06<53:41,  2.12s/series]		[INFO] Processing optimization series:   0%|                 | 4/1526 [00:07<44:51,  1.77s/series]		[INFO] Processing optimization series:   0%|                 | 5/1526 [00:08<39:47,  1.57s/series]		[INFO] Processing optimization series:   0%|                 | 6/1526 [00:10<38:23,  1.52s/series]		[INFO] Processing optimization series:   0%|                 | 7/1526 [00:12<44:28,  1.76s/series]		[INFO] Processing optimization series:   1%|                 | 8/1526 [00:13<39:43,  1.57s/series]		[INFO] Processing optimization series:   1%|                 | 9/1526 [00:14<37:05,  1.47s/series]		[INFO] Processing optimization series:   1%|              | 10/1526 [00:25<1:46:26,  4.21s/series]		[INFO] Processing optimization series:   1%|              | 11/1526 [00:28<1:35:56,  3.80s/series]		[INFO] Processing optimization series:   1%|              | 12/1526 [00:29<1:16:09,  3.02s/series]		[INFO] Processing optimization series:   1%|              | 13/1526 [00:30<1:02:28,  2.48s/series]		[INFO] Processing optimization series:   1%|▏             | 14/1526 [00:33<1:03:41,  2.53s/series]		[INFO] Processing optimization series:   1%|▏               | 15/1526 [00:34<54:12,  2.15s/series]		[INFO] Processing optimization series:   1%|▏               | 16/1526 [00:35<48:14,  1.92s/series]		[INFO] Processing optimization series:   1%|▏               | 17/1526 [00:37<43:39,  1.74s/series]		[INFO] Processing optimization series:   1%|▏               | 18/1526 [00:39<50:08,  2.00s/series]		[INFO] Processing optimization series:   1%|▏               | 19/1526 [00:41<45:05,  1.80s/series]		[INFO] Processing optimization series:   1%|▏             | 20/1526 [00:51<1:49:50,  4.38s/series]		[INFO] Processing optimization series:   1%|▏             | 21/1526 [00:54<1:37:23,  3.88s/series]		[INFO] Processing optimization series:   1%|▏             | 22/1526 [00:55<1:16:03,  3.03s/series]		[INFO] Processing optimization series:   2%|▏             | 23/1526 [00:56<1:03:59,  2.55s/series]		[INFO] Processing optimization series:   2%|▎               | 24/1526 [00:58<55:20,  2.21s/series]		[INFO] Processing optimization series:   2%|▎               | 25/1526 [01:01<59:24,  2.37s/series]		[INFO] Processing optimization series:   2%|▎               | 26/1526 [01:02<49:14,  1.97s/series]		[INFO] Processing optimization series:   2%|▎               | 27/1526 [01:03<42:47,  1.71s/series]		[INFO] Processing optimization series:   2%|▎               | 28/1526 [01:04<39:08,  1.57s/series]		[INFO] Processing optimization series:   2%|▎               | 29/1526 [01:07<47:46,  1.91s/series]		[INFO] Processing optimization series:   2%|▎             | 30/1526 [01:16<1:44:25,  4.19s/series]		[INFO] Processing optimization series:   2%|▎             | 31/1526 [01:17<1:20:42,  3.24s/series]		[INFO] Processing optimization series:   2%|▎             | 32/1526 [01:18<1:04:12,  2.58s/series]		[INFO] Processing optimization series:   2%|▎               | 33/1526 [01:19<48:05,  1.93s/series]		[INFO] Processing optimization series:   2%|▎               | 34/1526 [01:19<37:27,  1.51s/series]		[INFO] Processing optimization series:   2%|▎               | 35/1526 [01:20<31:10,  1.25s/series]		[INFO] Processing optimization series:   2%|▍               | 36/1526 [01:22<38:20,  1.54s/series]		[INFO] Processing optimization series:   2%|▍               | 37/1526 [01:23<30:56,  1.25s/series]		[INFO] Processing optimization series:   2%|▍               | 38/1526 [01:23<24:59,  1.01s/series]		[INFO] Processing optimization series:   3%|▍               | 39/1526 [01:23<20:45,  1.19series/s]		[INFO] Processing optimization series:   3%|▎             | 40/1526 [01:30<1:04:13,  2.59s/series]		[INFO] Processing optimization series:   3%|▍               | 41/1526 [01:31<51:15,  2.07s/series]		[INFO] Processing optimization series:   3%|▍               | 42/1526 [01:31<39:15,  1.59s/series]		[INFO] Processing optimization series:   3%|▍               | 43/1526 [01:32<35:07,  1.42s/series]		[INFO] Processing optimization series:   3%|▍               | 44/1526 [01:33<27:34,  1.12s/series]		[INFO] Processing optimization series:   3%|▍               | 45/1526 [01:33<22:17,  1.11series/s]		[INFO] Processing optimization series:   3%|▍               | 46/1526 [01:34<19:19,  1.28series/s]		[INFO] Processing optimization series:   3%|▍               | 47/1526 [01:35<21:51,  1.13series/s]		[INFO] Processing optimization series:   3%|▌               | 48/1526 [01:35<18:42,  1.32series/s]		[INFO] Processing optimization series:   3%|▌               | 49/1526 [01:36<16:47,  1.47series/s]		[INFO] Processing optimization series:   3%|▍             | 50/1526 [01:43<1:02:12,  2.53s/series]		[INFO] Processing optimization series:   3%|▌               | 51/1526 [01:44<54:38,  2.22s/series]		[INFO] Processing optimization series:   3%|▌               | 52/1526 [01:45<41:43,  1.70s/series]		[INFO] Processing optimization series:   3%|▌               | 53/1526 [01:45<32:40,  1.33s/series]		[INFO] Processing optimization series:   4%|▌               | 54/1526 [01:46<26:53,  1.10s/series]		[INFO] Processing optimization series:   4%|▌               | 55/1526 [01:47<27:13,  1.11s/series]		[INFO] Processing optimization series:   4%|▌               | 56/1526 [01:47<22:41,  1.08series/s]		[INFO] Processing optimization series:   4%|▌               | 57/1526 [01:48<19:23,  1.26series/s]		[INFO] Processing optimization series:   4%|▌               | 58/1526 [01:49<23:15,  1.05series/s]		[INFO] Processing optimization series:   4%|▌               | 59/1526 [01:50<19:49,  1.23series/s]		[INFO] Processing optimization series:   4%|▋               | 60/1526 [01:55<53:05,  2.17s/series]		[INFO] Processing optimization series:   4%|▋               | 61/1526 [01:55<40:22,  1.65s/series]		[INFO] Processing optimization series:   4%|▋               | 62/1526 [01:58<43:33,  1.79s/series]		[INFO] Processing optimization series:   4%|▋               | 63/1526 [01:58<34:24,  1.41s/series]		[INFO] Processing optimization series:   4%|▋               | 64/1526 [01:58<27:18,  1.12s/series]		[INFO] Processing optimization series:   4%|▋               | 65/1526 [02:00<28:08,  1.16s/series]		[INFO] Processing optimization series:   4%|▋               | 66/1526 [02:00<24:25,  1.00s/series]		[INFO] Processing optimization series:   4%|▋               | 67/1526 [02:01<21:30,  1.13series/s]		[INFO] Processing optimization series:   4%|▋               | 68/1526 [02:02<19:57,  1.22series/s]		[INFO] Processing optimization series:   5%|▋               | 69/1526 [02:03<23:21,  1.04series/s]		[INFO] Processing optimization series:   5%|▋               | 70/1526 [02:08<55:56,  2.31s/series]		[INFO] Processing optimization series:   5%|▋               | 71/1526 [02:09<42:19,  1.75s/series]		[INFO] Processing optimization series:   5%|▊               | 72/1526 [02:09<32:51,  1.36s/series]		[INFO] Processing optimization series:   5%|▊               | 73/1526 [02:11<35:12,  1.45s/series]		[INFO] Processing optimization series:   5%|▊               | 74/1526 [02:11<27:53,  1.15s/series]		[INFO] Processing optimization series:   5%|▊               | 75/1526 [02:12<22:35,  1.07series/s]		[INFO] Processing optimization series:   5%|▊               | 76/1526 [02:13<26:26,  1.09s/series]		[INFO] Processing optimization series:   5%|▊               | 77/1526 [02:14<21:58,  1.10series/s]		[INFO] Processing optimization series:   5%|▊               | 78/1526 [02:14<19:12,  1.26series/s]		[INFO] Processing optimization series:   5%|▊               | 79/1526 [02:15<16:32,  1.46series/s]		[INFO] Processing optimization series:   5%|▊               | 80/1526 [02:21<57:20,  2.38s/series]		[INFO] Processing optimization series:   5%|▊               | 81/1526 [02:22<47:07,  1.96s/series]		[INFO] Processing optimization series:   5%|▊               | 82/1526 [02:23<36:32,  1.52s/series]		[INFO] Processing optimization series:   5%|▊               | 83/1526 [02:23<28:36,  1.19s/series]		[INFO] Processing optimization series:   6%|▉               | 84/1526 [02:24<27:32,  1.15s/series]		[INFO] Processing optimization series:   6%|▉               | 85/1526 [02:25<23:02,  1.04series/s]		[INFO] Processing optimization series:   6%|▉               | 86/1526 [02:25<20:50,  1.15series/s]		[INFO] Processing optimization series:   6%|▉               | 87/1526 [02:26<21:55,  1.09series/s]		[INFO] Processing optimization series:   6%|▉               | 88/1526 [02:27<18:43,  1.28series/s]		[INFO] Processing optimization series:   6%|▉               | 89/1526 [02:27<18:07,  1.32series/s]		[INFO] Processing optimization series:   6%|▊             | 90/1526 [02:35<1:06:46,  2.79s/series]		[INFO] Processing optimization series:   6%|▉               | 91/1526 [02:36<57:15,  2.39s/series]		[INFO] Processing optimization series:   6%|▉               | 92/1526 [02:37<43:46,  1.83s/series]		[INFO] Processing optimization series:   6%|▉               | 93/1526 [02:37<33:22,  1.40s/series]		[INFO] Processing optimization series:   6%|▉               | 94/1526 [02:38<26:17,  1.10s/series]		[INFO] Processing optimization series:   6%|▉               | 95/1526 [02:39<25:55,  1.09s/series]		[INFO] Processing optimization series:   6%|█               | 96/1526 [02:39<21:05,  1.13series/s]		[INFO] Processing optimization series:   6%|█               | 97/1526 [02:40<18:17,  1.30series/s]		[INFO] Processing optimization series:   6%|█               | 98/1526 [02:41<20:25,  1.16series/s]		[INFO] Processing optimization series:   6%|█               | 99/1526 [02:41<17:18,  1.37series/s]		[INFO] Processing optimization series:   7%|▊            | 100/1526 [02:48<1:03:19,  2.66s/series]		[INFO] Processing optimization series:   7%|▉              | 101/1526 [02:49<51:37,  2.17s/series]		[INFO] Processing optimization series:   7%|█              | 102/1526 [02:51<47:30,  2.00s/series]		[INFO] Processing optimization series:   7%|█              | 103/1526 [02:51<36:58,  1.56s/series]		[INFO] Processing optimization series:   7%|█              | 104/1526 [02:52<29:54,  1.26s/series]		[INFO] Processing optimization series:   7%|█              | 105/1526 [02:53<24:11,  1.02s/series]		[INFO] Processing optimization series:   7%|█              | 106/1526 [02:54<24:20,  1.03s/series]		[INFO] Processing optimization series:   7%|█              | 107/1526 [02:54<22:09,  1.07series/s]		[INFO] Processing optimization series:   7%|█              | 108/1526 [02:55<21:27,  1.10series/s]		[INFO] Processing optimization series:   7%|█              | 109/1526 [02:56<18:51,  1.25series/s]		[INFO] Processing optimization series:   7%|█              | 110/1526 [03:02<57:45,  2.45s/series]		[INFO] Processing optimization series:   7%|█              | 111/1526 [03:03<49:04,  2.08s/series]		[INFO] Processing optimization series:   7%|█              | 112/1526 [03:05<43:53,  1.86s/series]		[INFO] Processing optimization series:   7%|█              | 113/1526 [03:06<39:27,  1.68s/series]		[INFO] Processing optimization series:   7%|█              | 114/1526 [03:06<31:12,  1.33s/series]		[INFO] Processing optimization series:   8%|█▏             | 115/1526 [03:07<25:14,  1.07s/series]		[INFO] Processing optimization series:   8%|█▏             | 116/1526 [03:07<22:21,  1.05series/s]		[INFO] Processing optimization series:   8%|█▏             | 117/1526 [03:10<33:05,  1.41s/series]		[INFO] Processing optimization series:   8%|█▏             | 118/1526 [03:11<31:49,  1.36s/series]		[INFO] Processing optimization series:   8%|█▏             | 119/1526 [03:12<31:35,  1.35s/series]		[INFO] Processing optimization series:   8%|█            | 120/1526 [03:22<1:29:53,  3.84s/series]		[INFO] Processing optimization series:   8%|█            | 121/1526 [03:23<1:06:08,  2.82s/series]		[INFO] Processing optimization series:   8%|█▏             | 122/1526 [03:23<49:18,  2.11s/series]		[INFO] Processing optimization series:   8%|█▏             | 123/1526 [03:23<37:22,  1.60s/series]		[INFO] Processing optimization series:   8%|█▏             | 124/1526 [03:25<34:00,  1.46s/series]		[INFO] Processing optimization series:   8%|█▏             | 125/1526 [03:25<26:45,  1.15s/series]		[INFO] Processing optimization series:   8%|█▏             | 126/1526 [03:25<21:53,  1.07series/s]		[INFO] Processing optimization series:   8%|█▏             | 127/1526 [03:26<18:57,  1.23series/s]		[INFO] Processing optimization series:   8%|█▎             | 128/1526 [03:27<21:26,  1.09series/s]		[INFO] Processing optimization series:   8%|█▎             | 129/1526 [03:28<18:23,  1.27series/s]		[INFO] Processing optimization series:   9%|█▎             | 130/1526 [03:33<51:39,  2.22s/series]		[INFO] Processing optimization series:   9%|█▎             | 131/1526 [03:36<54:00,  2.32s/series]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        