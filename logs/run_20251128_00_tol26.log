Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at './data/battery_demand/tol26/resample_full.csv' and './data/battery_demand/tol26/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1378, 37)
		[INFO] Number of seeds ready for Case 3  = (2000, 36)

		[INFO] Case 1 exists â€” loaded battery demand from './data/battery_demand/tol26/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists â€” loaded battery demand from './data/battery_demand/tol26/case2_nan_filled/battery_demand.npy' with shape (1546, 37).
		[INFO] Case 3 exists â€” loaded battery demand from './data/battery_demand/tol26/case3_extended_generated/battery_demand.npy' with shape (3546, 37).

	1.6 Generating battery schedule...
		[INFO] Case 1 exists â€” loaded from './data/battery_demand/tol26/case1_real_only/battery_availability.npy' and './data/battery_demand/tol26/case1_real_only/battery_details.npy' shape (168, 263, 36) and (4, 168, 263)
		[INFO] Case 2 exists â€” loaded from './data/battery_demand/tol26/case2_nan_filled/battery_availability.npy' and './data/battery_demand/tol26/case2_nan_filled/battery_details.npy' shape (1546, 311, 36) and (4, 1546, 311)
		[INFO] Case 3 exists â€” loaded from './data/battery_demand/tol26/case3_extended_generated/battery_availability.npy' and './data/battery_demand/tol26/case3_extended_generated/battery_details.npy' shape (3546, 422, 36) and (4, 3546, 422)


==================================================
PART 2: MILP Optimization...
==================================================

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from './data/battery_demand/tol26/case1_real_only'
		[INFO] Results already exist at './data/optimization_results/tol26/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol26/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1546 samples from './data/battery_demand/tol26/case2_nan_filled'
		[INFO] Results already exist at './data/optimization_results/tol26/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol26/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 2 completed.

	2.3 Optimizing Case 3...
		[INFO] Loaded 3546 samples from './data/battery_demand/tol26/case3_extended_generated'
		[INFO] Results already exist at './data/optimization_results/tol26/case3_extended_generated/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol26/case3_extended_generated/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 3 completed.


==================================================
PART 3: Supervised Learning...
==================================================

	3.1 Training Case 1...
		=== Training Log Started: 2025-11-28 00:35:34.728830 ===
		Run Name: STAFV2_26_CASE1
		Device: cuda
		Epochs: 50000, Batch Size: 64, LR: 0.0001
		============================================================
ðŸ”¢ Unique quantized indices: 6686
âœ… Suggested num_embeddings: 8023
âœ… Processed 168 valid samples.
âœ… Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_26_CASE1.csv  (shape: (168, 429))
âœ… Saved feature metadata: ./data/training_results/feature_info_STAFV2_26_CASE1.json
âœ… Dataset split: 134 train, 34 val
âœ… Scalers fitted and saved.

		âœ… Model initialized with 785956 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train RÂ²  |   Val RÂ²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/50000 | 0.000100   |    9.68430   |    9.23293   |     -1.119 |     -1.036 |    0/80   
		    2/50000 | 0.000100   |    8.64835   |    9.12467   |     -1.043 |     -0.988 |    0/80   
		    3/50000 | 0.000100   |    9.37433   |    9.00371   |     -0.971 |     -0.936 |    0/80   
		    4/50000 | 0.000100   |    8.90541   |    8.86138   |     -0.899 |     -0.875 |    0/80   
		    5/50000 | 0.000100   |    8.49385   |    8.72192   |     -0.809 |     -0.817 |    0/80   
		    6/50000 | 0.000100   |    7.62858   |    8.56026   |     -0.777 |     -0.750 |    0/80   
		    7/50000 | 0.000100   |    7.32865   |    8.41870   |     -0.675 |     -0.693 |    0/80   
		    8/50000 | 0.000100   |    7.67862   |    8.26811   |     -0.644 |     -0.633 |    0/80   
		    9/50000 | 0.000100   |    8.74888   |    8.14269   |     -0.571 |     -0.584 |    0/80   
		   10/50000 | 0.000100   |    7.78797   |    7.98306   |     -0.508 |     -0.522 |    0/80   
		   11/50000 | 0.000100   |    7.86811   |    7.85127   |     -0.472 |     -0.472 |    0/80   
		   12/50000 | 0.000100   |    7.21862   |    7.69868   |     -0.393 |     -0.416 |    0/80   
		   13/50000 | 0.000100   |    7.46081   |    7.54066   |     -0.326 |     -0.358 |    0/80   
		   14/50000 | 0.000100   |    7.71392   |    7.43596   |     -0.285 |     -0.321 |    0/80   
		   15/50000 | 0.000100   |    7.32308   |    7.27686   |     -0.227 |     -0.265 |    0/80   
		   16/50000 | 0.000100   |    6.40081   |    7.14892   |     -0.181 |     -0.221 |    0/80   
		   17/50000 | 0.000100   |    6.80759   |    7.05941   |     -0.129 |     -0.190 |    0/80   
		   18/50000 | 0.000100   |    6.27123   |    6.91121   |     -0.040 |     -0.141 |    0/80   
		   19/50000 | 0.000100   |    7.00975   |    6.79297   |     -0.037 |     -0.102 |    0/80   
		   20/50000 | 0.000100   |    6.50611   |    6.65469   |      0.019 |     -0.058 |    0/80   
		   21/50000 | 0.000100   |    6.91645   |    6.50958   |      0.067 |     -0.012 |    0/80   
		   22/50000 | 0.000100   |    6.09994   |    6.38765   |      0.149 |      0.026 |    0/80   
		   23/50000 | 0.000100   |    5.44623   |    6.18357   |      0.151 |      0.087 |    0/80   
		   24/50000 | 0.000100   |    5.81391   |    6.06761   |      0.211 |      0.121 |    0/80   
		   25/50000 | 0.000100   |    5.69672   |    5.98669   |      0.216 |      0.144 |    0/80   
		   26/50000 | 0.000100   |    5.38493   |    5.85101   |      0.296 |      0.182 |    0/80   
		   27/50000 | 0.000100   |    4.99325   |    5.65132   |      0.305 |      0.237 |    0/80   
		   28/50000 | 0.000100   |    4.69642   |    5.50986   |      0.360 |      0.275 |    0/80   
		   29/50000 | 0.000100   |    5.11097   |    5.46044   |      0.402 |      0.288 |    0/80   
		   30/50000 | 0.000100   |    5.07491   |    5.43335   |      0.409 |      0.295 |    0/80   
		   31/50000 | 0.000100   |    4.54066   |    5.32503   |      0.417 |      0.323 |    0/80   
		   32/50000 | 0.000100   |    4.85306   |    5.28047   |      0.442 |      0.334 |    0/80   
		   33/50000 | 0.000100   |    4.21707   |    5.20607   |      0.490 |      0.353 |    0/80   
		   34/50000 | 0.000100   |    4.40711   |    5.12137   |      0.513 |      0.374 |    0/80   
		   35/50000 | 0.000100   |    4.57962   |    5.08687   |      0.532 |      0.382 |    0/80   
		   36/50000 | 0.000100   |    4.30994   |    4.94448   |      0.541 |      0.416 |    0/80   
		   37/50000 | 0.000100   |    4.33494   |    4.88439   |      0.539 |      0.430 |    0/80   
		   38/50000 | 0.000100   |    4.97029   |    4.87426   |      0.548 |      0.433 |    0/80   
		   39/50000 | 0.000100   |    4.19854   |    4.83918   |      0.613 |      0.441 |    0/80   
		   40/50000 | 0.000100   |    4.73233   |    4.78705   |      0.586 |      0.453 |    0/80   
		   41/50000 | 0.000100   |    4.75988   |    4.67125   |      0.577 |      0.479 |    0/80   
		   42/50000 | 0.000100   |    3.96538   |    4.66925   |      0.620 |      0.479 |    0/80   
		   43/50000 | 0.000100   |    4.10298   |    4.65641   |      0.628 |      0.482 |    0/80   
		   44/50000 | 0.000100   |    3.60036   |    4.65031   |      0.644 |      0.484 |    0/80   
		   45/50000 | 0.000100   |    3.45962   |    4.61280   |      0.671 |      0.492 |    0/80   
		   46/50000 | 0.000100   |    3.69776   |    4.56451   |      0.665 |      0.502 |    0/80   
		   47/50000 | 0.000100   |    4.25327   |    4.51331   |      0.634 |      0.514 |    0/80   
		   48/50000 | 0.000100   |    3.36963   |    4.50360   |      0.686 |      0.516 |    0/80   
		   49/50000 | 0.000100   |    4.03565   |    4.48529   |      0.680 |      0.520 |    0/80   
		   50/50000 | 0.000100   |    3.77630   |    4.46357   |      0.689 |      0.524 |    0/80   
		   51/50000 | 0.000100   |    3.76204   |    4.44846   |      0.683 |      0.527 |    0/80   
		   52/50000 | 0.000100   |    3.65932   |    4.44232   |      0.701 |      0.529 |    0/80   
		   53/50000 | 0.000100   |    4.01552   |    4.46146   |      0.686 |      0.525 |    0/80   
		   54/50000 | 0.000100   |    4.19045   |    4.44929   |      0.699 |      0.527 |    1/80   
		   55/50000 | 0.000100   |    3.54740   |    4.48478   |      0.698 |      0.520 |    2/80   
		   56/50000 | 0.000100   |    3.88479   |    4.47285   |      0.722 |      0.522 |    3/80   
		   57/50000 | 0.000100   |    2.96279   |    4.45994   |      0.727 |      0.525 |    4/80   
		   58/50000 | 0.000100   |    3.57494   |    4.47777   |      0.718 |      0.521 |    5/80   
		   59/50000 | 0.000100   |    3.13047   |    4.45888   |      0.754 |      0.525 |    6/80   
		   60/50000 | 0.000100   |    3.77507   |    4.48463   |      0.723 |      0.520 |    7/80   
		   61/50000 | 0.000100   |    3.37885   |    4.49673   |      0.747 |      0.517 |    8/80   
		   62/50000 | 0.000100   |    3.84239   |    4.53316   |      0.742 |      0.509 |    9/80   
		   63/50000 | 0.000100   |    3.74104   |    4.47727   |      0.744 |      0.521 |   10/80   
		   64/50000 | 0.000100   |    3.35835   |    4.49553   |      0.748 |      0.517 |   11/80   
		   65/50000 | 0.000100   |    3.51390   |    4.51394   |      0.737 |      0.513 |   12/80   
		   66/50000 | 0.000100   |    3.49429   |    4.51546   |      0.747 |      0.513 |   13/80   
		   67/50000 | 0.000100   |    3.76599   |    4.54088   |      0.768 |      0.508 |   14/80   
		   68/50000 | 0.000100   |    3.38981   |    4.52734   |      0.762 |      0.510 |   15/80   
		   69/50000 | 0.000100   |    3.58020   |    4.53928   |      0.774 |      0.508 |   16/80   
		   70/50000 | 0.000100   |    3.01821   |    4.52350   |      0.781 |      0.511 |   17/80   
		   71/50000 | 0.000100   |    2.74898   |    4.51015   |      0.781 |      0.514 |   18/80   
		   72/50000 | 0.000100   |    3.86762   |    4.50480   |      0.748 |      0.515 |   19/80   
		   73/50000 | 0.000080   |    3.59878   |    4.53297   |      0.809 |      0.509 |   20/80   
		   74/50000 | 0.000080   |    3.04736   |    4.52631   |      0.793 |      0.511 |   21/80   
		   75/50000 | 0.000080   |    3.15891   |    4.54104   |      0.801 |      0.508 |   22/80   
		   76/50000 | 0.000080   |    4.13324   |    4.58520   |      0.754 |      0.498 |   23/80   
		   77/50000 | 0.000080   |    3.27709   |    4.56269   |      0.798 |      0.503 |   24/80   
		   78/50000 | 0.000080   |    2.91253   |    4.56654   |      0.812 |      0.502 |   25/80   
		   79/50000 | 0.000080   |    3.95183   |    4.56580   |      0.798 |      0.502 |   26/80   
		   80/50000 | 0.000080   |    3.01345   |    4.57430   |      0.815 |      0.500 |   27/80   
		   81/50000 | 0.000080   |    2.82746   |    4.59457   |      0.820 |      0.496 |   28/80   
		   82/50000 | 0.000080   |    2.77950   |    4.60966   |      0.821 |      0.493 |   29/80   
		   83/50000 | 0.000080   |    3.41956   |    4.58586   |      0.823 |      0.498 |   30/80   
		   84/50000 | 0.000080   |    2.65254   |    4.56748   |      0.830 |      0.502 |   31/80   
		   85/50000 | 0.000080   |    3.68639   |    4.59579   |      0.815 |      0.496 |   32/80   
		   86/50000 | 0.000080   |    2.61224   |    4.60548   |      0.815 |      0.493 |   33/80   
		   87/50000 | 0.000080   |    2.46000   |    4.61090   |      0.835 |      0.492 |   34/80   
		   88/50000 | 0.000080   |    2.72750   |    4.61457   |      0.845 |      0.491 |   35/80   
		   89/50000 | 0.000080   |    2.57481   |    4.59395   |      0.835 |      0.496 |   36/80   
		   90/50000 | 0.000080   |    3.29103   |    4.64213   |      0.837 |      0.485 |   37/80   
		   91/50000 | 0.000080   |    2.94685   |    4.60816   |      0.847 |      0.493 |   38/80   
		   92/50000 | 0.000080   |    2.37381   |    4.62414   |      0.853 |      0.489 |   39/80   
		   93/50000 | 0.000080   |    2.65521   |    4.62444   |      0.862 |      0.489 |   40/80   
		   94/50000 | 0.000064   |    2.50588   |    4.63777   |      0.861 |      0.486 |   41/80   
		   95/50000 | 0.000064   |    3.26656   |    4.58171   |      0.839 |      0.499 |   42/80   
		   96/50000 | 0.000064   |    3.02325   |    4.58565   |      0.859 |      0.498 |   43/80   
		   97/50000 | 0.000064   |    2.47279   |    4.57856   |      0.858 |      0.499 |   44/80   
		   98/50000 | 0.000064   |    3.38758   |    4.61038   |      0.849 |      0.492 |   45/80   
		   99/50000 | 0.000064   |    2.12231   |    4.59350   |      0.870 |      0.496 |   46/80   
		  100/50000 | 0.000064   |    3.73695   |    4.58330   |      0.839 |      0.498 |   47/80   
		  101/50000 | 0.000064   |    2.65707   |    4.57958   |      0.862 |      0.499 |   48/80   
		  102/50000 | 0.000064   |    2.23962   |    4.57396   |      0.882 |      0.500 |   49/80   
		  103/50000 | 0.000064   |    2.60975   |    4.56929   |      0.860 |      0.501 |   50/80   
		  104/50000 | 0.000064   |    3.04401   |    4.57602   |      0.856 |      0.500 |   51/80   
		  105/50000 | 0.000064   |    2.43331   |    4.58580   |      0.867 |      0.498 |   52/80   
		  106/50000 | 0.000064   |    2.61917   |    4.56565   |      0.870 |      0.502 |   53/80   
		  107/50000 | 0.000064   |    2.16393   |    4.58655   |      0.886 |      0.498 |   54/80   
		  108/50000 | 0.000064   |    2.55137   |    4.60599   |      0.848 |      0.493 |   55/80   
		  109/50000 | 0.000064   |    2.80837   |    4.60457   |      0.867 |      0.494 |   56/80   
		  110/50000 | 0.000064   |    4.17474   |    4.65801   |      0.844 |      0.482 |   57/80   
		  111/50000 | 0.000064   |    2.45179   |    4.64453   |      0.883 |      0.485 |   58/80   
		  112/50000 | 0.000064   |    1.98418   |    4.67163   |      0.889 |      0.479 |   59/80   
		  113/50000 | 0.000064   |    2.46465   |    4.65123   |      0.870 |      0.483 |   60/80   
		  114/50000 | 0.000064   |    2.41046   |    4.63884   |      0.850 |      0.486 |   61/80   
		  115/50000 | 0.000051   |    2.96108   |    4.64734   |      0.876 |      0.484 |   62/80   
		  116/50000 | 0.000051   |    2.28636   |    4.65011   |      0.894 |      0.484 |   63/80   
		  117/50000 | 0.000051   |    3.29442   |    4.66540   |      0.877 |      0.480 |   64/80   
		  118/50000 | 0.000051   |    2.54594   |    4.65934   |      0.894 |      0.482 |   65/80   
		  119/50000 | 0.000051   |    2.92265   |    4.66019   |      0.881 |      0.481 |   66/80   
		  120/50000 | 0.000051   |    2.26694   |    4.63054   |      0.891 |      0.488 |   67/80   
		  121/50000 | 0.000051   |    2.41762   |    4.63861   |      0.867 |      0.486 |   68/80   
		  122/50000 | 0.000051   |    2.19667   |    4.65438   |      0.887 |      0.483 |   69/80   
		  123/50000 | 0.000051   |    2.25825   |    4.64834   |      0.901 |      0.484 |   70/80   
		  124/50000 | 0.000051   |    1.67006   |    4.67171   |      0.911 |      0.479 |   71/80   
		  125/50000 | 0.000051   |    2.09445   |    4.66250   |      0.897 |      0.481 |   72/80   
		  126/50000 | 0.000051   |    2.12652   |    4.64160   |      0.892 |      0.485 |   73/80   
		  127/50000 | 0.000051   |    2.07070   |    4.63255   |      0.898 |      0.487 |   74/80   
		  128/50000 | 0.000051   |    2.19469   |    4.64179   |      0.894 |      0.485 |   75/80   
		  129/50000 | 0.000051   |    2.24418   |    4.66505   |      0.900 |      0.480 |   76/80   
		  130/50000 | 0.000051   |    1.79829   |    4.65721   |      0.908 |      0.482 |   77/80   
		  131/50000 | 0.000051   |    2.34893   |    4.66862   |      0.901 |      0.479 |   78/80   
		  132/50000 | 0.000051   |    2.37060   |    4.68327   |      0.899 |      0.476 |   79/80   

		Early stopping triggered.
		[INFO] Case 1 completed.

	3.2 Training Case 2...
		=== Training Log Started: 2025-11-28 00:36:24.658314 ===
		Run Name: STAFV2_26_CASE2
		Device: cuda
		Epochs: 50000, Batch Size: 64, LR: 0.0001
		============================================================
ðŸ”¢ Unique quantized indices: 24154
âœ… Suggested num_embeddings: 28984
âœ… Processed 1546 valid samples.
âœ… Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_26_CASE2.csv  (shape: (1546, 429))
âœ… Saved feature metadata: ./data/training_results/feature_info_STAFV2_26_CASE2.json
âœ… Dataset split: 1236 train, 310 val
âœ… Scalers fitted and saved.

		âœ… Model initialized with 785956 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train RÂ²  |   Val RÂ²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/50000 | 0.000100   |    9.24964   |    8.56092   |     -1.046 |     -0.755 |    0/80   
		    2/50000 | 0.000100   |    8.02398   |    7.39708   |     -0.556 |     -0.309 |    0/80   
		    3/50000 | 0.000100   |    6.88316   |    6.35947   |     -0.166 |      0.033 |    0/80   
		    4/50000 | 0.000100   |    5.92589   |    5.52331   |      0.143 |      0.270 |    0/80   
		    5/50000 | 0.000100   |    5.26121   |    5.05479   |      0.336 |      0.387 |    0/80   
		    6/50000 | 0.000100   |    4.80936   |    4.75144   |      0.444 |      0.457 |    0/80   
		    7/50000 | 0.000100   |    4.56720   |    4.60810   |      0.497 |      0.488 |    0/80   
		    8/50000 | 0.000100   |    4.52025   |    4.51392   |      0.512 |      0.508 |    0/80   
		    9/50000 | 0.000100   |    4.30694   |    4.44113   |      0.554 |      0.524 |    0/80   
		   10/50000 | 0.000100   |    4.21245   |    4.39965   |      0.563 |      0.533 |    0/80   
		   11/50000 | 0.000100   |    4.13271   |    4.34068   |      0.593 |      0.545 |    0/80   
		   12/50000 | 0.000100   |    4.09310   |    4.32163   |      0.603 |      0.548 |    0/80   
		   13/50000 | 0.000100   |    3.96267   |    4.27651   |      0.621 |      0.559 |    0/80   
		   14/50000 | 0.000100   |    3.88661   |    4.23981   |      0.639 |      0.565 |    0/80   
		   15/50000 | 0.000100   |    3.78581   |    4.21410   |      0.655 |      0.571 |    0/80   
		   16/50000 | 0.000100   |    3.75549   |    4.22506   |      0.665 |      0.568 |    0/80   
		   17/50000 | 0.000100   |    3.69246   |    4.17270   |      0.672 |      0.579 |    1/80   
		   18/50000 | 0.000100   |    3.53362   |    4.19028   |      0.696 |      0.575 |    0/80   
		   19/50000 | 0.000100   |    3.47376   |    4.17026   |      0.707 |      0.578 |    1/80   
		   20/50000 | 0.000100   |    3.50630   |    4.17090   |      0.706 |      0.578 |    0/80   
		   21/50000 | 0.000100   |    3.43142   |    4.16470   |      0.713 |      0.580 |    1/80   
		   22/50000 | 0.000100   |    3.39628   |    4.16800   |      0.720 |      0.578 |    0/80   
		   23/50000 | 0.000100   |    3.31260   |    4.16181   |      0.737 |      0.580 |    1/80   
		   24/50000 | 0.000100   |    3.27591   |    4.16145   |      0.738 |      0.580 |    0/80   
		   25/50000 | 0.000100   |    3.26668   |    4.16564   |      0.742 |      0.579 |    0/80   
		   26/50000 | 0.000100   |    3.23904   |    4.13512   |      0.753 |      0.585 |    1/80   
		   27/50000 | 0.000100   |    3.09968   |    4.17081   |      0.767 |      0.578 |    0/80   
		   28/50000 | 0.000100   |    3.22059   |    4.17823   |      0.751 |      0.576 |    1/80   
		   29/50000 | 0.000100   |    3.12883   |    4.18189   |      0.761 |      0.576 |    2/80   
		   30/50000 | 0.000100   |    3.06820   |    4.17876   |      0.777 |      0.576 |    3/80   
		   31/50000 | 0.000100   |    3.00776   |    4.19216   |      0.783 |      0.573 |    4/80   
		   32/50000 | 0.000100   |    2.98269   |    4.17067   |      0.789 |      0.578 |    5/80   
		   33/50000 | 0.000100   |    2.96876   |    4.17133   |      0.785 |      0.578 |    6/80   
		   34/50000 | 0.000100   |    2.96128   |    4.19215   |      0.789 |      0.574 |    7/80   
		   35/50000 | 0.000100   |    2.84539   |    4.20321   |      0.804 |      0.571 |    8/80   
		   36/50000 | 0.000100   |    2.89825   |    4.20526   |      0.798 |      0.571 |    9/80   
		   37/50000 | 0.000100   |    2.89510   |    4.19714   |      0.801 |      0.573 |   10/80   
		   38/50000 | 0.000100   |    2.80114   |    4.22516   |      0.811 |      0.567 |   11/80   
		   39/50000 | 0.000100   |    2.78914   |    4.24012   |      0.813 |      0.564 |   12/80   
		   40/50000 | 0.000100   |    2.77445   |    4.24602   |      0.814 |      0.563 |   13/80   
		   41/50000 | 0.000100   |    2.63061   |    4.25642   |      0.833 |      0.560 |   14/80   
		   42/50000 | 0.000100   |    2.64512   |    4.25619   |      0.833 |      0.560 |   15/80   
		   43/50000 | 0.000100   |    2.73962   |    4.29013   |      0.823 |      0.553 |   16/80   
		   44/50000 | 0.000100   |    2.53702   |    4.24704   |      0.843 |      0.562 |   17/80   
		   45/50000 | 0.000100   |    2.61561   |    4.28883   |      0.833 |      0.553 |   18/80   
		   46/50000 | 0.000100   |    2.57664   |    4.26160   |      0.838 |      0.560 |   19/80   
		   47/50000 | 0.000080   |    2.57329   |    4.27550   |      0.841 |      0.556 |   20/80   
		   48/50000 | 0.000080   |    2.59994   |    4.24914   |      0.839 |      0.562 |   21/80   
		   49/50000 | 0.000080   |    2.57232   |    4.27458   |      0.844 |      0.557 |   22/80   
		   50/50000 | 0.000080   |    2.50316   |    4.30929   |      0.853 |      0.550 |   23/80   
		   51/50000 | 0.000080   |    2.40222   |    4.28663   |      0.860 |      0.554 |   24/80   
		   52/50000 | 0.000080   |    2.41546   |    4.30116   |      0.862 |      0.551 |   25/80   
		   53/50000 | 0.000080   |    2.38728   |    4.30082   |      0.861 |      0.552 |   26/80   
		   54/50000 | 0.000080   |    2.45014   |    4.32611   |      0.856 |      0.546 |   27/80   
		   55/50000 | 0.000080   |    2.34642   |    4.32184   |      0.865 |      0.547 |   28/80   
		   56/50000 | 0.000080   |    2.42488   |    4.34521   |      0.862 |      0.542 |   29/80   
		   57/50000 | 0.000080   |    2.30195   |    4.34460   |      0.873 |      0.542 |   30/80   
		   58/50000 | 0.000080   |    2.42014   |    4.34532   |      0.862 |      0.542 |   31/80   
		   59/50000 | 0.000080   |    2.36859   |    4.36096   |      0.867 |      0.539 |   32/80   
		   60/50000 | 0.000080   |    2.23385   |    4.38727   |      0.879 |      0.534 |   33/80   
		   61/50000 | 0.000080   |    2.34711   |    4.37707   |      0.868 |      0.536 |   34/80   
		   62/50000 | 0.000080   |    2.21719   |    4.38324   |      0.882 |      0.535 |   35/80   
		   63/50000 | 0.000080   |    2.12840   |    4.40174   |      0.889 |      0.530 |   36/80   
		   64/50000 | 0.000080   |    2.20791   |    4.38742   |      0.882 |      0.533 |   37/80   
		   65/50000 | 0.000080   |    2.27340   |    4.40624   |      0.878 |      0.530 |   38/80   
		   66/50000 | 0.000080   |    2.25226   |    4.37972   |      0.881 |      0.535 |   39/80   
		   67/50000 | 0.000080   |    2.22554   |    4.40589   |      0.885 |      0.530 |   40/80   
		   68/50000 | 0.000064   |    2.20301   |    4.39204   |      0.887 |      0.533 |   41/80   
		   69/50000 | 0.000064   |    2.18408   |    4.40621   |      0.885 |      0.530 |   42/80   
		   70/50000 | 0.000064   |    2.10560   |    4.42239   |      0.893 |      0.527 |   43/80   
		   71/50000 | 0.000064   |    2.09102   |    4.43800   |      0.896 |      0.523 |   44/80   
		   72/50000 | 0.000064   |    2.07084   |    4.41583   |      0.898 |      0.528 |   45/80   
		   73/50000 | 0.000064   |    2.02396   |    4.41210   |      0.901 |      0.529 |   46/80   
		   74/50000 | 0.000064   |    2.15649   |    4.39824   |      0.888 |      0.531 |   47/80   
		   75/50000 | 0.000064   |    2.11153   |    4.40135   |      0.892 |      0.531 |   48/80   
		   76/50000 | 0.000064   |    2.07225   |    4.40709   |      0.897 |      0.530 |   49/80   
		   77/50000 | 0.000064   |    2.17336   |    4.42875   |      0.885 |      0.525 |   50/80   
		   78/50000 | 0.000064   |    1.98660   |    4.43645   |      0.906 |      0.523 |   51/80   
		   79/50000 | 0.000064   |    2.02830   |    4.42153   |      0.900 |      0.526 |   52/80   
		   80/50000 | 0.000064   |    2.07303   |    4.40322   |      0.900 |      0.530 |   53/80   
		   81/50000 | 0.000064   |    2.08676   |    4.43513   |      0.896 |      0.524 |   54/80   
		   82/50000 | 0.000064   |    2.03929   |    4.45026   |      0.903 |      0.521 |   55/80   
		   83/50000 | 0.000064   |    2.01369   |    4.44841   |      0.901 |      0.521 |   56/80   
		   84/50000 | 0.000064   |    2.04130   |    4.45015   |      0.899 |      0.520 |   57/80   
		   85/50000 | 0.000064   |    1.90081   |    4.46740   |      0.911 |      0.517 |   58/80   
		   86/50000 | 0.000064   |    1.97231   |    4.47657   |      0.906 |      0.515 |   59/80   
		   87/50000 | 0.000064   |    2.07515   |    4.46063   |      0.901 |      0.518 |   60/80   
		   88/50000 | 0.000064   |    1.95615   |    4.46531   |      0.910 |      0.517 |   61/80   
		   89/50000 | 0.000051   |    2.03901   |    4.46189   |      0.899 |      0.518 |   62/80   
		   90/50000 | 0.000051   |    1.89461   |    4.48663   |      0.915 |      0.513 |   63/80   
		   91/50000 | 0.000051   |    1.85319   |    4.47956   |      0.916 |      0.514 |   64/80   
		   92/50000 | 0.000051   |    2.08531   |    4.48634   |      0.908 |      0.512 |   65/80   
		   93/50000 | 0.000051   |    1.92152   |    4.48534   |      0.912 |      0.513 |   66/80   
		   94/50000 | 0.000051   |    1.90339   |    4.51184   |      0.912 |      0.508 |   67/80   
		   95/50000 | 0.000051   |    2.05386   |    4.48395   |      0.896 |      0.513 |   68/80   
		   96/50000 | 0.000051   |    1.91573   |    4.49273   |      0.910 |      0.512 |   69/80   
		   97/50000 | 0.000051   |    1.98793   |    4.50026   |      0.906 |      0.510 |   70/80   
		   98/50000 | 0.000051   |    1.91999   |    4.51066   |      0.911 |      0.508 |   71/80   
		   99/50000 | 0.000051   |    1.89850   |    4.47611   |      0.919 |      0.515 |   72/80   
		  100/50000 | 0.000051   |    1.88329   |    4.47964   |      0.921 |      0.514 |   73/80   
		  101/50000 | 0.000051   |    1.92567   |    4.51131   |      0.910 |      0.508 |   74/80   
		  102/50000 | 0.000051   |    1.90362   |    4.48433   |      0.912 |      0.513 |   75/80   
		  103/50000 | 0.000051   |    1.94136   |    4.50651   |      0.909 |      0.509 |   76/80   
		  104/50000 | 0.000051   |    1.86777   |    4.49578   |      0.916 |      0.511 |   77/80   
		  105/50000 | 0.000051   |    1.84827   |    4.52695   |      0.920 |      0.504 |   78/80   
		  106/50000 | 0.000051   |    1.95505   |    4.54132   |      0.910 |      0.501 |   79/80   

		Early stopping triggered.
		[INFO] Case 2 completed.

	3.3 Training Case 3...
		=== Training Log Started: 2025-11-28 00:38:34.585198 ===
		Run Name: STAFV2_26_CASE3
		Device: cuda
		Epochs: 50000, Batch Size: 64, LR: 0.0001
		============================================================
ðŸ”¢ Unique quantized indices: 36538
âœ… Suggested num_embeddings: 43845
âœ… Processed 3546 valid samples.
âœ… Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_26_CASE3.csv  (shape: (3546, 429))
âœ… Saved feature metadata: ./data/training_results/feature_info_STAFV2_26_CASE3.json
âœ… Dataset split: 2836 train, 710 val
âœ… Scalers fitted and saved.

		âœ… Model initialized with 785956 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train RÂ²  |   Val RÂ²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/50000 | 0.000100   |    8.33722   |    7.14102   |     -0.746 |     -0.221 |    0/80   
		    2/50000 | 0.000100   |    6.06949   |    5.47515   |      0.074 |      0.292 |    0/80   
		    3/50000 | 0.000100   |    4.99161   |    5.00703   |      0.376 |      0.401 |    0/80   
		    4/50000 | 0.000100   |    4.65899   |    4.82827   |      0.457 |      0.436 |    0/80   
		    5/50000 | 0.000100   |    4.47620   |    4.70730   |      0.496 |      0.462 |    0/80   
		    6/50000 | 0.000100   |    4.38032   |    4.59147   |      0.519 |      0.481 |    0/80   
		    7/50000 | 0.000100   |    4.24819   |    4.52502   |      0.548 |      0.493 |    0/80   
		    8/50000 | 0.000100   |    4.14586   |    4.46004   |      0.568 |      0.504 |    0/80   
		    9/50000 | 0.000100   |    4.08932   |    4.39214   |      0.578 |      0.515 |    0/80   
		   10/50000 | 0.000100   |    4.00289   |    4.34581   |      0.596 |      0.525 |    0/80   
		   11/50000 | 0.000100   |    3.93939   |    4.27897   |      0.613 |      0.536 |    0/80   
		   12/50000 | 0.000100   |    3.87546   |    4.24706   |      0.623 |      0.539 |    0/80   
		   13/50000 | 0.000100   |    3.79477   |    4.18235   |      0.638 |      0.553 |    0/80   
		   14/50000 | 0.000100   |    3.81933   |    4.14969   |      0.635 |      0.559 |    0/80   
		   15/50000 | 0.000100   |    3.70942   |    4.09854   |      0.654 |      0.568 |    0/80   
		   16/50000 | 0.000100   |    3.66364   |    4.09946   |      0.663 |      0.567 |    0/80   
		   17/50000 | 0.000100   |    3.63843   |    4.14545   |      0.668 |      0.556 |    1/80   
		   18/50000 | 0.000100   |    3.55298   |    4.02002   |      0.682 |      0.584 |    2/80   
		   19/50000 | 0.000100   |    3.47545   |    4.04020   |      0.697 |      0.577 |    0/80   
		   20/50000 | 0.000100   |    3.47596   |    3.98408   |      0.697 |      0.589 |    1/80   
		   21/50000 | 0.000100   |    3.48637   |    3.94938   |      0.697 |      0.596 |    0/80   
		   22/50000 | 0.000100   |    3.41525   |    3.96654   |      0.708 |      0.591 |    0/80   
		   23/50000 | 0.000100   |    3.43221   |    3.92308   |      0.710 |      0.600 |    1/80   
		   24/50000 | 0.000100   |    3.33851   |    3.93983   |      0.723 |      0.596 |    0/80   
		   25/50000 | 0.000100   |    3.24894   |    3.93781   |      0.735 |      0.598 |    1/80   
		   26/50000 | 0.000100   |    3.21647   |    3.87753   |      0.742 |      0.609 |    2/80   
		   27/50000 | 0.000100   |    3.25907   |    3.88203   |      0.733 |      0.608 |    0/80   
		   28/50000 | 0.000100   |    3.18342   |    3.93746   |      0.744 |      0.597 |    1/80   
		   29/50000 | 0.000100   |    3.15017   |    3.89056   |      0.751 |      0.607 |    2/80   
		   30/50000 | 0.000100   |    3.05069   |    3.87831   |      0.767 |      0.609 |    3/80   
		   31/50000 | 0.000100   |    3.09820   |    4.02887   |      0.761 |      0.579 |    4/80   
		   32/50000 | 0.000100   |    3.10804   |    3.87329   |      0.757 |      0.609 |    5/80   
		   33/50000 | 0.000100   |    3.05827   |    3.86972   |      0.767 |      0.610 |    0/80   
		   34/50000 | 0.000100   |    2.96473   |    3.89998   |      0.781 |      0.605 |    0/80   
		   35/50000 | 0.000100   |    2.92722   |    3.86235   |      0.784 |      0.611 |    1/80   
		   36/50000 | 0.000100   |    2.94369   |    3.84380   |      0.784 |      0.614 |    0/80   
		   37/50000 | 0.000100   |    2.90540   |    3.81637   |      0.789 |      0.620 |    0/80   
		   38/50000 | 0.000100   |    2.95907   |    3.83425   |      0.780 |      0.617 |    0/80   
		   39/50000 | 0.000100   |    2.85253   |    3.87501   |      0.795 |      0.609 |    1/80   
		   40/50000 | 0.000100   |    2.88768   |    3.90253   |      0.793 |      0.604 |    2/80   
		   41/50000 | 0.000100   |    2.81174   |    3.87531   |      0.801 |      0.608 |    3/80   
		   42/50000 | 0.000100   |    2.82615   |    3.79277   |      0.800 |      0.625 |    4/80   
		   43/50000 | 0.000100   |    2.81450   |    3.82596   |      0.801 |      0.619 |    0/80   
		   44/50000 | 0.000100   |    2.77785   |    3.88014   |      0.806 |      0.607 |    1/80   
		   45/50000 | 0.000100   |    2.72105   |    3.86782   |      0.815 |      0.610 |    2/80   
		   46/50000 | 0.000100   |    2.70647   |    3.82930   |      0.816 |      0.617 |    3/80   
		   47/50000 | 0.000100   |    2.69017   |    3.88175   |      0.818 |      0.607 |    4/80   
		   48/50000 | 0.000100   |    2.70815   |    3.84873   |      0.819 |      0.614 |    5/80   
		   49/50000 | 0.000100   |    2.71962   |    3.85273   |      0.815 |      0.614 |    6/80   
		   50/50000 | 0.000100   |    2.63589   |    3.93055   |      0.826 |      0.598 |    7/80   
		   51/50000 | 0.000100   |    2.73070   |    3.88700   |      0.817 |      0.607 |    8/80   
		   52/50000 | 0.000100   |    2.58298   |    3.89647   |      0.832 |      0.605 |    9/80   
		   53/50000 | 0.000100   |    2.62921   |    3.91899   |      0.830 |      0.600 |   10/80   
		   54/50000 | 0.000100   |    2.58313   |    3.82458   |      0.835 |      0.618 |   11/80   
		   55/50000 | 0.000100   |    2.53091   |    3.87510   |      0.841 |      0.608 |   12/80   
		   56/50000 | 0.000100   |    2.50959   |    3.86277   |      0.843 |      0.611 |   13/80   
		   57/50000 | 0.000100   |    2.49508   |    3.88749   |      0.844 |      0.605 |   14/80   
		   58/50000 | 0.000100   |    2.56248   |    3.90912   |      0.836 |      0.602 |   15/80   
		   59/50000 | 0.000100   |    2.49695   |    3.85327   |      0.846 |      0.613 |   16/80   
		   60/50000 | 0.000100   |    2.56949   |    3.84392   |      0.837 |      0.615 |   17/80   
		   61/50000 | 0.000100   |    2.51640   |    3.88829   |      0.843 |      0.606 |   18/80   
		   62/50000 | 0.000100   |    2.42857   |    3.89564   |      0.852 |      0.604 |   19/80   
		   63/50000 | 0.000080   |    2.45006   |    3.85233   |      0.849 |      0.613 |   20/80   
		   64/50000 | 0.000080   |    2.45362   |    3.92171   |      0.849 |      0.600 |   21/80   
		   65/50000 | 0.000080   |    2.38760   |    3.87542   |      0.857 |      0.609 |   22/80   
		   66/50000 | 0.000080   |    2.41594   |    3.89724   |      0.854 |      0.604 |   23/80   
		   67/50000 | 0.000080   |    2.39373   |    3.94762   |      0.857 |      0.595 |   24/80   
		   68/50000 | 0.000080   |    2.37580   |    3.82929   |      0.858 |      0.619 |   25/80   
		   69/50000 | 0.000080   |    2.43315   |    3.89260   |      0.854 |      0.605 |   26/80   
		   70/50000 | 0.000080   |    2.39426   |    3.88401   |      0.858 |      0.607 |   27/80   
		   71/50000 | 0.000080   |    2.35337   |    3.97010   |      0.861 |      0.590 |   28/80   
		   72/50000 | 0.000080   |    2.41243   |    3.92629   |      0.853 |      0.599 |   29/80   
		   73/50000 | 0.000080   |    2.35828   |    3.86198   |      0.863 |      0.613 |   30/80   
		   74/50000 | 0.000080   |    2.25109   |    3.93621   |      0.872 |      0.597 |   31/80   
		   75/50000 | 0.000080   |    2.25388   |    3.87453   |      0.873 |      0.609 |   32/80   
		   76/50000 | 0.000080   |    2.29412   |    3.88353   |      0.868 |      0.608 |   33/80   
		   77/50000 | 0.000080   |    2.26194   |    3.88048   |      0.874 |      0.609 |   34/80   
		   78/50000 | 0.000080   |    2.24608   |    3.88713   |      0.872 |      0.608 |   35/80   
		   79/50000 | 0.000080   |    2.23876   |    3.91033   |      0.875 |      0.602 |   36/80   
		   80/50000 | 0.000080   |    2.26222   |    4.01603   |      0.872 |      0.581 |   37/80   
		   81/50000 | 0.000080   |    2.29267   |    3.88077   |      0.871 |      0.609 |   38/80   
		   82/50000 | 0.000080   |    2.20773   |    3.92118   |      0.878 |      0.600 |   39/80   
		   83/50000 | 0.000080   |    2.17568   |    4.00570   |      0.882 |      0.583 |   40/80   
		   84/50000 | 0.000064   |    2.23146   |    3.90913   |      0.878 |      0.603 |   41/80   
		   85/50000 | 0.000064   |    2.19729   |    3.91729   |      0.880 |      0.601 |   42/80   
		   86/50000 | 0.000064   |    2.24184   |    3.95744   |      0.878 |      0.592 |   43/80   
		   87/50000 | 0.000064   |    2.14592   |    3.97176   |      0.885 |      0.590 |   44/80   
		   88/50000 | 0.000064   |    2.14468   |    3.98662   |      0.885 |      0.588 |   45/80   
		   89/50000 | 0.000064   |    2.21854   |    3.91954   |      0.878 |      0.601 |   46/80   
		   90/50000 | 0.000064   |    2.24989   |    3.92092   |      0.874 |      0.600 |   47/80   
		   91/50000 | 0.000064   |    2.20226   |    3.91968   |      0.881 |      0.601 |   48/80   
		   92/50000 | 0.000064   |    2.13959   |    3.91385   |      0.887 |      0.601 |   49/80   
		   93/50000 | 0.000064   |    2.09960   |    3.92806   |      0.889 |      0.598 |   50/80   
		   94/50000 | 0.000064   |    2.13652   |    3.92971   |      0.887 |      0.597 |   51/80   
		   95/50000 | 0.000064   |    2.12276   |    3.91347   |      0.889 |      0.602 |   52/80   
		   96/50000 | 0.000064   |    2.15799   |    3.96245   |      0.883 |      0.592 |   53/80   
		   97/50000 | 0.000064   |    2.10016   |    3.99069   |      0.889 |      0.587 |   54/80   
		   98/50000 | 0.000064   |    2.18290   |    3.94705   |      0.883 |      0.595 |   55/80   
		   99/50000 | 0.000064   |    2.05791   |    3.90890   |      0.894 |      0.602 |   56/80   
		  100/50000 | 0.000064   |    2.06046   |    3.97857   |      0.893 |      0.588 |   57/80   
		  101/50000 | 0.000064   |    2.07551   |    3.94277   |      0.892 |      0.596 |   58/80   
		  102/50000 | 0.000064   |    2.11854   |    3.92969   |      0.887 |      0.597 |   59/80   
		  103/50000 | 0.000064   |    2.05924   |    4.00065   |      0.893 |      0.583 |   60/80   
		  104/50000 | 0.000064   |    2.05044   |    4.00585   |      0.894 |      0.582 |   61/80   
		  105/50000 | 0.000051   |    2.00790   |    3.93821   |      0.900 |      0.596 |   62/80   
		  106/50000 | 0.000051   |    2.01260   |    3.98389   |      0.898 |      0.587 |   63/80   
		  107/50000 | 0.000051   |    2.12402   |    4.00645   |      0.886 |      0.583 |   64/80   
		  108/50000 | 0.000051   |    2.01000   |    4.01884   |      0.900 |      0.580 |   65/80   
		  109/50000 | 0.000051   |    1.98456   |    3.97910   |      0.901 |      0.589 |   66/80   
		  110/50000 | 0.000051   |    2.00456   |    3.98121   |      0.899 |      0.588 |   67/80   
		  111/50000 | 0.000051   |    2.00984   |    4.01416   |      0.898 |      0.581 |   68/80   
		  112/50000 | 0.000051   |    2.05721   |    3.99718   |      0.894 |      0.585 |   69/80   
		  113/50000 | 0.000051   |    2.10623   |    3.96246   |      0.890 |      0.592 |   70/80   
		  114/50000 | 0.000051   |    2.08620   |    4.02462   |      0.895 |      0.580 |   71/80   
		  115/50000 | 0.000051   |    1.96410   |    3.99794   |      0.903 |      0.584 |   72/80   
		  116/50000 | 0.000051   |    1.97129   |    3.95940   |      0.902 |      0.593 |   73/80   
		  117/50000 | 0.000051   |    2.00895   |    3.97908   |      0.900 |      0.590 |   74/80   
		  118/50000 | 0.000051   |    2.03894   |    3.97259   |      0.897 |      0.590 |   75/80   
		  119/50000 | 0.000051   |    1.99426   |    3.97058   |      0.901 |      0.591 |   76/80   
		  120/50000 | 0.000051   |    2.00632   |    3.97241   |      0.899 |      0.590 |   77/80   
		  121/50000 | 0.000051   |    1.98061   |    3.97572   |      0.902 |      0.591 |   78/80   
		  122/50000 | 0.000051   |    2.01470   |    4.02835   |      0.898 |      0.579 |   79/80   

		Early stopping triggered.
		[INFO] Case 3 completed.
