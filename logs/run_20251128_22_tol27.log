Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at './data/battery_demand/tol27/resample_full.csv' and './data/battery_demand/tol27/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1381, 37)
		[INFO] Number of seeds ready for Case 3  = (2000, 36)

		[INFO] Case 1 exists — loaded battery demand from './data/battery_demand/tol27/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists — loaded battery demand from './data/battery_demand/tol27/case2_nan_filled/battery_demand.npy' with shape (1549, 37).
		[INFO] Case 3 exists — loaded battery demand from './data/battery_demand/tol27/case3_extended_generated/battery_demand.npy' with shape (3549, 37).
		[INFO] Case 0: Successfully added test pair 2024-03-15 & 2024-03-16
		Data: [10536, 28, 30, 35, 37, 37, 36, 33, 26, 10, 6, 10, 14, 19, 18, 15, 20, 26, 15, 9, 16, 21, 20, 8, 12, 15, 24, 31, 35, 32, 35, 34, 32, 31, 30, 22, 14, 18, 27, 18, 19, 19, 25, 25, 25, 26, 27, 17, 19]
		[INFO] Case 0: Successfully added test pair 2024-03-29 & 2024-03-30
		Data: [10872, 13, 26, 31, 33, 33, 33, 31, 15, 8, 19, 11, 15, 18, 16, 18, 18, 19, 7, 4, 23, 23, 16, 17, 18, 18, 19, 24, 29, 30, 30, 22, 27, 21, 14, 15, 16, 20, 18, 23, 27, 18, 2, 10, 23, 22, 22, 17, 21]

	1.6 Generating battery schedule...
		[INFO] Case 1 exists — loaded from './data/battery_demand/tol27/case1_real_only/battery_availability.npy' and './data/battery_demand/tol27/case1_real_only/battery_details.npy' shape (168, 263, 36) and (4, 168, 263)
		[INFO] Case 2 exists — loaded from './data/battery_demand/tol27/case2_nan_filled/battery_availability.npy' and './data/battery_demand/tol27/case2_nan_filled/battery_details.npy' shape (1549, 311, 36) and (4, 1549, 311)
		[INFO] Case 3 exists — loaded from './data/battery_demand/tol27/case3_extended_generated/battery_availability.npy' and './data/battery_demand/tol27/case3_extended_generated/battery_details.npy' shape (3549, 422, 36) and (4, 3549, 422)


==================================================
PART 2: MILP Optimization...
==================================================

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from './data/battery_demand/tol27/case1_real_only'
		[INFO] Results already exist at './data/optimization_results/tol27/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol27/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1549 samples from './data/battery_demand/tol27/case2_nan_filled'
		[INFO] Results already exist at './data/optimization_results/tol27/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol27/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 2 completed.

	2.3 Optimizing Case 3...
		[INFO] Loaded 3549 samples from './data/battery_demand/tol27/case3_extended_generated'
		[INFO] Results already exist at './data/optimization_results/tol27/case3_extended_generated/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol27/case3_extended_generated/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 3 completed.


==================================================
PART 3: Supervised Learning...
==================================================

	3.1 Training Case 1...
		=== Training Log Started: 2025-11-28 22:07:21.368974 ===
		Run Name: STAFV2_27_CASE1
		Device: cuda
		Epochs: 1000, Batch Size: 128, LR: 0.01
		============================================================
		[INFO] Unique quantized indices: 6686
		[INFO] Suggested num_embeddings: 8023
		[INFO] Processed 168 valid samples.
		[INFO] Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_27_CASE1.csv  (shape: (168, 429))
		[INFO] Saved feature metadata: ./data/training_results/feature_info_STAFV2_27_CASE1.json
		[INFO] Dataset split: 134 train, 34 val
		[INFO] Scalers fitted and saved.

		✅ Model initialized with 715620 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train R²  |   Val R²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/1000 | 0.010000   |    9.18643   |    8.62715   |     -1.085 |     -0.766 |    0/150  
		    2/1000 | 0.010000   |    7.38198   |    8.04761   |     -0.942 |     -0.537 |    0/150  
		    3/1000 | 0.010000   |    8.09241   |    7.65517   |     -0.854 |     -0.390 |    0/150  
		    4/1000 | 0.010000   |    8.64711   |    7.49736   |     -0.796 |     -0.334 |    0/150  
		    5/1000 | 0.010000   |    8.19020   |    7.27576   |     -0.717 |     -0.256 |    0/150  
		    6/1000 | 0.010000   |    8.04472   |    7.08857   |     -0.624 |     -0.192 |    0/150  
		    7/1000 | 0.010000   |    7.29505   |    6.79292   |     -0.589 |     -0.095 |    0/150  
		    8/1000 | 0.010000   |    7.95457   |    6.71884   |     -0.498 |     -0.071 |    0/150  
		    9/1000 | 0.010000   |    8.49051   |    6.50114   |     -0.389 |     -0.003 |    0/150  
		   10/1000 | 0.010000   |    7.51779   |    6.52041   |     -0.303 |     -0.009 |    0/150  
		   11/1000 | 0.010000   |    6.46394   |    6.24783   |     -0.236 |      0.074 |    1/150  
		   12/1000 | 0.010000   |    6.80770   |    6.03064   |     -0.100 |      0.137 |    0/150  
		   13/1000 | 0.010000   |    6.72268   |    5.77483   |     -0.003 |      0.209 |    0/150  
		   14/1000 | 0.010000   |    7.36104   |    6.04590   |      0.032 |      0.133 |    0/150  
		   15/1000 | 0.010000   |    5.36252   |    6.09420   |      0.147 |      0.119 |    1/150  
		   16/1000 | 0.010000   |    5.35261   |    6.27475   |      0.240 |      0.066 |    2/150  
		   17/1000 | 0.010000   |    5.96022   |    6.48400   |      0.314 |      0.003 |    3/150  
		   18/1000 | 0.010000   |    4.83803   |    6.47017   |      0.431 |      0.007 |    4/150  
		   19/1000 | 0.010000   |    4.34041   |    6.38402   |      0.451 |      0.033 |    5/150  
		   20/1000 | 0.010000   |    3.78636   |    6.24908   |      0.544 |      0.073 |    6/150  
		   21/1000 | 0.010000   |    3.20147   |    6.06741   |      0.602 |      0.127 |    7/150  
		   22/1000 | 0.010000   |    5.32791   |    5.92842   |      0.630 |      0.166 |    8/150  
		   23/1000 | 0.010000   |    5.20957   |    5.62472   |      0.668 |      0.249 |    9/150  
		   24/1000 | 0.010000   |    2.68371   |    5.30541   |      0.698 |      0.332 |    0/150  
		   25/1000 | 0.010000   |    4.55421   |    5.17680   |      0.721 |      0.364 |    0/150  
		   26/1000 | 0.010000   |    2.70965   |    5.24584   |      0.758 |      0.347 |    0/150  
		   27/1000 | 0.010000   |    2.85410   |    5.33047   |      0.776 |      0.326 |    1/150  
		   28/1000 | 0.010000   |    2.79082   |    5.36709   |      0.772 |      0.317 |    2/150  
		   29/1000 | 0.010000   |    3.51918   |    5.47188   |      0.776 |      0.290 |    3/150  
		   30/1000 | 0.010000   |    4.98587   |    5.56015   |      0.733 |      0.267 |    4/150  
		   31/1000 | 0.010000   |    4.27347   |    5.52255   |      0.795 |      0.276 |    5/150  
		   32/1000 | 0.010000   |    3.10615   |    5.49958   |      0.772 |      0.282 |    6/150  
		   33/1000 | 0.010000   |    3.87315   |    5.50765   |      0.781 |      0.280 |    7/150  
		   34/1000 | 0.010000   |    3.07263   |    5.56051   |      0.772 |      0.266 |    8/150  
		   35/1000 | 0.010000   |    2.86592   |    5.64480   |      0.792 |      0.244 |    9/150  
		   36/1000 | 0.010000   |    4.54730   |    5.66033   |      0.789 |      0.240 |   10/150  
		   37/1000 | 0.010000   |    2.53253   |    5.63856   |      0.783 |      0.246 |   11/150  
		   38/1000 | 0.010000   |    2.49710   |    5.60182   |      0.801 |      0.255 |   12/150  
		   39/1000 | 0.010000   |    2.73822   |    5.55257   |      0.815 |      0.269 |   13/150  
		   40/1000 | 0.010000   |    2.35010   |    5.49440   |      0.814 |      0.284 |   14/150  
		   41/1000 | 0.005000   |    3.11283   |    5.43760   |      0.798 |      0.298 |   15/150  
		   42/1000 | 0.005000   |    3.88266   |    5.38932   |      0.817 |      0.311 |   16/150  
		   43/1000 | 0.005000   |    5.19929   |    5.36202   |      0.791 |      0.318 |   17/150  
		   44/1000 | 0.005000   |    4.48325   |    5.33085   |      0.809 |      0.326 |   18/150  
		   45/1000 | 0.005000   |    3.67898   |    5.25859   |      0.804 |      0.344 |   19/150  
		   46/1000 | 0.005000   |    5.29052   |    5.20466   |      0.809 |      0.357 |   20/150  
		   47/1000 | 0.005000   |    2.10251   |    5.11235   |      0.837 |      0.380 |   21/150  
		   48/1000 | 0.005000   |    2.69114   |    4.97451   |      0.843 |      0.413 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.9745)
		   49/1000 | 0.005000   |    3.24007   |    4.88575   |      0.836 |      0.434 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.8857)
		   50/1000 | 0.005000   |    2.48366   |    4.78597   |      0.840 |      0.457 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.7860)
		   51/1000 | 0.005000   |    2.83732   |    4.76162   |      0.849 |      0.462 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.7616)
		   52/1000 | 0.005000   |    2.94956   |    4.71549   |      0.854 |      0.472 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.7155)
		   53/1000 | 0.005000   |    2.59606   |    4.73930   |      0.856 |      0.467 |    0/150  
		   54/1000 | 0.005000   |    2.27760   |    4.69511   |      0.872 |      0.477 |    1/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.6951)
		   55/1000 | 0.005000   |    2.61055   |    4.64942   |      0.854 |      0.487 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.6494)
		   56/1000 | 0.005000   |    2.64171   |    4.67875   |      0.856 |      0.481 |    0/150  
		   57/1000 | 0.005000   |    6.67913   |    4.74477   |      0.790 |      0.466 |    1/150  
		   58/1000 | 0.005000   |    4.71262   |    4.73766   |      0.831 |      0.467 |    2/150  
		   59/1000 | 0.005000   |    2.07352   |    4.66405   |      0.864 |      0.484 |    3/150  
		   60/1000 | 0.005000   |    2.24054   |    4.59826   |      0.855 |      0.498 |    4/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.5983)
		   61/1000 | 0.005000   |    4.84031   |    4.54726   |      0.841 |      0.509 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.5473)
		   62/1000 | 0.005000   |    2.44500   |    4.56030   |      0.862 |      0.507 |    0/150  
		   63/1000 | 0.005000   |    2.93379   |    4.57456   |      0.857 |      0.504 |    1/150  
		   64/1000 | 0.005000   |    2.67467   |    4.56017   |      0.846 |      0.507 |    2/150  
		   65/1000 | 0.005000   |    2.06018   |    4.54743   |      0.867 |      0.509 |    3/150  
		   66/1000 | 0.005000   |    3.44210   |    4.56928   |      0.845 |      0.505 |    4/150  
		   67/1000 | 0.005000   |    2.97752   |    4.63231   |      0.847 |      0.491 |    5/150  
		   68/1000 | 0.005000   |    2.25337   |    4.64062   |      0.874 |      0.489 |    6/150  
		   69/1000 | 0.005000   |    2.45269   |    4.75092   |      0.874 |      0.464 |    7/150  
		   70/1000 | 0.005000   |    2.83404   |    4.77463   |      0.857 |      0.459 |    8/150  
		   71/1000 | 0.005000   |    3.75515   |    4.79853   |      0.854 |      0.454 |    9/150  
		   72/1000 | 0.005000   |    2.30833   |    4.82600   |      0.848 |      0.447 |   10/150  
		   73/1000 | 0.005000   |    1.85793   |    4.87298   |      0.845 |      0.437 |   11/150  
		   74/1000 | 0.005000   |    2.27125   |    4.91582   |      0.867 |      0.427 |   12/150  
		   75/1000 | 0.005000   |    2.52376   |    4.93477   |      0.869 |      0.422 |   13/150  
		   76/1000 | 0.005000   |    2.51250   |    4.98678   |      0.836 |      0.410 |   14/150  
		   77/1000 | 0.002500   |    2.69166   |    5.00172   |      0.879 |      0.406 |   15/150  
		   78/1000 | 0.002500   |    2.35846   |    5.01997   |      0.865 |      0.402 |   16/150  
		   79/1000 | 0.002500   |    3.92072   |    5.04133   |      0.854 |      0.397 |   17/150  
		   80/1000 | 0.002500   |    2.77115   |    5.01072   |      0.870 |      0.404 |   18/150  
		   81/1000 | 0.002500   |    2.17418   |    4.90672   |      0.873 |      0.429 |   19/150  
		   82/1000 | 0.002500   |    3.65203   |    4.90678   |      0.882 |      0.429 |   20/150  
		   83/1000 | 0.002500   |    2.15996   |    4.86844   |      0.867 |      0.438 |   21/150  
		   84/1000 | 0.002500   |    2.92248   |    4.87501   |      0.855 |      0.436 |   22/150  
		   85/1000 | 0.002500   |    2.27533   |    4.87880   |      0.868 |      0.435 |   23/150  
		   86/1000 | 0.002500   |    2.19119   |    4.88492   |      0.864 |      0.434 |   24/150  
		   87/1000 | 0.002500   |    2.82600   |    4.89935   |      0.892 |      0.431 |   25/150  
		   88/1000 | 0.002500   |    1.97569   |    4.91758   |      0.888 |      0.426 |   26/150  
		   89/1000 | 0.002500   |    2.53200   |    4.91757   |      0.856 |      0.426 |   27/150  
		   90/1000 | 0.002500   |    1.89217   |    4.90760   |      0.875 |      0.429 |   28/150  
		   91/1000 | 0.002500   |    3.84260   |    4.89906   |      0.857 |      0.431 |   29/150  
		   92/1000 | 0.002500   |    2.87334   |    4.92085   |      0.864 |      0.425 |   30/150  
		   93/1000 | 0.001250   |    3.78749   |    4.94112   |      0.867 |      0.421 |   31/150  
		   94/1000 | 0.001250   |    2.00594   |    4.90748   |      0.865 |      0.429 |   32/150  
		   95/1000 | 0.001250   |    2.24293   |    4.92255   |      0.871 |      0.425 |   33/150  
		   96/1000 | 0.001250   |    1.83448   |    4.93272   |      0.861 |      0.423 |   34/150  
		   97/1000 | 0.001250   |    4.47095   |    4.98999   |      0.845 |      0.409 |   35/150  
		   98/1000 | 0.001250   |    2.74660   |    4.99481   |      0.882 |      0.408 |   36/150  
		   99/1000 | 0.001250   |    3.37930   |    4.90187   |      0.857 |      0.430 |   37/150  
		  100/1000 | 0.001250   |    2.86329   |    4.86905   |      0.858 |      0.438 |   38/150  
		  101/1000 | 0.001250   |    2.60335   |    4.86695   |      0.881 |      0.438 |   39/150  
		  102/1000 | 0.001250   |    4.00938   |    4.85383   |      0.862 |      0.441 |   40/150  
		  103/1000 | 0.001250   |    3.07608   |    4.86328   |      0.886 |      0.439 |   41/150  
		  104/1000 | 0.001250   |    2.83999   |    4.85106   |      0.884 |      0.442 |   42/150  
		  105/1000 | 0.001250   |    3.05260   |    4.87946   |      0.882 |      0.435 |   43/150  
		  106/1000 | 0.001250   |    1.82443   |    4.84070   |      0.909 |      0.444 |   44/150  
		  107/1000 | 0.001250   |    2.37820   |    4.88280   |      0.877 |      0.434 |   45/150  
		  108/1000 | 0.001250   |    1.74246   |    4.83554   |      0.912 |      0.445 |   46/150  
		  109/1000 | 0.000625   |    1.97163   |    4.80228   |      0.899 |      0.453 |   47/150  
		  110/1000 | 0.000625   |    1.79435   |    4.80042   |      0.863 |      0.453 |   48/150  
		  111/1000 | 0.000625   |    2.30851   |    4.84742   |      0.884 |      0.443 |   49/150  
		  112/1000 | 0.000625   |    2.53774   |    4.79037   |      0.885 |      0.456 |   50/150  
		  113/1000 | 0.000625   |    2.25524   |    4.78638   |      0.875 |      0.456 |   51/150  
		  114/1000 | 0.000625   |    4.29679   |    4.78868   |      0.869 |      0.456 |   52/150  
		  115/1000 | 0.000625   |    2.59721   |    4.77514   |      0.910 |      0.459 |   53/150  
		  116/1000 | 0.000625   |    1.79218   |    4.77896   |      0.916 |      0.458 |   54/150  
		  117/1000 | 0.000625   |    2.98201   |    4.80578   |      0.897 |      0.452 |   55/150  
		  118/1000 | 0.000625   |    1.71573   |    4.80386   |      0.902 |      0.452 |   56/150  
		  119/1000 | 0.000625   |    2.17649   |    4.80155   |      0.883 |      0.453 |   57/150  
		  120/1000 | 0.000625   |    2.60723   |    4.81817   |      0.900 |      0.449 |   58/150  
		  121/1000 | 0.000625   |    2.12971   |    4.80459   |      0.914 |      0.452 |   59/150  
		  122/1000 | 0.000625   |    2.21381   |    4.80421   |      0.902 |      0.452 |   60/150  
		  123/1000 | 0.000625   |    2.61176   |    4.79182   |      0.876 |      0.455 |   61/150  
		  124/1000 | 0.000625   |    2.48419   |    4.80158   |      0.871 |      0.453 |   62/150  
		  125/1000 | 0.000313   |    2.03333   |    4.82630   |      0.906 |      0.447 |   63/150  
		  126/1000 | 0.000313   |    3.15987   |    4.93191   |      0.896 |      0.423 |   64/150  
		  127/1000 | 0.000313   |    2.89950   |    4.99154   |      0.891 |      0.409 |   65/150  
		  128/1000 | 0.000313   |    2.65816   |    4.97299   |      0.897 |      0.413 |   66/150  
		  129/1000 | 0.000313   |    2.85024   |    4.83567   |      0.900 |      0.445 |   67/150  
		  130/1000 | 0.000313   |    1.92459   |    4.80795   |      0.912 |      0.452 |   68/150  
		  131/1000 | 0.000313   |    2.47657   |    4.82278   |      0.883 |      0.448 |   69/150  
		  132/1000 | 0.000313   |    2.23387   |    4.78893   |      0.905 |      0.456 |   70/150  
		  133/1000 | 0.000313   |    2.74348   |    4.78825   |      0.886 |      0.456 |   71/150  
		  134/1000 | 0.000313   |    2.98768   |    4.79102   |      0.887 |      0.455 |   72/150  
		  135/1000 | 0.000313   |    1.59907   |    4.79351   |      0.902 |      0.455 |   73/150  
		  136/1000 | 0.000313   |    2.75579   |    4.79840   |      0.903 |      0.454 |   74/150  
		  137/1000 | 0.000313   |    2.10152   |    4.82541   |      0.880 |      0.448 |   75/150  
		  138/1000 | 0.000313   |    1.79434   |    4.83825   |      0.887 |      0.445 |   76/150  
		  139/1000 | 0.000313   |    2.37519   |    4.87897   |      0.896 |      0.435 |   77/150  
		  140/1000 | 0.000313   |    1.85995   |    4.84802   |      0.903 |      0.442 |   78/150  
		  141/1000 | 0.000156   |    1.53389   |    4.81922   |      0.910 |      0.449 |   79/150  
		  142/1000 | 0.000156   |    1.70165   |    4.80970   |      0.924 |      0.451 |   80/150  
		  143/1000 | 0.000156   |    2.48047   |    4.81568   |      0.896 |      0.450 |   81/150  
		  144/1000 | 0.000156   |    1.71997   |    4.82384   |      0.892 |      0.448 |   82/150  
		  145/1000 | 0.000156   |    2.46983   |    4.80525   |      0.885 |      0.452 |   83/150  
		  146/1000 | 0.000156   |    3.20603   |    4.84084   |      0.892 |      0.444 |   84/150  
		  147/1000 | 0.000156   |    2.81319   |    4.77549   |      0.890 |      0.459 |   85/150  
		  148/1000 | 0.000156   |    1.64398   |    4.76762   |      0.913 |      0.461 |   86/150  
		  149/1000 | 0.000156   |    4.17908   |    4.73179   |      0.862 |      0.469 |   87/150  
		  150/1000 | 0.000156   |    2.49152   |    4.73165   |      0.909 |      0.469 |   88/150  
		  151/1000 | 0.000156   |    2.44136   |    4.74525   |      0.884 |      0.466 |   89/150  
		  152/1000 | 0.000156   |    2.82249   |    4.82066   |      0.883 |      0.449 |   90/150  
		  153/1000 | 0.000156   |    2.18516   |    4.82426   |      0.895 |      0.448 |   91/150  
		  154/1000 | 0.000156   |    3.73777   |    4.78442   |      0.890 |      0.457 |   92/150  
		  155/1000 | 0.000156   |    2.63412   |    4.80493   |      0.896 |      0.452 |   93/150  
		  156/1000 | 0.000156   |    3.41122   |    4.76737   |      0.889 |      0.461 |   94/150  
		  157/1000 | 0.000078   |    4.19274   |    4.81692   |      0.863 |      0.450 |   95/150  
		  158/1000 | 0.000078   |    2.17716   |    4.77927   |      0.887 |      0.458 |   96/150  
		  159/1000 | 0.000078   |    3.32582   |    4.79532   |      0.882 |      0.454 |   97/150  
		  160/1000 | 0.000078   |    1.82737   |    4.76859   |      0.902 |      0.460 |   98/150  
		  161/1000 | 0.000078   |    3.31488   |    4.75593   |      0.877 |      0.463 |   99/150  
		  162/1000 | 0.000078   |    3.69301   |    4.78252   |      0.881 |      0.457 |  100/150  
		  163/1000 | 0.000078   |    1.65336   |    4.77518   |      0.924 |      0.459 |  101/150  
		  164/1000 | 0.000078   |    2.06574   |    4.77644   |      0.907 |      0.459 |  102/150  
		  165/1000 | 0.000078   |    4.52259   |    4.81061   |      0.859 |      0.451 |  103/150  
		  166/1000 | 0.000078   |    2.18230   |    4.83951   |      0.922 |      0.444 |  104/150  
		  167/1000 | 0.000078   |    2.23014   |    4.81850   |      0.899 |      0.449 |  105/150  
		  168/1000 | 0.000078   |    2.71097   |    4.79199   |      0.885 |      0.455 |  106/150  
		  169/1000 | 0.000078   |    4.05018   |    4.83442   |      0.885 |      0.445 |  107/150  
		  170/1000 | 0.000078   |    3.83826   |    4.81494   |      0.889 |      0.450 |  108/150  
		  171/1000 | 0.000078   |    4.78762   |    4.83379   |      0.882 |      0.446 |  109/150  
		  172/1000 | 0.000078   |    3.09194   |    4.79903   |      0.901 |      0.454 |  110/150  
		  173/1000 | 0.000039   |    2.04803   |    4.79174   |      0.900 |      0.455 |  111/150  
		  174/1000 | 0.000039   |    1.82157   |    4.79062   |      0.913 |      0.455 |  112/150  
		  175/1000 | 0.000039   |    4.00001   |    4.80501   |      0.899 |      0.452 |  113/150  
		  176/1000 | 0.000039   |    2.85957   |    4.85350   |      0.896 |      0.441 |  114/150  
		  177/1000 | 0.000039   |    1.83424   |    4.80604   |      0.938 |      0.452 |  115/150  
		  178/1000 | 0.000039   |    2.57999   |    4.77209   |      0.871 |      0.460 |  116/150  
		  179/1000 | 0.000039   |    2.28322   |    4.79311   |      0.921 |      0.455 |  117/150  
		  180/1000 | 0.000039   |    3.28086   |    4.79405   |      0.893 |      0.455 |  118/150  
		  181/1000 | 0.000039   |    2.67198   |    4.80095   |      0.919 |      0.453 |  119/150  
		  182/1000 | 0.000039   |    3.28537   |    4.83305   |      0.886 |      0.446 |  120/150  
		  183/1000 | 0.000039   |    1.74043   |    4.79657   |      0.896 |      0.454 |  121/150  
		  184/1000 | 0.000039   |    1.65392   |    4.79507   |      0.906 |      0.454 |  122/150  
		  185/1000 | 0.000039   |    3.28964   |    4.86272   |      0.894 |      0.439 |  123/150  
		  186/1000 | 0.000039   |    1.75263   |    4.88120   |      0.915 |      0.435 |  124/150  
		  187/1000 | 0.000039   |    4.19646   |    4.77242   |      0.865 |      0.460 |  125/150  
		  188/1000 | 0.000039   |    2.33407   |    4.76785   |      0.899 |      0.461 |  126/150  
		  189/1000 | 0.000020   |    1.74991   |    4.74944   |      0.923 |      0.465 |  127/150  
		  190/1000 | 0.000020   |    1.85686   |    4.74268   |      0.913 |      0.466 |  128/150  
		  191/1000 | 0.000020   |    1.97687   |    4.75289   |      0.912 |      0.464 |  129/150  
		  192/1000 | 0.000020   |    3.62842   |    4.77975   |      0.912 |      0.458 |  130/150  
		  193/1000 | 0.000020   |    3.07055   |    4.77669   |      0.876 |      0.459 |  131/150  
		  194/1000 | 0.000020   |    2.58057   |    4.79821   |      0.910 |      0.454 |  132/150  
		  195/1000 | 0.000020   |    2.63222   |    4.77569   |      0.912 |      0.459 |  133/150  
		  196/1000 | 0.000020   |    2.00045   |    4.77137   |      0.888 |      0.460 |  134/150  
		  197/1000 | 0.000020   |    1.93856   |    4.80589   |      0.892 |      0.452 |  135/150  
		  198/1000 | 0.000020   |    1.69642   |    4.77718   |      0.912 |      0.459 |  136/150  
		  199/1000 | 0.000020   |    1.81048   |    4.78463   |      0.903 |      0.457 |  137/150  
		  200/1000 | 0.000020   |    3.43450   |    4.73890   |      0.897 |      0.467 |  138/150  
		  201/1000 | 0.000020   |    5.38791   |    4.74538   |      0.857 |      0.466 |  139/150  
		  202/1000 | 0.000020   |    2.37441   |    4.77748   |      0.916 |      0.458 |  140/150  
		  203/1000 | 0.000020   |    2.23887   |    4.82749   |      0.897 |      0.447 |  141/150  
		  204/1000 | 0.000020   |    1.75184   |    4.77619   |      0.911 |      0.459 |  142/150  
		  205/1000 | 0.000010   |    2.48131   |    4.76628   |      0.909 |      0.461 |  143/150  
		  206/1000 | 0.000010   |    2.07034   |    4.77157   |      0.904 |      0.460 |  144/150  
		  207/1000 | 0.000010   |    4.23928   |    4.79316   |      0.886 |      0.455 |  145/150  
		  208/1000 | 0.000010   |    1.78442   |    4.75794   |      0.911 |      0.463 |  146/150  
		  209/1000 | 0.000010   |    2.76684   |    4.79137   |      0.906 |      0.455 |  147/150  
		  210/1000 | 0.000010   |    1.73069   |    4.76387   |      0.896 |      0.462 |  148/150  
		  211/1000 | 0.000010   |    5.27930   |    4.82317   |      0.870 |      0.448 |  149/150  

		Early stopping triggered.
		[INFO] Case 1 completed.

	3.2 Training Case 2...
		=== Training Log Started: 2025-11-28 22:08:52.872650 ===
		Run Name: STAFV2_27_CASE2
		Device: cuda
		Epochs: 1000, Batch Size: 128, LR: 0.01
		============================================================
		[INFO] Unique quantized indices: 24205
		[INFO] Suggested num_embeddings: 29046
		[INFO] Processed 1549 valid samples.
		[INFO] Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_27_CASE2.csv  (shape: (1549, 429))
		[INFO] Saved feature metadata: ./data/training_results/feature_info_STAFV2_27_CASE2.json
		[INFO] Dataset split: 1239 train, 310 val
		[INFO] Scalers fitted and saved.

		✅ Model initialized with 715620 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train R²  |   Val R²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/1000 | 0.010000   |    9.20088   |    7.42979   |     -1.076 |     -0.391 |    0/150  
		    2/1000 | 0.010000   |    8.20327   |    6.50417   |     -0.657 |     -0.057 |    0/150  
		    3/1000 | 0.010000   |    6.93246   |    5.80647   |     -0.182 |      0.179 |    0/150  
		    4/1000 | 0.010000   |    5.37795   |    5.24170   |      0.287 |      0.313 |    0/150  
		    5/1000 | 0.010000   |    3.95014   |    4.48789   |      0.617 |      0.518 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.4879)
		    6/1000 | 0.010000   |    3.06104   |    4.62070   |      0.772 |      0.492 |    0/150  
		    7/1000 | 0.010000   |    2.70939   |    4.51334   |      0.821 |      0.534 |    1/150  
		    8/1000 | 0.010000   |    2.67556   |    4.36290   |      0.824 |      0.555 |    2/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.3629)
		    9/1000 | 0.010000   |    2.45663   |    4.57196   |      0.851 |      0.510 |    0/150  
		   10/1000 | 0.010000   |    2.33821   |    4.64742   |      0.867 |      0.490 |    1/150  
		   11/1000 | 0.010000   |    2.29150   |    4.65425   |      0.873 |      0.502 |    2/150  
		   12/1000 | 0.010000   |    2.25307   |    4.48918   |      0.877 |      0.537 |    3/150  
		   13/1000 | 0.010000   |    2.14790   |    4.55664   |      0.886 |      0.525 |    4/150  
		   14/1000 | 0.010000   |    2.15759   |    4.61483   |      0.886 |      0.505 |    5/150  
		   15/1000 | 0.010000   |    2.20434   |    4.43258   |      0.884 |      0.537 |    6/150  
		   16/1000 | 0.010000   |    2.18523   |    4.72708   |      0.883 |      0.474 |    7/150  
		   17/1000 | 0.010000   |    2.17918   |    4.46445   |      0.884 |      0.537 |    8/150  
		   18/1000 | 0.010000   |    2.07799   |    4.38127   |      0.893 |      0.547 |    9/150  
		   19/1000 | 0.010000   |    1.86354   |    4.70556   |      0.915 |      0.486 |   10/150  
		   20/1000 | 0.010000   |    1.88662   |    4.52156   |      0.912 |      0.520 |   11/150  
		   21/1000 | 0.010000   |    1.94988   |    4.52093   |      0.910 |      0.524 |   12/150  
		   22/1000 | 0.010000   |    1.81104   |    4.57262   |      0.919 |      0.517 |   13/150  
		   23/1000 | 0.010000   |    1.77444   |    4.59703   |      0.923 |      0.514 |   14/150  
		   24/1000 | 0.010000   |    1.75642   |    4.36682   |      0.926 |      0.558 |   15/150  
		   25/1000 | 0.010000   |    1.91780   |    4.43094   |      0.910 |      0.549 |   16/150  
		   26/1000 | 0.010000   |    1.70758   |    4.37523   |      0.929 |      0.557 |   17/150  
		   27/1000 | 0.010000   |    1.71399   |    4.45696   |      0.928 |      0.536 |   18/150  
		   28/1000 | 0.010000   |    1.72205   |    4.51693   |      0.928 |      0.510 |   19/150  
		   29/1000 | 0.010000   |    1.64683   |    4.51204   |      0.933 |      0.523 |   20/150  
		   30/1000 | 0.010000   |    1.66457   |    4.42056   |      0.934 |      0.543 |   21/150  
		   31/1000 | 0.010000   |    1.75337   |    4.58563   |      0.924 |      0.512 |   22/150  
		   32/1000 | 0.010000   |    1.76577   |    4.50801   |      0.926 |      0.525 |   23/150  
		   33/1000 | 0.010000   |    1.69991   |    4.66913   |      0.929 |      0.488 |   24/150  
		   34/1000 | 0.010000   |    1.80647   |    4.49903   |      0.923 |      0.521 |   25/150  
		   35/1000 | 0.010000   |    1.72290   |    4.43513   |      0.928 |      0.536 |   26/150  
		   36/1000 | 0.010000   |    1.76999   |    4.56330   |      0.923 |      0.517 |   27/150  
		   37/1000 | 0.010000   |    1.64204   |    4.45147   |      0.934 |      0.538 |   28/150  
		   38/1000 | 0.010000   |    1.65602   |    4.56289   |      0.933 |      0.502 |   29/150  
		   39/1000 | 0.010000   |    1.81127   |    4.49592   |      0.919 |      0.525 |   30/150  
		   40/1000 | 0.005000   |    1.66766   |    4.56138   |      0.931 |      0.510 |   31/150  
		   41/1000 | 0.005000   |    1.61481   |    4.44997   |      0.937 |      0.534 |   32/150  
		   42/1000 | 0.005000   |    1.49255   |    4.55017   |      0.945 |      0.509 |   33/150  
		   43/1000 | 0.005000   |    1.44268   |    4.55375   |      0.949 |      0.509 |   34/150  
		   44/1000 | 0.005000   |    1.47763   |    4.57116   |      0.947 |      0.505 |   35/150  
		   45/1000 | 0.005000   |    1.48096   |    4.53815   |      0.946 |      0.513 |   36/150  
		   46/1000 | 0.005000   |    1.56395   |    4.48412   |      0.940 |      0.522 |   37/150  
		   47/1000 | 0.005000   |    1.45236   |    4.47982   |      0.949 |      0.522 |   38/150  
		   48/1000 | 0.005000   |    1.54494   |    4.55072   |      0.942 |      0.509 |   39/150  
		   49/1000 | 0.005000   |    1.47721   |    4.54402   |      0.946 |      0.510 |   40/150  
		   50/1000 | 0.005000   |    1.46910   |    4.53743   |      0.947 |      0.513 |   41/150  
		   51/1000 | 0.005000   |    1.50206   |    4.60168   |      0.944 |      0.500 |   42/150  
		   52/1000 | 0.005000   |    1.44780   |    4.65833   |      0.949 |      0.489 |   43/150  
		   53/1000 | 0.005000   |    1.40944   |    4.57788   |      0.951 |      0.507 |   44/150  
		   54/1000 | 0.005000   |    1.49845   |    4.53600   |      0.945 |      0.517 |   45/150  
		   55/1000 | 0.005000   |    1.49606   |    4.58554   |      0.945 |      0.506 |   46/150  
		   56/1000 | 0.002500   |    1.46173   |    4.64444   |      0.947 |      0.493 |   47/150  
		   57/1000 | 0.002500   |    1.64339   |    4.69055   |      0.935 |      0.484 |   48/150  
		   58/1000 | 0.002500   |    1.44974   |    4.65252   |      0.948 |      0.493 |   49/150  
		   59/1000 | 0.002500   |    1.52583   |    4.57584   |      0.944 |      0.508 |   50/150  
		   60/1000 | 0.002500   |    1.60321   |    4.58100   |      0.937 |      0.507 |   51/150  
		   61/1000 | 0.002500   |    1.60208   |    4.64642   |      0.937 |      0.493 |   52/150  
		   62/1000 | 0.002500   |    1.46523   |    4.63532   |      0.947 |      0.494 |   53/150  
		   63/1000 | 0.002500   |    1.51044   |    4.57061   |      0.945 |      0.509 |   54/150  
		   64/1000 | 0.002500   |    1.49784   |    4.63569   |      0.945 |      0.496 |   55/150  
		   65/1000 | 0.002500   |    1.39761   |    4.64013   |      0.952 |      0.495 |   56/150  
		   66/1000 | 0.002500   |    1.48327   |    4.62074   |      0.946 |      0.500 |   57/150  
		   67/1000 | 0.002500   |    1.44182   |    4.60113   |      0.949 |      0.503 |   58/150  
		   68/1000 | 0.002500   |    1.42000   |    4.60932   |      0.951 |      0.500 |   59/150  
		   69/1000 | 0.002500   |    1.48365   |    4.61790   |      0.946 |      0.497 |   60/150  
		   70/1000 | 0.002500   |    1.50715   |    4.63570   |      0.944 |      0.495 |   61/150  
		   71/1000 | 0.002500   |    1.52808   |    4.62149   |      0.944 |      0.498 |   62/150  
		   72/1000 | 0.001250   |    1.53058   |    4.64963   |      0.943 |      0.493 |   63/150  
		   73/1000 | 0.001250   |    1.42209   |    4.65337   |      0.951 |      0.492 |   64/150  
		   74/1000 | 0.001250   |    1.41315   |    4.63224   |      0.952 |      0.496 |   65/150  
		   75/1000 | 0.001250   |    1.43256   |    4.65200   |      0.950 |      0.492 |   66/150  
		   76/1000 | 0.001250   |    1.44511   |    4.65228   |      0.950 |      0.492 |   67/150  
		   77/1000 | 0.001250   |    1.47818   |    4.63125   |      0.946 |      0.493 |   68/150  
		   78/1000 | 0.001250   |    1.37251   |    4.63136   |      0.954 |      0.494 |   69/150  
		   79/1000 | 0.001250   |    1.48791   |    4.66142   |      0.948 |      0.489 |   70/150  
		   80/1000 | 0.001250   |    1.46267   |    4.66770   |      0.948 |      0.490 |   71/150  
		   81/1000 | 0.001250   |    1.44994   |    4.66622   |      0.948 |      0.491 |   72/150  
		   82/1000 | 0.001250   |    1.37370   |    4.67139   |      0.953 |      0.489 |   73/150  
		   83/1000 | 0.001250   |    1.39539   |    4.65258   |      0.952 |      0.493 |   74/150  
		   84/1000 | 0.001250   |    1.47890   |    4.64308   |      0.946 |      0.494 |   75/150  
		   85/1000 | 0.001250   |    1.36119   |    4.68821   |      0.955 |      0.484 |   76/150  
		   86/1000 | 0.001250   |    1.42927   |    4.70612   |      0.950 |      0.481 |   77/150  
		   87/1000 | 0.001250   |    1.35061   |    4.68445   |      0.955 |      0.485 |   78/150  
		   88/1000 | 0.000625   |    1.36372   |    4.65588   |      0.954 |      0.492 |   79/150  
		   89/1000 | 0.000625   |    1.38230   |    4.65372   |      0.953 |      0.492 |   80/150  
		   90/1000 | 0.000625   |    1.45859   |    4.65619   |      0.948 |      0.491 |   81/150  
		   91/1000 | 0.000625   |    1.35847   |    4.66540   |      0.955 |      0.489 |   82/150  
		   92/1000 | 0.000625   |    1.53733   |    4.71852   |      0.944 |      0.478 |   83/150  
		   93/1000 | 0.000625   |    1.48308   |    4.72230   |      0.948 |      0.477 |   84/150  
		   94/1000 | 0.000625   |    1.51304   |    4.70679   |      0.945 |      0.481 |   85/150  
		   95/1000 | 0.000625   |    1.46994   |    4.70053   |      0.947 |      0.482 |   86/150  
		   96/1000 | 0.000625   |    1.47705   |    4.70308   |      0.947 |      0.481 |   87/150  
		   97/1000 | 0.000625   |    1.40178   |    4.68357   |      0.952 |      0.485 |   88/150  
		   98/1000 | 0.000625   |    1.47008   |    4.65027   |      0.947 |      0.491 |   89/150  
		   99/1000 | 0.000625   |    1.45766   |    4.69725   |      0.948 |      0.481 |   90/150  
		  100/1000 | 0.000625   |    1.36967   |    4.71297   |      0.954 |      0.479 |   91/150  
		  101/1000 | 0.000625   |    1.43535   |    4.71983   |      0.949 |      0.478 |   92/150  
		  102/1000 | 0.000625   |    1.32405   |    4.70089   |      0.957 |      0.482 |   93/150  
		  103/1000 | 0.000625   |    1.37077   |    4.69623   |      0.954 |      0.483 |   94/150  
		  104/1000 | 0.000313   |    1.40222   |    4.70433   |      0.952 |      0.482 |   95/150  
		  105/1000 | 0.000313   |    1.43430   |    4.69973   |      0.950 |      0.483 |   96/150  
		  106/1000 | 0.000313   |    1.33738   |    4.68754   |      0.957 |      0.485 |   97/150  
		  107/1000 | 0.000313   |    1.40300   |    4.68144   |      0.952 |      0.487 |   98/150  
		  108/1000 | 0.000313   |    1.60233   |    4.67170   |      0.936 |      0.488 |   99/150  
		  109/1000 | 0.000313   |    1.44437   |    4.68015   |      0.949 |      0.486 |  100/150  
		  110/1000 | 0.000313   |    1.45487   |    4.68991   |      0.948 |      0.484 |  101/150  
		  111/1000 | 0.000313   |    1.36029   |    4.72001   |      0.955 |      0.478 |  102/150  
		  112/1000 | 0.000313   |    1.40342   |    4.74379   |      0.951 |      0.474 |  103/150  
		  113/1000 | 0.000313   |    1.43269   |    4.76169   |      0.950 |      0.470 |  104/150  
		  114/1000 | 0.000313   |    1.39549   |    4.71483   |      0.953 |      0.480 |  105/150  
		  115/1000 | 0.000313   |    1.45214   |    4.70710   |      0.948 |      0.481 |  106/150  
		  116/1000 | 0.000313   |    1.36231   |    4.71315   |      0.954 |      0.479 |  107/150  
		  117/1000 | 0.000313   |    1.30810   |    4.72228   |      0.958 |      0.478 |  108/150  
		  118/1000 | 0.000313   |    1.53032   |    4.71400   |      0.943 |      0.479 |  109/150  
		  119/1000 | 0.000313   |    1.31606   |    4.70964   |      0.959 |      0.480 |  110/150  
		  120/1000 | 0.000156   |    1.39024   |    4.71989   |      0.953 |      0.477 |  111/150  
		  121/1000 | 0.000156   |    1.31109   |    4.73949   |      0.958 |      0.474 |  112/150  
		  122/1000 | 0.000156   |    1.43437   |    4.73121   |      0.950 |      0.475 |  113/150  
		  123/1000 | 0.000156   |    1.40202   |    4.73440   |      0.952 |      0.475 |  114/150  
		  124/1000 | 0.000156   |    1.39383   |    4.73702   |      0.952 |      0.474 |  115/150  
		  125/1000 | 0.000156   |    1.49047   |    4.71481   |      0.946 |      0.479 |  116/150  
		  126/1000 | 0.000156   |    1.39276   |    4.72386   |      0.953 |      0.477 |  117/150  
		  127/1000 | 0.000156   |    1.42346   |    4.71191   |      0.950 |      0.479 |  118/150  
		  128/1000 | 0.000156   |    1.43684   |    4.73088   |      0.949 |      0.476 |  119/150  
		  129/1000 | 0.000156   |    1.37269   |    4.72339   |      0.954 |      0.477 |  120/150  
		  130/1000 | 0.000156   |    1.42079   |    4.72323   |      0.951 |      0.477 |  121/150  
		  131/1000 | 0.000156   |    1.39557   |    4.71684   |      0.952 |      0.479 |  122/150  
		  132/1000 | 0.000156   |    1.46397   |    4.71893   |      0.947 |      0.478 |  123/150  
		  133/1000 | 0.000156   |    1.54320   |    4.71323   |      0.941 |      0.479 |  124/150  
		  134/1000 | 0.000156   |    1.36903   |    4.72129   |      0.954 |      0.478 |  125/150  
		  135/1000 | 0.000156   |    1.54938   |    4.70095   |      0.942 |      0.482 |  126/150  
		  136/1000 | 0.000078   |    1.47855   |    4.69514   |      0.948 |      0.483 |  127/150  
		  137/1000 | 0.000078   |    1.40976   |    4.69880   |      0.952 |      0.482 |  128/150  
		  138/1000 | 0.000078   |    1.46307   |    4.71951   |      0.947 |      0.478 |  129/150  
		  139/1000 | 0.000078   |    1.32655   |    4.72636   |      0.957 |      0.477 |  130/150  
		  140/1000 | 0.000078   |    1.28688   |    4.72184   |      0.959 |      0.478 |  131/150  
		  141/1000 | 0.000078   |    1.44944   |    4.73752   |      0.949 |      0.475 |  132/150  
		  142/1000 | 0.000078   |    1.51156   |    4.72590   |      0.943 |      0.477 |  133/150  
		  143/1000 | 0.000078   |    1.32931   |    4.74085   |      0.957 |      0.474 |  134/150  
		  144/1000 | 0.000078   |    1.39580   |    4.75730   |      0.954 |      0.470 |  135/150  
		  145/1000 | 0.000078   |    1.53976   |    4.70125   |      0.943 |      0.482 |  136/150  
		  146/1000 | 0.000078   |    1.34277   |    4.71539   |      0.956 |      0.479 |  137/150  
		  147/1000 | 0.000078   |    1.41470   |    4.75609   |      0.951 |      0.470 |  138/150  
		  148/1000 | 0.000078   |    1.39994   |    4.72656   |      0.953 |      0.476 |  139/150  
		  149/1000 | 0.000078   |    1.48070   |    4.72983   |      0.946 |      0.476 |  140/150  
		  150/1000 | 0.000078   |    1.47578   |    4.72021   |      0.947 |      0.478 |  141/150  
		  151/1000 | 0.000078   |    1.49420   |    4.73186   |      0.945 |      0.475 |  142/150  
		  152/1000 | 0.000039   |    1.25824   |    4.74200   |      0.962 |      0.473 |  143/150  
		  153/1000 | 0.000039   |    1.41106   |    4.73136   |      0.951 |      0.475 |  144/150  
		  154/1000 | 0.000039   |    1.36714   |    4.73861   |      0.954 |      0.474 |  145/150  
		  155/1000 | 0.000039   |    1.50733   |    4.73418   |      0.944 |      0.475 |  146/150  
		  156/1000 | 0.000039   |    1.38348   |    4.72918   |      0.953 |      0.476 |  147/150  
		  157/1000 | 0.000039   |    1.39572   |    4.74077   |      0.952 |      0.474 |  148/150  
		  158/1000 | 0.000039   |    1.43419   |    4.72918   |      0.950 |      0.476 |  149/150  

		Early stopping triggered.
		[INFO] Case 2 completed.

	3.3 Training Case 3...
		=== Training Log Started: 2025-11-28 22:12:09.059544 ===
		Run Name: STAFV2_27_CASE3
		Device: cuda
		Epochs: 1000, Batch Size: 128, LR: 0.01
		============================================================
		[INFO] Unique quantized indices: 36561
		[INFO] Suggested num_embeddings: 43873
		[INFO] Processed 3549 valid samples.
		[INFO] Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_27_CASE3.csv  (shape: (3549, 429))
		[INFO] Saved feature metadata: ./data/training_results/feature_info_STAFV2_27_CASE3.json
		[INFO] Dataset split: 2839 train, 710 val
		[INFO] Scalers fitted and saved.

		✅ Model initialized with 715620 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train R²  |   Val R²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/1000 | 0.010000   |    8.30868   |    6.33694   |     -0.761 |      0.044 |    0/150  
		    2/1000 | 0.010000   |    5.78011   |    5.20023   |      0.157 |      0.348 |    0/150  
		    3/1000 | 0.010000   |    3.84031   |    4.87488   |      0.622 |      0.429 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.8749)
		    4/1000 | 0.010000   |    3.39657   |    4.72156   |      0.715 |      0.465 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.7216)
		    5/1000 | 0.010000   |    3.07567   |    4.73571   |      0.772 |      0.459 |    0/150  
		    6/1000 | 0.010000   |    2.78554   |    4.76144   |      0.816 |      0.454 |    1/150  
		    7/1000 | 0.010000   |    2.55695   |    4.67245   |      0.838 |      0.476 |    2/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.6724)
		    8/1000 | 0.010000   |    2.30500   |    4.68775   |      0.869 |      0.476 |    0/150  
		    9/1000 | 0.010000   |    2.34393   |    4.90225   |      0.871 |      0.427 |    1/150  
		   10/1000 | 0.010000   |    2.27514   |    4.77256   |      0.879 |      0.458 |    2/150  
		   11/1000 | 0.010000   |    2.19908   |    4.90337   |      0.880 |      0.430 |    3/150  
		   12/1000 | 0.010000   |    2.10169   |    4.84906   |      0.892 |      0.442 |    4/150  
		   13/1000 | 0.010000   |    2.02774   |    4.82474   |      0.896 |      0.448 |    5/150  
		   14/1000 | 0.010000   |    1.97143   |    4.78772   |      0.902 |      0.455 |    6/150  
		   15/1000 | 0.010000   |    1.93065   |    4.78709   |      0.909 |      0.453 |    7/150  
		   16/1000 | 0.010000   |    1.84714   |    4.75430   |      0.913 |      0.464 |    8/150  
		   17/1000 | 0.010000   |    1.82605   |    4.70872   |      0.916 |      0.471 |    9/150  
		   18/1000 | 0.010000   |    1.84268   |    4.62901   |      0.917 |      0.485 |   10/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.6290)
		   19/1000 | 0.010000   |    1.88052   |    4.75788   |      0.916 |      0.457 |    0/150  
		   20/1000 | 0.010000   |    1.93855   |    4.69422   |      0.913 |      0.471 |    1/150  
		   21/1000 | 0.010000   |    1.97245   |    4.79920   |      0.905 |      0.451 |    2/150  
		   22/1000 | 0.010000   |    1.90662   |    4.74337   |      0.908 |      0.462 |    3/150  
		   23/1000 | 0.010000   |    1.84427   |    4.73658   |      0.916 |      0.462 |    4/150  
		   24/1000 | 0.010000   |    1.82217   |    4.94354   |      0.917 |      0.419 |    5/150  
		   25/1000 | 0.010000   |    1.81062   |    4.89112   |      0.920 |      0.425 |    6/150  
		   26/1000 | 0.010000   |    1.77180   |    4.89681   |      0.925 |      0.427 |    7/150  
		   27/1000 | 0.010000   |    1.83678   |    4.87958   |      0.918 |      0.432 |    8/150  
		   28/1000 | 0.010000   |    1.77888   |    4.77751   |      0.923 |      0.460 |    9/150  
		   29/1000 | 0.010000   |    1.74337   |    5.06987   |      0.924 |      0.393 |   10/150  
		   30/1000 | 0.010000   |    1.71871   |    4.73304   |      0.928 |      0.470 |   11/150  
		   31/1000 | 0.010000   |    1.75856   |    4.88805   |      0.922 |      0.437 |   12/150  
		   32/1000 | 0.010000   |    1.67948   |    4.73753   |      0.930 |      0.467 |   13/150  
		   33/1000 | 0.010000   |    1.71148   |    4.84301   |      0.930 |      0.443 |   14/150  
		   34/1000 | 0.005000   |    1.77894   |    4.77679   |      0.921 |      0.452 |   15/150  
		   35/1000 | 0.005000   |    1.65477   |    4.78906   |      0.933 |      0.452 |   16/150  
		   36/1000 | 0.005000   |    1.59057   |    4.78110   |      0.938 |      0.452 |   17/150  
		   37/1000 | 0.005000   |    1.66006   |    4.74912   |      0.935 |      0.459 |   18/150  
		   38/1000 | 0.005000   |    1.62915   |    4.84258   |      0.938 |      0.440 |   19/150  
		   39/1000 | 0.005000   |    1.63013   |    4.72672   |      0.938 |      0.464 |   20/150  
		   40/1000 | 0.005000   |    1.57924   |    4.82735   |      0.938 |      0.443 |   21/150  
		   41/1000 | 0.005000   |    1.59535   |    4.80263   |      0.939 |      0.448 |   22/150  
		   42/1000 | 0.005000   |    1.50089   |    4.81833   |      0.943 |      0.445 |   23/150  
		   43/1000 | 0.005000   |    1.57604   |    4.83095   |      0.938 |      0.443 |   24/150  
		   44/1000 | 0.005000   |    1.59074   |    4.82037   |      0.937 |      0.446 |   25/150  
		   45/1000 | 0.005000   |    1.44551   |    4.89342   |      0.947 |      0.430 |   26/150  
		   46/1000 | 0.005000   |    1.51930   |    4.90743   |      0.942 |      0.426 |   27/150  
		   47/1000 | 0.005000   |    1.52416   |    4.86077   |      0.941 |      0.434 |   28/150  
		   48/1000 | 0.005000   |    1.59126   |    4.91840   |      0.936 |      0.424 |   29/150  
		   49/1000 | 0.005000   |    1.63459   |    4.88704   |      0.932 |      0.432 |   30/150  
		   50/1000 | 0.002500   |    1.60707   |    4.92193   |      0.939 |      0.425 |   31/150  
		   51/1000 | 0.002500   |    1.56282   |    4.81139   |      0.940 |      0.450 |   32/150  
		   52/1000 | 0.002500   |    1.58144   |    4.87950   |      0.938 |      0.435 |   33/150  
		   53/1000 | 0.002500   |    1.62718   |    4.95307   |      0.946 |      0.418 |   34/150  
		   54/1000 | 0.002500   |    1.53266   |    4.91462   |      0.940 |      0.428 |   35/150  
		   55/1000 | 0.002500   |    1.49145   |    4.90825   |      0.945 |      0.428 |   36/150  
		   56/1000 | 0.002500   |    1.53365   |    4.89637   |      0.942 |      0.430 |   37/150  
		   57/1000 | 0.002500   |    1.47682   |    4.97248   |      0.947 |      0.412 |   38/150  
		   58/1000 | 0.002500   |    1.49920   |    4.95262   |      0.945 |      0.418 |   39/150  
		   59/1000 | 0.002500   |    1.68200   |    4.87776   |      0.940 |      0.434 |   40/150  
		   60/1000 | 0.002500   |    1.50904   |    4.93787   |      0.944 |      0.420 |   41/150  
		   61/1000 | 0.002500   |    1.44364   |    4.86574   |      0.950 |      0.436 |   42/150  
		   62/1000 | 0.002500   |    1.45440   |    4.91435   |      0.947 |      0.426 |   43/150  
		   63/1000 | 0.002500   |    1.41479   |    4.92291   |      0.950 |      0.423 |   44/150  
		   64/1000 | 0.002500   |    1.43251   |    5.00717   |      0.950 |      0.405 |   45/150  
		   65/1000 | 0.002500   |    1.51096   |    4.90550   |      0.944 |      0.429 |   46/150  
		   66/1000 | 0.001250   |    1.48120   |    4.89058   |      0.947 |      0.433 |   47/150  
		   67/1000 | 0.001250   |    1.56619   |    4.86749   |      0.942 |      0.437 |   48/150  
		   68/1000 | 0.001250   |    1.40651   |    4.87198   |      0.950 |      0.436 |   49/150  
		   69/1000 | 0.001250   |    1.46213   |    4.92446   |      0.948 |      0.423 |   50/150  
		   70/1000 | 0.001250   |    1.46951   |    4.89162   |      0.950 |      0.431 |   51/150  
		   71/1000 | 0.001250   |    1.54422   |    4.89328   |      0.943 |      0.432 |   52/150  
		   72/1000 | 0.001250   |    1.40878   |    4.92334   |      0.952 |      0.424 |   53/150  
		   73/1000 | 0.001250   |    1.46286   |    4.91976   |      0.951 |      0.425 |   54/150  
		   74/1000 | 0.001250   |    1.47804   |    4.90133   |      0.948 |      0.431 |   55/150  
		   75/1000 | 0.001250   |    1.50899   |    4.84692   |      0.943 |      0.441 |   56/150  
		   76/1000 | 0.001250   |    1.37724   |    4.85585   |      0.952 |      0.440 |   57/150  
		   77/1000 | 0.001250   |    1.45755   |    4.91756   |      0.950 |      0.426 |   58/150  
		   78/1000 | 0.001250   |    1.52747   |    4.91001   |      0.946 |      0.428 |   59/150  
		   79/1000 | 0.001250   |    1.34989   |    4.91728   |      0.954 |      0.426 |   60/150  
		   80/1000 | 0.001250   |    1.53248   |    4.92571   |      0.943 |      0.423 |   61/150  
		   81/1000 | 0.001250   |    1.55713   |    4.83485   |      0.942 |      0.442 |   62/150  
		   82/1000 | 0.000625   |    1.43887   |    4.93986   |      0.948 |      0.419 |   63/150  
		   83/1000 | 0.000625   |    1.42203   |    4.91791   |      0.949 |      0.425 |   64/150  
		   84/1000 | 0.000625   |    1.41511   |    4.88536   |      0.952 |      0.432 |   65/150  
		   85/1000 | 0.000625   |    1.42004   |    4.86495   |      0.949 |      0.437 |   66/150  
		   86/1000 | 0.000625   |    1.46979   |    4.87137   |      0.947 |      0.434 |   67/150  
		   87/1000 | 0.000625   |    1.49117   |    4.84821   |      0.952 |      0.440 |   68/150  
		   88/1000 | 0.000625   |    1.42401   |    4.90764   |      0.950 |      0.425 |   69/150  
		   89/1000 | 0.000625   |    1.46679   |    4.90846   |      0.946 |      0.426 |   70/150  
		   90/1000 | 0.000625   |    1.45725   |    4.90105   |      0.948 |      0.428 |   71/150  
		   91/1000 | 0.000625   |    1.40648   |    4.88728   |      0.950 |      0.430 |   72/150  
		   92/1000 | 0.000625   |    1.37938   |    4.87724   |      0.953 |      0.432 |   73/150  
		   93/1000 | 0.000625   |    1.41929   |    4.90071   |      0.950 |      0.428 |   74/150  
		   94/1000 | 0.000625   |    1.45078   |    4.90674   |      0.950 |      0.426 |   75/150  
		   95/1000 | 0.000625   |    1.36148   |    4.87629   |      0.954 |      0.432 |   76/150  
		   96/1000 | 0.000625   |    1.36416   |    4.89281   |      0.953 |      0.429 |   77/150  
		   97/1000 | 0.000625   |    1.37577   |    4.90348   |      0.955 |      0.428 |   78/150  
		   98/1000 | 0.000313   |    1.40439   |    4.95700   |      0.952 |      0.416 |   79/150  
		   99/1000 | 0.000313   |    1.35567   |    4.97276   |      0.954 |      0.412 |   80/150  
		  100/1000 | 0.000313   |    1.44977   |    4.95205   |      0.947 |      0.417 |   81/150  
		  101/1000 | 0.000313   |    1.44351   |    4.91383   |      0.948 |      0.425 |   82/150  
		  102/1000 | 0.000313   |    1.46955   |    4.91681   |      0.949 |      0.425 |   83/150  
		  103/1000 | 0.000313   |    1.58040   |    4.94710   |      0.948 |      0.416 |   84/150  
		  104/1000 | 0.000313   |    1.41122   |    4.96386   |      0.950 |      0.413 |   85/150  
		  105/1000 | 0.000313   |    1.40479   |    4.90993   |      0.952 |      0.426 |   86/150  
		  106/1000 | 0.000313   |    1.42168   |    4.93528   |      0.950 |      0.420 |   87/150  
		  107/1000 | 0.000313   |    1.53582   |    4.89264   |      0.952 |      0.430 |   88/150  
		  108/1000 | 0.000313   |    1.39372   |    4.93029   |      0.953 |      0.421 |   89/150  
		  109/1000 | 0.000313   |    1.42948   |    4.95359   |      0.950 |      0.416 |   90/150  
		  110/1000 | 0.000313   |    1.38962   |    4.92613   |      0.952 |      0.423 |   91/150  
		  111/1000 | 0.000313   |    1.51164   |    4.94843   |      0.950 |      0.417 |   92/150  
		  112/1000 | 0.000313   |    1.42240   |    4.91734   |      0.950 |      0.424 |   93/150  
		  113/1000 | 0.000313   |    1.38621   |    4.93635   |      0.953 |      0.420 |   94/150  
		  114/1000 | 0.000156   |    1.43519   |    4.97928   |      0.955 |      0.410 |   95/150  
		  115/1000 | 0.000156   |    1.41766   |    4.96961   |      0.950 |      0.413 |   96/150  
		  116/1000 | 0.000156   |    1.42336   |    4.94747   |      0.951 |      0.418 |   97/150  
		  117/1000 | 0.000156   |    1.44502   |    4.95367   |      0.947 |      0.416 |   98/150  
		  118/1000 | 0.000156   |    1.36242   |    4.96490   |      0.954 |      0.413 |   99/150  
		  119/1000 | 0.000156   |    1.39039   |    4.95898   |      0.951 |      0.415 |  100/150  
		  120/1000 | 0.000156   |    1.28926   |    4.95086   |      0.959 |      0.417 |  101/150  
		  121/1000 | 0.000156   |    1.42211   |    4.99371   |      0.951 |      0.406 |  102/150  
		  122/1000 | 0.000156   |    1.41801   |    4.94470   |      0.950 |      0.418 |  103/150  
		  123/1000 | 0.000156   |    1.40469   |    4.94739   |      0.952 |      0.417 |  104/150  
		  124/1000 | 0.000156   |    1.47213   |    4.97028   |      0.948 |      0.412 |  105/150  
		  125/1000 | 0.000156   |    1.34763   |    4.97233   |      0.955 |      0.412 |  106/150  
		  126/1000 | 0.000156   |    1.42861   |    4.96860   |      0.951 |      0.412 |  107/150  
		  127/1000 | 0.000156   |    1.47320   |    4.95092   |      0.948 |      0.417 |  108/150  
		  128/1000 | 0.000156   |    1.57577   |    4.98611   |      0.948 |      0.408 |  109/150  
		  129/1000 | 0.000156   |    1.38006   |    4.92533   |      0.952 |      0.423 |  110/150  
		  130/1000 | 0.000078   |    1.37217   |    4.94409   |      0.954 |      0.419 |  111/150  
		  131/1000 | 0.000078   |    1.54905   |    4.91178   |      0.946 |      0.427 |  112/150  
		  132/1000 | 0.000078   |    1.44507   |    4.93418   |      0.951 |      0.421 |  113/150  
		  133/1000 | 0.000078   |    1.43677   |    4.94675   |      0.948 |      0.418 |  114/150  
		  134/1000 | 0.000078   |    1.49211   |    4.94081   |      0.950 |      0.420 |  115/150  
		  135/1000 | 0.000078   |    1.39661   |    4.95359   |      0.951 |      0.417 |  116/150  
		  136/1000 | 0.000078   |    1.42742   |    4.93479   |      0.950 |      0.421 |  117/150  
		  137/1000 | 0.000078   |    1.37988   |    4.94114   |      0.952 |      0.420 |  118/150  
		  138/1000 | 0.000078   |    1.44663   |    4.95573   |      0.948 |      0.416 |  119/150  
		  139/1000 | 0.000078   |    1.46731   |    4.92830   |      0.949 |      0.423 |  120/150  
		  140/1000 | 0.000078   |    1.42055   |    4.93497   |      0.949 |      0.421 |  121/150  
		  141/1000 | 0.000078   |    1.52501   |    4.94794   |      0.947 |      0.418 |  122/150  
		  142/1000 | 0.000078   |    1.37704   |    4.93855   |      0.954 |      0.420 |  123/150  
		  143/1000 | 0.000078   |    1.35690   |    4.92895   |      0.954 |      0.422 |  124/150  
		  144/1000 | 0.000078   |    1.35640   |    4.95993   |      0.955 |      0.415 |  125/150  
		  145/1000 | 0.000078   |    1.39020   |    4.93588   |      0.953 |      0.420 |  126/150  
		  146/1000 | 0.000039   |    1.33264   |    4.93932   |      0.957 |      0.420 |  127/150  
		  147/1000 | 0.000039   |    1.41965   |    4.93257   |      0.952 |      0.422 |  128/150  
		  148/1000 | 0.000039   |    1.38804   |    4.94920   |      0.952 |      0.418 |  129/150  
		  149/1000 | 0.000039   |    1.37909   |    4.92359   |      0.955 |      0.424 |  130/150  
		  150/1000 | 0.000039   |    1.36449   |    4.92611   |      0.954 |      0.423 |  131/150  
		  151/1000 | 0.000039   |    1.54027   |    4.96314   |      0.951 |      0.414 |  132/150  
		  152/1000 | 0.000039   |    1.40623   |    4.93597   |      0.950 |      0.421 |  133/150  
		  153/1000 | 0.000039   |    1.40760   |    4.92865   |      0.951 |      0.423 |  134/150  
		  154/1000 | 0.000039   |    1.42097   |    4.91817   |      0.950 |      0.424 |  135/150  
		  155/1000 | 0.000039   |    1.30714   |    4.93862   |      0.957 |      0.420 |  136/150  
		  156/1000 | 0.000039   |    1.32791   |    4.94374   |      0.957 |      0.419 |  137/150  
		  157/1000 | 0.000039   |    1.45537   |    4.96444   |      0.951 |      0.414 |  138/150  
		  158/1000 | 0.000039   |    1.41295   |    4.93842   |      0.952 |      0.420 |  139/150  
		  159/1000 | 0.000039   |    1.30220   |    4.91160   |      0.957 |      0.427 |  140/150  
		  160/1000 | 0.000039   |    1.43871   |    4.94140   |      0.948 |      0.420 |  141/150  
		  161/1000 | 0.000039   |    1.48722   |    4.93442   |      0.944 |      0.421 |  142/150  
		  162/1000 | 0.000020   |    1.50985   |    4.93772   |      0.951 |      0.421 |  143/150  
		  163/1000 | 0.000020   |    1.32741   |    4.94019   |      0.955 |      0.420 |  144/150  
		  164/1000 | 0.000020   |    1.37765   |    4.93256   |      0.953 |      0.421 |  145/150  
		  165/1000 | 0.000020   |    1.40070   |    4.95019   |      0.951 |      0.417 |  146/150  
		  166/1000 | 0.000020   |    1.38934   |    4.95433   |      0.953 |      0.416 |  147/150  
		  167/1000 | 0.000020   |    1.40227   |    4.94159   |      0.951 |      0.419 |  148/150  
		  168/1000 | 0.000020   |    1.33838   |    4.95783   |      0.956 |      0.415 |  149/150  

		Early stopping triggered.
		[INFO] Case 3 completed.
