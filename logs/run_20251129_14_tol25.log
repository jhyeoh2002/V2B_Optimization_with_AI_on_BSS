Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at './data/battery_demand/tol25/resample_full.csv' and './data/battery_demand/tol25/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1377, 37)
		[INFO] Number of seeds ready for Case 3  = (2000, 36)

		[INFO] Case 1 exists — loaded battery demand from './data/battery_demand/tol25/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists — loaded battery demand from './data/battery_demand/tol25/case2_nan_filled/battery_demand.npy' with shape (1545, 37).
		[INFO] Case 3 exists — loaded battery demand from './data/battery_demand/tol25/case3_extended_generated/battery_demand.npy' with shape (3545, 37).
		[INFO] Case 0: Successfully added test pair 2024-03-15 & 2024-03-16
		Data: [10536, 28, 30, 35, 37, 37, 36, 33, 26, 10, 6, 10, 14, 19, 18, 15, 20, 26, 15, 9, 16, 21, 20, 8, 12, 15, 24, 31, 35, 32, 35, 34, 32, 31, 30, 22, 14, 18, 27, 18, 19, 19, 25, 25, 25, 26, 27, 17, 19]
		[INFO] Case 0: Successfully added test pair 2024-03-29 & 2024-03-30
		Data: [10872, 13, 26, 31, 33, 33, 33, 31, 15, 8, 19, 11, 15, 18, 16, 18, 18, 19, 7, 4, 23, 23, 16, 17, 18, 18, 19, 24, 29, 30, 30, 22, 27, 21, 14, 15, 16, 20, 18, 23, 27, 18, 2, 10, 23, 22, 22, 17, 21]

	1.6 Generating battery schedule...
		[INFO] Case 1 exists — loaded from './data/battery_demand/tol25/case1_real_only/battery_availability.npy' and './data/battery_demand/tol25/case1_real_only/battery_details.npy' shape (168, 263, 36) and (4, 168, 263)
		[INFO] Case 2 exists — loaded from './data/battery_demand/tol25/case2_nan_filled/battery_availability.npy' and './data/battery_demand/tol25/case2_nan_filled/battery_details.npy' shape (1545, 311, 36) and (4, 1545, 311)
		[INFO] Case 3 exists — loaded from './data/battery_demand/tol25/case3_extended_generated/battery_availability.npy' and './data/battery_demand/tol25/case3_extended_generated/battery_details.npy' shape (3545, 422, 36) and (4, 3545, 422)


==================================================
PART 2: MILP Optimization...
==================================================

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from './data/battery_demand/tol25/case1_real_only'
		[INFO] Results already exist at './data/optimization_results/tol25/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol25/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1545 samples from './data/battery_demand/tol25/case2_nan_filled'
		[INFO] Results already exist at './data/optimization_results/tol25/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol25/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 2 completed.

	2.3 Optimizing Case 3...
		[INFO] Loaded 3545 samples from './data/battery_demand/tol25/case3_extended_generated'
		[INFO] Results already exist at './data/optimization_results/tol25/case3_extended_generated/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol25/case3_extended_generated/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 3 completed.


==================================================
PART 3: Supervised Learning...
==================================================

	3.1 Training Case 1...
		=== Training Log Started: 2025-11-29 14:30:26.654437 ===
		Run Name: STAFV2_25_CASE1
		Device: cuda
		Epochs: 1000, Batch Size: 128, LR: 0.01
		============================================================
		[INFO] Unique quantized indices: 6686
		[INFO] Suggested num_embeddings: 8023
		[INFO] Processed 168 valid samples.
		[INFO] Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_25_CASE1.csv  (shape: (168, 429))
		[INFO] Saved feature metadata: ./data/training_results/feature_info_STAFV2_25_CASE1.json
		[INFO] Dataset split: 134 train, 34 val
		[INFO] Scalers fitted and saved.

		✅ Model initialized with 714970 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train R²  |   Val R²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/1000 | 0.010000   |    7.76944   |    9.40121   |     -1.152 |     -1.092 |    0/150  
		    2/1000 | 0.010000   |    8.65958   |    9.16232   |     -1.007 |     -0.987 |    0/150  
		    3/1000 | 0.010000   |    7.42448   |    8.96293   |     -0.891 |     -0.901 |    0/150  
		    4/1000 | 0.010000   |    8.16045   |    8.69342   |     -0.793 |     -0.789 |    0/150  
		    5/1000 | 0.010000   |    7.91202   |    8.23452   |     -0.694 |     -0.605 |    0/150  
		    6/1000 | 0.010000   |    8.18140   |    7.65750   |     -0.623 |     -0.388 |    0/150  
		    7/1000 | 0.010000   |    6.56422   |    7.10427   |     -0.555 |     -0.195 |    0/150  
		    8/1000 | 0.010000   |    8.54101   |    7.09460   |     -0.419 |     -0.191 |    0/150  
		    9/1000 | 0.010000   |    7.91981   |    7.07070   |     -0.345 |     -0.183 |    0/150  
		   10/1000 | 0.010000   |    7.89563   |    7.07630   |     -0.233 |     -0.185 |    0/150  
		   11/1000 | 0.010000   |    6.10133   |    6.83625   |     -0.100 |     -0.106 |    1/150  
		   12/1000 | 0.010000   |    6.14098   |    6.73314   |      0.021 |     -0.073 |    0/150  
		   13/1000 | 0.010000   |    5.61866   |    6.47863   |      0.111 |      0.007 |    0/150  
		   14/1000 | 0.010000   |    5.10383   |    6.30236   |      0.203 |      0.060 |    0/150  
		   15/1000 | 0.010000   |    5.21343   |    6.20091   |      0.254 |      0.090 |    0/150  
		   16/1000 | 0.010000   |    4.87410   |    6.08584   |      0.372 |      0.123 |    0/150  
		   17/1000 | 0.010000   |    4.31334   |    6.05512   |      0.462 |      0.132 |    0/150  
		   18/1000 | 0.010000   |    4.35801   |    6.23572   |      0.502 |      0.080 |    0/150  
		   19/1000 | 0.010000   |    5.51623   |    6.16172   |      0.553 |      0.101 |    1/150  
		   20/1000 | 0.010000   |    5.04173   |    6.19840   |      0.636 |      0.091 |    2/150  
		   21/1000 | 0.010000   |    3.45812   |    5.82563   |      0.688 |      0.197 |    3/150  
		   22/1000 | 0.010000   |    3.22907   |    5.84737   |      0.752 |      0.191 |    0/150  
		   23/1000 | 0.010000   |    2.68613   |    5.69300   |      0.736 |      0.233 |    1/150  
		   24/1000 | 0.010000   |    2.49988   |    5.55581   |      0.775 |      0.269 |    0/150  
		   25/1000 | 0.010000   |    4.07847   |    5.46129   |      0.755 |      0.294 |    0/150  
		   26/1000 | 0.010000   |    3.39677   |    5.46746   |      0.816 |      0.292 |    0/150  
		   27/1000 | 0.010000   |    3.64606   |    5.50219   |      0.814 |      0.283 |    1/150  
		   28/1000 | 0.010000   |    2.83437   |    5.35938   |      0.853 |      0.320 |    2/150  
		   29/1000 | 0.010000   |    1.84117   |    5.39790   |      0.867 |      0.310 |    0/150  
		   30/1000 | 0.010000   |    1.88387   |    5.34894   |      0.848 |      0.323 |    1/150  
		   31/1000 | 0.010000   |    2.95199   |    5.37879   |      0.823 |      0.315 |    0/150  
		   32/1000 | 0.010000   |    1.90905   |    5.33744   |      0.870 |      0.326 |    1/150  
		   33/1000 | 0.010000   |    3.44166   |    5.15373   |      0.846 |      0.371 |    0/150  
		   34/1000 | 0.010000   |    4.55880   |    5.13404   |      0.865 |      0.376 |    0/150  
		   35/1000 | 0.010000   |    2.79841   |    5.16164   |      0.868 |      0.369 |    0/150  
		   36/1000 | 0.010000   |    3.08631   |    4.97300   |      0.852 |      0.415 |    1/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.9730)
		   37/1000 | 0.010000   |    2.16563   |    4.87785   |      0.857 |      0.437 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.8779)
		   38/1000 | 0.010000   |    1.71996   |    4.89819   |      0.880 |      0.432 |    0/150  
		   39/1000 | 0.010000   |    2.71776   |    4.90656   |      0.838 |      0.430 |    1/150  
		   40/1000 | 0.010000   |    2.98816   |    4.84790   |      0.859 |      0.444 |    2/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.8479)
		   41/1000 | 0.010000   |    6.68359   |    4.98620   |      0.752 |      0.412 |    0/150  
		   42/1000 | 0.010000   |    5.86749   |    5.02940   |      0.799 |      0.401 |    1/150  
		   43/1000 | 0.010000   |    2.75670   |    5.04901   |      0.850 |      0.397 |    2/150  
		   44/1000 | 0.010000   |    2.30574   |    5.08050   |      0.803 |      0.389 |    3/150  
		   45/1000 | 0.010000   |    2.97363   |    5.06890   |      0.806 |      0.392 |    4/150  
		   46/1000 | 0.010000   |    2.01401   |    5.12452   |      0.827 |      0.378 |    5/150  
		   47/1000 | 0.010000   |    3.03127   |    5.07760   |      0.820 |      0.390 |    6/150  
		   48/1000 | 0.010000   |    3.80360   |    5.16312   |      0.831 |      0.369 |    7/150  
		   49/1000 | 0.010000   |    2.95014   |    5.10149   |      0.847 |      0.384 |    8/150  
		   50/1000 | 0.010000   |    3.36249   |    5.31516   |      0.856 |      0.331 |    9/150  
		   51/1000 | 0.010000   |    2.88205   |    5.72928   |      0.856 |      0.223 |   10/150  
		   52/1000 | 0.010000   |    2.68758   |    5.94024   |      0.838 |      0.165 |   11/150  
		   53/1000 | 0.010000   |    3.37798   |    5.99350   |      0.857 |      0.150 |   12/150  
		   54/1000 | 0.010000   |    2.33204   |    5.93166   |      0.861 |      0.167 |   13/150  
		   55/1000 | 0.010000   |    4.41901   |    5.84509   |      0.816 |      0.191 |   14/150  
		   56/1000 | 0.005000   |    3.65103   |    5.75026   |      0.876 |      0.217 |   15/150  
		   57/1000 | 0.005000   |    3.22567   |    5.67328   |      0.859 |      0.238 |   16/150  
		   58/1000 | 0.005000   |    1.99936   |    5.50828   |      0.886 |      0.282 |   17/150  
		   59/1000 | 0.005000   |    1.78245   |    5.41088   |      0.877 |      0.307 |   18/150  
		   60/1000 | 0.005000   |    2.02087   |    5.39995   |      0.912 |      0.310 |   19/150  
		   61/1000 | 0.005000   |    2.74941   |    5.31835   |      0.890 |      0.331 |   20/150  
		   62/1000 | 0.005000   |    2.48782   |    5.27972   |      0.895 |      0.340 |   21/150  
		   63/1000 | 0.005000   |    4.35953   |    5.35212   |      0.864 |      0.322 |   22/150  
		   64/1000 | 0.005000   |    2.33466   |    5.33816   |      0.910 |      0.326 |   23/150  
		   65/1000 | 0.005000   |    2.63706   |    5.28911   |      0.889 |      0.338 |   24/150  
		   66/1000 | 0.005000   |    2.98702   |    5.26074   |      0.904 |      0.345 |   25/150  
		   67/1000 | 0.005000   |    2.05647   |    5.16563   |      0.901 |      0.368 |   26/150  
		   68/1000 | 0.005000   |    3.89591   |    5.16880   |      0.863 |      0.368 |   27/150  
		   69/1000 | 0.005000   |    1.61429   |    5.09849   |      0.912 |      0.385 |   28/150  
		   70/1000 | 0.005000   |    2.63026   |    5.07877   |      0.885 |      0.389 |   29/150  
		   71/1000 | 0.005000   |    1.91717   |    5.04391   |      0.897 |      0.398 |   30/150  
		   72/1000 | 0.002500   |    1.49891   |    5.07505   |      0.911 |      0.390 |   31/150  
		   73/1000 | 0.002500   |    2.25694   |    4.98687   |      0.907 |      0.411 |   32/150  
		   74/1000 | 0.002500   |    1.61561   |    5.02543   |      0.924 |      0.402 |   33/150  
		   75/1000 | 0.002500   |    3.87963   |    5.06341   |      0.887 |      0.393 |   34/150  
		   76/1000 | 0.002500   |    3.70831   |    5.11075   |      0.886 |      0.382 |   35/150  
		   77/1000 | 0.002500   |    2.03855   |    5.08275   |      0.920 |      0.389 |   36/150  
		   78/1000 | 0.002500   |    4.18359   |    5.09072   |      0.867 |      0.387 |   37/150  
		   79/1000 | 0.002500   |    1.72788   |    5.13036   |      0.931 |      0.377 |   38/150  
		   80/1000 | 0.002500   |    1.97923   |    5.06171   |      0.925 |      0.394 |   39/150  
		   81/1000 | 0.002500   |    2.73914   |    5.06878   |      0.906 |      0.392 |   40/150  
		   82/1000 | 0.002500   |    1.97135   |    5.05476   |      0.917 |      0.395 |   41/150  
		   83/1000 | 0.002500   |    1.50177   |    5.05597   |      0.940 |      0.395 |   42/150  
		   84/1000 | 0.002500   |    1.48411   |    5.08639   |      0.915 |      0.388 |   43/150  
		   85/1000 | 0.002500   |    2.91193   |    5.14093   |      0.897 |      0.374 |   44/150  
		   86/1000 | 0.002500   |    1.73615   |    5.15237   |      0.927 |      0.372 |   45/150  
		   87/1000 | 0.002500   |    3.57977   |    5.11450   |      0.900 |      0.381 |   46/150  
		   88/1000 | 0.001250   |    3.06058   |    5.21551   |      0.922 |      0.356 |   47/150  
		   89/1000 | 0.001250   |    5.13731   |    5.29087   |      0.851 |      0.337 |   48/150  
		   90/1000 | 0.001250   |    1.49847   |    5.27006   |      0.912 |      0.343 |   49/150  
		   91/1000 | 0.001250   |    2.53519   |    5.27951   |      0.914 |      0.340 |   50/150  
		   92/1000 | 0.001250   |    1.64041   |    5.26205   |      0.915 |      0.345 |   51/150  
		   93/1000 | 0.001250   |    1.39572   |    5.27679   |      0.936 |      0.341 |   52/150  
		   94/1000 | 0.001250   |    3.05955   |    5.17859   |      0.919 |      0.365 |   53/150  
		   95/1000 | 0.001250   |    2.22215   |    5.15584   |      0.934 |      0.371 |   54/150  
		   96/1000 | 0.001250   |    2.64158   |    5.14124   |      0.904 |      0.374 |   55/150  
		   97/1000 | 0.001250   |    2.18362   |    5.14716   |      0.912 |      0.373 |   56/150  
		   98/1000 | 0.001250   |    3.47899   |    5.18071   |      0.907 |      0.365 |   57/150  
		   99/1000 | 0.001250   |    3.86999   |    5.17951   |      0.888 |      0.365 |   58/150  
		  100/1000 | 0.001250   |    1.56302   |    5.15651   |      0.906 |      0.371 |   59/150  
		  101/1000 | 0.001250   |    1.40824   |    5.16887   |      0.929 |      0.368 |   60/150  
		  102/1000 | 0.001250   |    1.68690   |    5.16954   |      0.927 |      0.367 |   61/150  
		  103/1000 | 0.001250   |    2.39052   |    5.16272   |      0.902 |      0.369 |   62/150  
		  104/1000 | 0.000625   |    1.85989   |    5.16999   |      0.893 |      0.367 |   63/150  
		  105/1000 | 0.000625   |    2.38152   |    5.18940   |      0.925 |      0.363 |   64/150  
		  106/1000 | 0.000625   |    3.83294   |    5.15377   |      0.902 |      0.371 |   65/150  
		  107/1000 | 0.000625   |    2.84474   |    5.13910   |      0.915 |      0.375 |   66/150  
		  108/1000 | 0.000625   |    4.21929   |    5.26909   |      0.891 |      0.343 |   67/150  
		  109/1000 | 0.000625   |    2.88537   |    5.19842   |      0.915 |      0.360 |   68/150  
		  110/1000 | 0.000625   |    2.08223   |    5.22400   |      0.909 |      0.354 |   69/150  
		  111/1000 | 0.000625   |    2.56874   |    5.21651   |      0.925 |      0.356 |   70/150  
		  112/1000 | 0.000625   |    1.83610   |    5.18577   |      0.919 |      0.363 |   71/150  
		  113/1000 | 0.000625   |    1.79008   |    5.19695   |      0.934 |      0.361 |   72/150  
		  114/1000 | 0.000625   |    1.55447   |    5.12312   |      0.919 |      0.379 |   73/150  
		  115/1000 | 0.000625   |    3.18430   |    5.20815   |      0.903 |      0.358 |   74/150  
		  116/1000 | 0.000625   |    5.44345   |    5.35030   |      0.883 |      0.322 |   75/150  
		  117/1000 | 0.000625   |    1.96582   |    5.26348   |      0.937 |      0.344 |   76/150  
		  118/1000 | 0.000625   |    1.81171   |    5.17028   |      0.927 |      0.367 |   77/150  
		  119/1000 | 0.000625   |    1.54259   |    5.14435   |      0.916 |      0.374 |   78/150  
		  120/1000 | 0.000313   |    3.69889   |    5.14956   |      0.910 |      0.372 |   79/150  
		  121/1000 | 0.000313   |    1.93371   |    5.06134   |      0.929 |      0.394 |   80/150  
		  122/1000 | 0.000313   |    2.33708   |    5.06855   |      0.903 |      0.392 |   81/150  
		  123/1000 | 0.000313   |    1.48717   |    5.06704   |      0.932 |      0.392 |   82/150  
		  124/1000 | 0.000313   |    2.82389   |    5.10075   |      0.925 |      0.384 |   83/150  
		  125/1000 | 0.000313   |    1.33825   |    5.06035   |      0.936 |      0.394 |   84/150  
		  126/1000 | 0.000313   |    2.04010   |    5.05688   |      0.925 |      0.395 |   85/150  
		  127/1000 | 0.000313   |    1.78876   |    5.04046   |      0.924 |      0.399 |   86/150  
		  128/1000 | 0.000313   |    1.64524   |    5.06628   |      0.924 |      0.392 |   87/150  
		  129/1000 | 0.000313   |    2.10438   |    5.08937   |      0.920 |      0.387 |   88/150  
		  130/1000 | 0.000313   |    2.42150   |    5.11669   |      0.919 |      0.380 |   89/150  
		  131/1000 | 0.000313   |    2.91098   |    5.13069   |      0.897 |      0.377 |   90/150  
		  132/1000 | 0.000313   |    2.68790   |    5.16691   |      0.917 |      0.368 |   91/150  
		  133/1000 | 0.000313   |    1.65318   |    5.10673   |      0.914 |      0.383 |   92/150  
		  134/1000 | 0.000313   |    4.13081   |    5.17814   |      0.885 |      0.365 |   93/150  
		  135/1000 | 0.000313   |    2.42038   |    5.17566   |      0.921 |      0.366 |   94/150  
		  136/1000 | 0.000156   |    1.69980   |    5.11272   |      0.927 |      0.381 |   95/150  
		  137/1000 | 0.000156   |    2.38840   |    5.10085   |      0.918 |      0.384 |   96/150  
		  138/1000 | 0.000156   |    2.00877   |    5.12483   |      0.914 |      0.378 |   97/150  
		  139/1000 | 0.000156   |    1.40083   |    5.13798   |      0.924 |      0.375 |   98/150  
		  140/1000 | 0.000156   |    2.01003   |    5.14368   |      0.926 |      0.374 |   99/150  
		  141/1000 | 0.000156   |    2.92382   |    5.14008   |      0.915 |      0.375 |  100/150  
		  142/1000 | 0.000156   |    1.55050   |    5.15702   |      0.930 |      0.371 |  101/150  
		  143/1000 | 0.000156   |    3.90764   |    5.15266   |      0.883 |      0.372 |  102/150  
		  144/1000 | 0.000156   |    3.06008   |    5.17783   |      0.895 |      0.365 |  103/150  
		  145/1000 | 0.000156   |    1.38717   |    5.16632   |      0.925 |      0.368 |  104/150  
		  146/1000 | 0.000156   |    2.37752   |    5.09996   |      0.925 |      0.384 |  105/150  
		  147/1000 | 0.000156   |    2.12237   |    5.09718   |      0.912 |      0.385 |  106/150  
		  148/1000 | 0.000156   |    4.39126   |    5.07113   |      0.881 |      0.391 |  107/150  
		  149/1000 | 0.000156   |    3.11778   |    5.09810   |      0.886 |      0.385 |  108/150  
		  150/1000 | 0.000156   |    1.46854   |    5.08411   |      0.921 |      0.388 |  109/150  
		  151/1000 | 0.000156   |    1.90501   |    5.09311   |      0.924 |      0.386 |  110/150  
		  152/1000 | 0.000078   |    1.70044   |    5.10273   |      0.921 |      0.384 |  111/150  
		  153/1000 | 0.000078   |    4.28608   |    5.17004   |      0.893 |      0.367 |  112/150  
		  154/1000 | 0.000078   |    2.43564   |    5.14722   |      0.898 |      0.373 |  113/150  
		  155/1000 | 0.000078   |    3.00870   |    5.12284   |      0.910 |      0.379 |  114/150  
		  156/1000 | 0.000078   |    1.62340   |    5.13720   |      0.930 |      0.375 |  115/150  
		  157/1000 | 0.000078   |    1.59209   |    5.09159   |      0.919 |      0.386 |  116/150  
		  158/1000 | 0.000078   |    1.81631   |    5.06498   |      0.946 |      0.393 |  117/150  
		  159/1000 | 0.000078   |    2.29842   |    5.11990   |      0.922 |      0.380 |  118/150  
		  160/1000 | 0.000078   |    2.32239   |    5.15241   |      0.941 |      0.372 |  119/150  
		  161/1000 | 0.000078   |    5.50611   |    5.07231   |      0.845 |      0.391 |  120/150  
		  162/1000 | 0.000078   |    2.38345   |    5.07766   |      0.937 |      0.390 |  121/150  
		  163/1000 | 0.000078   |    2.04863   |    5.06195   |      0.913 |      0.394 |  122/150  
		  164/1000 | 0.000078   |    2.49317   |    5.06024   |      0.927 |      0.394 |  123/150  
		  165/1000 | 0.000078   |    2.96906   |    5.14495   |      0.926 |      0.373 |  124/150  
		  166/1000 | 0.000078   |    1.55979   |    5.13051   |      0.919 |      0.377 |  125/150  
		  167/1000 | 0.000078   |    3.30277   |    5.14160   |      0.900 |      0.374 |  126/150  
		  168/1000 | 0.000039   |    2.65545   |    5.14849   |      0.924 |      0.373 |  127/150  
		  169/1000 | 0.000039   |    1.74210   |    5.14957   |      0.926 |      0.372 |  128/150  
		  170/1000 | 0.000039   |    2.54845   |    5.16159   |      0.911 |      0.369 |  129/150  
		  171/1000 | 0.000039   |    1.85336   |    5.14651   |      0.933 |      0.373 |  130/150  
		  172/1000 | 0.000039   |    2.21586   |    5.16055   |      0.943 |      0.370 |  131/150  
		  173/1000 | 0.000039   |    2.24540   |    5.14410   |      0.910 |      0.374 |  132/150  
		  174/1000 | 0.000039   |    1.95003   |    5.11672   |      0.918 |      0.380 |  133/150  
		  175/1000 | 0.000039   |    4.74799   |    5.13899   |      0.882 |      0.375 |  134/150  
		  176/1000 | 0.000039   |    1.53932   |    5.13878   |      0.938 |      0.375 |  135/150  
		  177/1000 | 0.000039   |    1.71660   |    5.10211   |      0.928 |      0.384 |  136/150  
		  178/1000 | 0.000039   |    3.84675   |    5.13961   |      0.897 |      0.375 |  137/150  
		  179/1000 | 0.000039   |    2.54729   |    5.08480   |      0.933 |      0.388 |  138/150  
		  180/1000 | 0.000039   |    1.52158   |    5.04655   |      0.918 |      0.397 |  139/150  
		  181/1000 | 0.000039   |    2.03828   |    5.06947   |      0.934 |      0.392 |  140/150  
		  182/1000 | 0.000039   |    1.76503   |    5.04420   |      0.924 |      0.398 |  141/150  
		  183/1000 | 0.000039   |    1.44353   |    5.06079   |      0.929 |      0.394 |  142/150  
		  184/1000 | 0.000020   |    3.26452   |    5.05333   |      0.912 |      0.396 |  143/150  
		  185/1000 | 0.000020   |    2.79380   |    5.06039   |      0.925 |      0.394 |  144/150  
		  186/1000 | 0.000020   |    2.08478   |    5.03869   |      0.935 |      0.399 |  145/150  
		  187/1000 | 0.000020   |    1.86798   |    5.05854   |      0.930 |      0.394 |  146/150  
		  188/1000 | 0.000020   |    2.64746   |    5.06321   |      0.916 |      0.393 |  147/150  
		  189/1000 | 0.000020   |    2.56125   |    5.07467   |      0.912 |      0.390 |  148/150  
		  190/1000 | 0.000020   |    1.73854   |    5.09444   |      0.924 |      0.386 |  149/150  

		Early stopping triggered.
		[INFO] Case 1 completed.

	3.2 Training Case 2...
		=== Training Log Started: 2025-11-29 14:31:44.920413 ===
		Run Name: STAFV2_25_CASE2
		Device: cuda
		Epochs: 1000, Batch Size: 128, LR: 0.01
		============================================================
		[INFO] Unique quantized indices: 24141
		[INFO] Suggested num_embeddings: 28969
		[INFO] Processed 1545 valid samples.
		[INFO] Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_25_CASE2.csv  (shape: (1545, 429))
		[INFO] Saved feature metadata: ./data/training_results/feature_info_STAFV2_25_CASE2.json
		[INFO] Dataset split: 1236 train, 309 val
		[INFO] Scalers fitted and saved.

		✅ Model initialized with 714970 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train R²  |   Val R²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/1000 | 0.010000   |    9.16043   |    8.07862   |     -1.046 |     -0.474 |    0/150  
		    2/1000 | 0.010000   |    7.95397   |    5.89005   |     -0.546 |      0.206 |    0/150  
		    3/1000 | 0.010000   |    6.65601   |    5.36632   |     -0.085 |      0.357 |    0/150  
		    4/1000 | 0.010000   |    5.20241   |    4.59543   |      0.335 |      0.492 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.5954)
		    5/1000 | 0.010000   |    3.84590   |    4.25905   |      0.637 |      0.547 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.2591)
		    6/1000 | 0.010000   |    2.89456   |    4.32948   |      0.796 |      0.524 |    0/150  
		    7/1000 | 0.010000   |    2.63244   |    4.36481   |      0.835 |      0.524 |    1/150  
		    8/1000 | 0.010000   |    2.56831   |    4.27913   |      0.841 |      0.546 |    2/150  
		    9/1000 | 0.010000   |    2.42285   |    4.26214   |      0.860 |      0.544 |    3/150  
		   10/1000 | 0.010000   |    2.22340   |    4.18968   |      0.878 |      0.558 |    4/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.1897)
		   11/1000 | 0.010000   |    2.23907   |    4.11369   |      0.878 |      0.571 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.1137)
		   12/1000 | 0.010000   |    2.27065   |    4.07091   |      0.877 |      0.577 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.0709)
		   13/1000 | 0.010000   |    2.19762   |    4.14320   |      0.883 |      0.566 |    0/150  
		   14/1000 | 0.010000   |    2.11663   |    4.06371   |      0.893 |      0.571 |    1/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.0637)
		   15/1000 | 0.010000   |    2.09223   |    4.04261   |      0.893 |      0.574 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.0426)
		   16/1000 | 0.010000   |    2.08291   |    4.07736   |      0.895 |      0.574 |    0/150  
		   17/1000 | 0.010000   |    2.02109   |    4.05186   |      0.900 |      0.576 |    1/150  
		   18/1000 | 0.010000   |    2.10119   |    4.04008   |      0.892 |      0.578 |    2/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.0401)
		   19/1000 | 0.010000   |    2.14370   |    4.07504   |      0.891 |      0.567 |    0/150  
		   20/1000 | 0.010000   |    2.06673   |    4.09108   |      0.896 |      0.567 |    1/150  
		   21/1000 | 0.010000   |    1.92037   |    4.13257   |      0.911 |      0.564 |    2/150  
		   22/1000 | 0.010000   |    1.97555   |    4.10438   |      0.906 |      0.568 |    3/150  
		   23/1000 | 0.010000   |    1.98085   |    3.90647   |      0.904 |      0.599 |    4/150  
		                                          ╚══> ✅ SAVED (RMSE: 3.9065)
		   24/1000 | 0.010000   |    1.77844   |    3.97401   |      0.924 |      0.596 |    0/150  
		   25/1000 | 0.010000   |    1.74211   |    3.87253   |      0.926 |      0.600 |    1/150  
		                                          ╚══> ✅ SAVED (RMSE: 3.8725)
		   26/1000 | 0.010000   |    1.79254   |    3.98386   |      0.922 |      0.582 |    0/150  
		   27/1000 | 0.010000   |    1.91149   |    4.04047   |      0.912 |      0.571 |    1/150  
		   28/1000 | 0.010000   |    1.75116   |    4.08815   |      0.926 |      0.569 |    2/150  
		   29/1000 | 0.010000   |    1.73650   |    4.10283   |      0.927 |      0.568 |    3/150  
		   30/1000 | 0.010000   |    1.76018   |    3.97662   |      0.925 |      0.584 |    4/150  
		   31/1000 | 0.010000   |    1.71013   |    3.87502   |      0.928 |      0.601 |    5/150  
		   32/1000 | 0.010000   |    1.73787   |    4.03171   |      0.928 |      0.573 |    6/150  
		   33/1000 | 0.010000   |    1.69864   |    4.09310   |      0.930 |      0.563 |    7/150  
		   34/1000 | 0.010000   |    1.74326   |    4.02906   |      0.927 |      0.577 |    8/150  
		   35/1000 | 0.010000   |    1.82685   |    3.93318   |      0.924 |      0.591 |    9/150  
		   36/1000 | 0.010000   |    1.75332   |    3.94260   |      0.926 |      0.589 |   10/150  
		   37/1000 | 0.010000   |    1.68661   |    3.97936   |      0.932 |      0.574 |   11/150  
		   38/1000 | 0.010000   |    1.68586   |    3.98876   |      0.931 |      0.577 |   12/150  
		   39/1000 | 0.010000   |    1.65511   |    4.04971   |      0.933 |      0.565 |   13/150  
		   40/1000 | 0.010000   |    1.60155   |    4.06357   |      0.938 |      0.565 |   14/150  
		   41/1000 | 0.010000   |    1.78112   |    4.06403   |      0.923 |      0.566 |   15/150  
		   42/1000 | 0.010000   |    1.66690   |    3.99973   |      0.932 |      0.574 |   16/150  
		   43/1000 | 0.010000   |    1.60635   |    3.91960   |      0.938 |      0.582 |   17/150  
		   44/1000 | 0.010000   |    1.64370   |    3.93826   |      0.934 |      0.582 |   18/150  
		   45/1000 | 0.010000   |    1.58642   |    4.10604   |      0.938 |      0.557 |   19/150  
		   46/1000 | 0.010000   |    1.70450   |    4.14061   |      0.930 |      0.543 |   20/150  
		   47/1000 | 0.005000   |    1.66375   |    4.15802   |      0.933 |      0.545 |   21/150  
		   48/1000 | 0.005000   |    1.62914   |    4.03359   |      0.935 |      0.571 |   22/150  
		   49/1000 | 0.005000   |    1.60319   |    3.99678   |      0.937 |      0.576 |   23/150  
		   50/1000 | 0.005000   |    1.58583   |    4.04745   |      0.939 |      0.563 |   24/150  
		   51/1000 | 0.005000   |    1.56656   |    3.99145   |      0.940 |      0.570 |   25/150  
		   52/1000 | 0.005000   |    1.58456   |    4.00689   |      0.939 |      0.576 |   26/150  
		   53/1000 | 0.005000   |    1.61735   |    4.02238   |      0.937 |      0.569 |   27/150  
		   54/1000 | 0.005000   |    1.60187   |    3.93634   |      0.938 |      0.582 |   28/150  
		   55/1000 | 0.005000   |    1.64570   |    3.92765   |      0.934 |      0.586 |   29/150  
		   56/1000 | 0.005000   |    1.59660   |    4.02561   |      0.940 |      0.570 |   30/150  
		   57/1000 | 0.005000   |    1.62308   |    4.04109   |      0.936 |      0.563 |   31/150  
		   58/1000 | 0.005000   |    1.59148   |    3.97979   |      0.938 |      0.574 |   32/150  
		   59/1000 | 0.005000   |    1.53647   |    3.98314   |      0.943 |      0.568 |   33/150  
		   60/1000 | 0.005000   |    1.68671   |    4.05740   |      0.931 |      0.558 |   34/150  
		   61/1000 | 0.005000   |    1.55552   |    4.02644   |      0.941 |      0.565 |   35/150  
		   62/1000 | 0.005000   |    1.50291   |    4.06625   |      0.945 |      0.559 |   36/150  
		   63/1000 | 0.002500   |    1.62467   |    3.98144   |      0.937 |      0.575 |   37/150  
		   64/1000 | 0.002500   |    1.76728   |    3.97860   |      0.925 |      0.573 |   38/150  
		   65/1000 | 0.002500   |    1.53080   |    3.98968   |      0.943 |      0.572 |   39/150  
		   66/1000 | 0.002500   |    1.61840   |    3.99337   |      0.937 |      0.571 |   40/150  
		   67/1000 | 0.002500   |    1.47791   |    4.00742   |      0.947 |      0.568 |   41/150  
		   68/1000 | 0.002500   |    1.56461   |    4.02568   |      0.941 |      0.565 |   42/150  
		   69/1000 | 0.002500   |    1.62443   |    4.04906   |      0.936 |      0.559 |   43/150  
		   70/1000 | 0.002500   |    1.62674   |    4.09023   |      0.936 |      0.553 |   44/150  
		   71/1000 | 0.002500   |    1.49573   |    4.10412   |      0.947 |      0.550 |   45/150  
		   72/1000 | 0.002500   |    1.58499   |    4.04808   |      0.938 |      0.562 |   46/150  
		   73/1000 | 0.002500   |    1.45494   |    4.02490   |      0.949 |      0.568 |   47/150  
		   74/1000 | 0.002500   |    1.64489   |    3.99904   |      0.936 |      0.575 |   48/150  
		   75/1000 | 0.002500   |    1.51679   |    3.99610   |      0.945 |      0.572 |   49/150  
		   76/1000 | 0.002500   |    1.49251   |    4.01891   |      0.946 |      0.565 |   50/150  
		   77/1000 | 0.002500   |    1.59826   |    4.05188   |      0.938 |      0.559 |   51/150  
		   78/1000 | 0.002500   |    1.49692   |    4.02299   |      0.946 |      0.567 |   52/150  
		   79/1000 | 0.001250   |    1.48699   |    4.02981   |      0.946 |      0.568 |   53/150  
		   80/1000 | 0.001250   |    1.47467   |    4.02349   |      0.947 |      0.569 |   54/150  
		   81/1000 | 0.001250   |    1.67539   |    4.02042   |      0.932 |      0.569 |   55/150  
		   82/1000 | 0.001250   |    1.57881   |    4.02521   |      0.938 |      0.565 |   56/150  
		   83/1000 | 0.001250   |    1.47715   |    4.04172   |      0.947 |      0.562 |   57/150  
		   84/1000 | 0.001250   |    1.50082   |    4.04106   |      0.945 |      0.563 |   58/150  
		   85/1000 | 0.001250   |    1.46240   |    4.03474   |      0.949 |      0.565 |   59/150  
		   86/1000 | 0.001250   |    1.54741   |    4.04735   |      0.942 |      0.563 |   60/150  
		   87/1000 | 0.001250   |    1.50616   |    4.05327   |      0.945 |      0.562 |   61/150  
		   88/1000 | 0.001250   |    1.51185   |    4.05986   |      0.944 |      0.561 |   62/150  
		   89/1000 | 0.001250   |    1.51441   |    4.06847   |      0.944 |      0.561 |   63/150  
		   90/1000 | 0.001250   |    1.52579   |    4.07141   |      0.944 |      0.562 |   64/150  
		   91/1000 | 0.001250   |    1.48237   |    4.08794   |      0.947 |      0.556 |   65/150  
		   92/1000 | 0.001250   |    1.60815   |    4.08101   |      0.937 |      0.555 |   66/150  
		   93/1000 | 0.001250   |    1.62365   |    4.05143   |      0.935 |      0.561 |   67/150  
		   94/1000 | 0.001250   |    1.52771   |    4.06274   |      0.944 |      0.562 |   68/150  
		   95/1000 | 0.000625   |    1.46915   |    4.08594   |      0.948 |      0.558 |   69/150  
		   96/1000 | 0.000625   |    1.49254   |    4.08773   |      0.946 |      0.556 |   70/150  
		   97/1000 | 0.000625   |    1.42344   |    4.08371   |      0.951 |      0.557 |   71/150  
		   98/1000 | 0.000625   |    1.54080   |    4.08820   |      0.943 |      0.556 |   72/150  
		   99/1000 | 0.000625   |    1.55825   |    4.09244   |      0.941 |      0.557 |   73/150  
		  100/1000 | 0.000625   |    1.43443   |    4.08727   |      0.950 |      0.556 |   74/150  
		  101/1000 | 0.000625   |    1.54552   |    4.07944   |      0.942 |      0.560 |   75/150  
		  102/1000 | 0.000625   |    1.49592   |    4.05635   |      0.945 |      0.562 |   76/150  
		  103/1000 | 0.000625   |    1.56405   |    4.05564   |      0.942 |      0.557 |   77/150  
		  104/1000 | 0.000625   |    1.45850   |    4.05223   |      0.949 |      0.558 |   78/150  
		  105/1000 | 0.000625   |    1.48490   |    4.05742   |      0.946 |      0.558 |   79/150  
		  106/1000 | 0.000625   |    1.43176   |    4.06942   |      0.952 |      0.556 |   80/150  
		  107/1000 | 0.000625   |    1.41664   |    4.07068   |      0.951 |      0.557 |   81/150  
		  108/1000 | 0.000625   |    1.53239   |    4.07452   |      0.943 |      0.558 |   82/150  
		  109/1000 | 0.000625   |    1.51522   |    4.06976   |      0.945 |      0.561 |   83/150  
		  110/1000 | 0.000625   |    1.54116   |    4.05708   |      0.942 |      0.563 |   84/150  
		  111/1000 | 0.000313   |    1.47354   |    4.04907   |      0.948 |      0.564 |   85/150  
		  112/1000 | 0.000313   |    1.42389   |    4.05780   |      0.951 |      0.561 |   86/150  
		  113/1000 | 0.000313   |    1.41028   |    4.06534   |      0.952 |      0.558 |   87/150  
		  114/1000 | 0.000313   |    1.42599   |    4.06553   |      0.950 |      0.558 |   88/150  
		  115/1000 | 0.000313   |    1.63551   |    4.05763   |      0.937 |      0.561 |   89/150  
		  116/1000 | 0.000313   |    1.46555   |    4.05022   |      0.948 |      0.562 |   90/150  
		  117/1000 | 0.000313   |    1.52272   |    4.05882   |      0.944 |      0.558 |   91/150  
		  118/1000 | 0.000313   |    1.57567   |    4.06031   |      0.940 |      0.558 |   92/150  
		  119/1000 | 0.000313   |    1.54480   |    4.06286   |      0.942 |      0.559 |   93/150  
		  120/1000 | 0.000313   |    1.67023   |    4.05427   |      0.932 |      0.564 |   94/150  
		  121/1000 | 0.000313   |    1.54935   |    4.04762   |      0.942 |      0.563 |   95/150  
		  122/1000 | 0.000313   |    1.50787   |    4.04485   |      0.945 |      0.562 |   96/150  
		  123/1000 | 0.000313   |    1.48936   |    4.04997   |      0.946 |      0.561 |   97/150  
		  124/1000 | 0.000313   |    1.52370   |    4.04239   |      0.944 |      0.564 |   98/150  
		  125/1000 | 0.000313   |    1.48390   |    4.04753   |      0.946 |      0.561 |   99/150  
		  126/1000 | 0.000313   |    1.63176   |    4.05557   |      0.938 |      0.563 |  100/150  
		  127/1000 | 0.000156   |    1.53640   |    4.05632   |      0.943 |      0.560 |  101/150  
		  128/1000 | 0.000156   |    1.49991   |    4.06495   |      0.945 |      0.556 |  102/150  
		  129/1000 | 0.000156   |    1.51164   |    4.06294   |      0.945 |      0.558 |  103/150  
		  130/1000 | 0.000156   |    1.47640   |    4.06173   |      0.947 |      0.558 |  104/150  
		  131/1000 | 0.000156   |    1.62681   |    4.06782   |      0.937 |      0.555 |  105/150  
		  132/1000 | 0.000156   |    1.59697   |    4.06986   |      0.939 |      0.556 |  106/150  
		  133/1000 | 0.000156   |    1.55035   |    4.06604   |      0.942 |      0.558 |  107/150  
		  134/1000 | 0.000156   |    1.41602   |    4.07181   |      0.951 |      0.556 |  108/150  
		  135/1000 | 0.000156   |    1.47360   |    4.07117   |      0.947 |      0.556 |  109/150  
		  136/1000 | 0.000156   |    1.55995   |    4.06818   |      0.941 |      0.557 |  110/150  
		  137/1000 | 0.000156   |    1.53754   |    4.06822   |      0.943 |      0.555 |  111/150  
		  138/1000 | 0.000156   |    1.42109   |    4.06510   |      0.951 |      0.557 |  112/150  
		  139/1000 | 0.000156   |    1.46292   |    4.06721   |      0.948 |      0.556 |  113/150  
		  140/1000 | 0.000156   |    1.52484   |    4.06403   |      0.943 |      0.557 |  114/150  
		  141/1000 | 0.000156   |    1.50666   |    4.06328   |      0.944 |      0.560 |  115/150  
		  142/1000 | 0.000156   |    1.47389   |    4.06568   |      0.947 |      0.559 |  116/150  
		  143/1000 | 0.000078   |    1.52726   |    4.06817   |      0.943 |      0.557 |  117/150  
		  144/1000 | 0.000078   |    1.42902   |    4.06393   |      0.950 |      0.557 |  118/150  
		  145/1000 | 0.000078   |    1.52977   |    4.05864   |      0.943 |      0.561 |  119/150  
		  146/1000 | 0.000078   |    1.49021   |    4.06201   |      0.946 |      0.559 |  120/150  
		  147/1000 | 0.000078   |    1.44533   |    4.06938   |      0.949 |      0.557 |  121/150  
		  148/1000 | 0.000078   |    1.46158   |    4.06611   |      0.948 |      0.556 |  122/150  
		  149/1000 | 0.000078   |    1.42505   |    4.07109   |      0.950 |      0.555 |  123/150  
		  150/1000 | 0.000078   |    1.54563   |    4.06808   |      0.942 |      0.557 |  124/150  
		  151/1000 | 0.000078   |    1.46934   |    4.06876   |      0.947 |      0.557 |  125/150  
		  152/1000 | 0.000078   |    1.49954   |    4.06310   |      0.945 |      0.557 |  126/150  
		  153/1000 | 0.000078   |    1.53142   |    4.06617   |      0.944 |      0.557 |  127/150  
		  154/1000 | 0.000078   |    1.45107   |    4.06387   |      0.949 |      0.558 |  128/150  
		  155/1000 | 0.000078   |    1.59340   |    4.06898   |      0.938 |      0.557 |  129/150  
		  156/1000 | 0.000078   |    1.50093   |    4.06911   |      0.946 |      0.556 |  130/150  
		  157/1000 | 0.000078   |    1.53310   |    4.07045   |      0.943 |      0.556 |  131/150  
		  158/1000 | 0.000078   |    1.45898   |    4.06794   |      0.948 |      0.556 |  132/150  
		  159/1000 | 0.000039   |    1.51732   |    4.06848   |      0.944 |      0.556 |  133/150  
		  160/1000 | 0.000039   |    1.45697   |    4.06691   |      0.948 |      0.558 |  134/150  
		  161/1000 | 0.000039   |    1.58027   |    4.07274   |      0.939 |      0.559 |  135/150  
		  162/1000 | 0.000039   |    1.43991   |    4.06903   |      0.949 |      0.559 |  136/150  
		  163/1000 | 0.000039   |    1.47124   |    4.06434   |      0.949 |      0.559 |  137/150  
		  164/1000 | 0.000039   |    1.46042   |    4.06023   |      0.948 |      0.561 |  138/150  
		  165/1000 | 0.000039   |    1.46846   |    4.06564   |      0.947 |      0.558 |  139/150  
		  166/1000 | 0.000039   |    1.52623   |    4.06726   |      0.944 |      0.559 |  140/150  
		  167/1000 | 0.000039   |    1.48135   |    4.06325   |      0.947 |      0.560 |  141/150  
		  168/1000 | 0.000039   |    1.46130   |    4.05933   |      0.949 |      0.560 |  142/150  
		  169/1000 | 0.000039   |    1.49085   |    4.06480   |      0.947 |      0.556 |  143/150  
		  170/1000 | 0.000039   |    1.42674   |    4.06438   |      0.950 |      0.557 |  144/150  
		  171/1000 | 0.000039   |    1.49487   |    4.06163   |      0.945 |      0.558 |  145/150  
		  172/1000 | 0.000039   |    1.56830   |    4.06654   |      0.940 |      0.556 |  146/150  
		  173/1000 | 0.000039   |    1.44090   |    4.06176   |      0.950 |      0.558 |  147/150  
		  174/1000 | 0.000039   |    1.46232   |    4.06641   |      0.948 |      0.557 |  148/150  
		  175/1000 | 0.000020   |    1.59199   |    4.06862   |      0.940 |      0.556 |  149/150  

		Early stopping triggered.
		[INFO] Case 2 completed.

	3.3 Training Case 3...
		=== Training Log Started: 2025-11-29 14:35:38.042404 ===
		Run Name: STAFV2_25_CASE3
		Device: cuda
		Epochs: 1000, Batch Size: 128, LR: 0.01
		============================================================
		[INFO] Unique quantized indices: 36535
		[INFO] Suggested num_embeddings: 43842
		[INFO] Processed 3545 valid samples.
		[INFO] Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_25_CASE3.csv  (shape: (3545, 429))
		[INFO] Saved feature metadata: ./data/training_results/feature_info_STAFV2_25_CASE3.json
		[INFO] Dataset split: 2836 train, 709 val
		[INFO] Scalers fitted and saved.

		✅ Model initialized with 714970 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train R²  |   Val R²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/1000 | 0.010000   |    8.37849   |    7.32996   |     -0.793 |     -0.286 |    0/150  
		    2/1000 | 0.010000   |    5.69377   |    4.90730   |      0.169 |      0.426 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.9073)
		    3/1000 | 0.010000   |    3.99195   |    4.47956   |      0.599 |      0.520 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.4796)
		    4/1000 | 0.010000   |    3.37219   |    4.80559   |      0.711 |      0.450 |    0/150  
		    5/1000 | 0.010000   |    3.06122   |    4.49491   |      0.766 |      0.518 |    1/150  
		    6/1000 | 0.010000   |    2.62196   |    4.51927   |      0.827 |      0.513 |    2/150  
		    7/1000 | 0.010000   |    2.47939   |    4.52187   |      0.846 |      0.514 |    3/150  
		    8/1000 | 0.010000   |    2.46528   |    4.58448   |      0.849 |      0.500 |    4/150  
		    9/1000 | 0.010000   |    2.47199   |    4.71989   |      0.854 |      0.471 |    5/150  
		   10/1000 | 0.010000   |    2.40658   |    4.68227   |      0.854 |      0.483 |    6/150  
		   11/1000 | 0.010000   |    2.27173   |    4.52953   |      0.868 |      0.514 |    7/150  
		   12/1000 | 0.010000   |    2.35191   |    4.50194   |      0.860 |      0.521 |    8/150  
		   13/1000 | 0.010000   |    2.12806   |    4.54489   |      0.884 |      0.512 |    9/150  
		   14/1000 | 0.010000   |    2.21197   |    4.51685   |      0.880 |      0.516 |   10/150  
		   15/1000 | 0.010000   |    2.13202   |    4.45291   |      0.887 |      0.531 |   11/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.4529)
		   16/1000 | 0.010000   |    2.16942   |    4.55857   |      0.880 |      0.508 |    0/150  
		   17/1000 | 0.010000   |    2.09270   |    4.56063   |      0.892 |      0.510 |    1/150  
		   18/1000 | 0.010000   |    2.17049   |    4.56694   |      0.888 |      0.505 |    2/150  
		   19/1000 | 0.010000   |    2.04593   |    4.54137   |      0.893 |      0.510 |    3/150  
		   20/1000 | 0.010000   |    2.06369   |    4.45698   |      0.896 |      0.528 |    4/150  
		   21/1000 | 0.010000   |    1.97607   |    4.47684   |      0.903 |      0.523 |    5/150  
		   22/1000 | 0.010000   |    1.95713   |    4.45326   |      0.906 |      0.527 |    6/150  
		   23/1000 | 0.010000   |    1.85020   |    4.46996   |      0.913 |      0.526 |    7/150  
		   24/1000 | 0.010000   |    1.96788   |    4.51985   |      0.905 |      0.512 |    8/150  
		   25/1000 | 0.010000   |    1.83599   |    4.45555   |      0.914 |      0.527 |    9/150  
		   26/1000 | 0.010000   |    1.99190   |    4.49695   |      0.901 |      0.519 |   10/150  
		   27/1000 | 0.010000   |    1.92010   |    4.45964   |      0.907 |      0.528 |   11/150  
		   28/1000 | 0.010000   |    1.85302   |    4.40290   |      0.917 |      0.536 |   12/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.4029)
		   29/1000 | 0.010000   |    1.85594   |    4.42626   |      0.914 |      0.533 |    0/150  
		   30/1000 | 0.010000   |    1.94066   |    4.35148   |      0.913 |      0.546 |    1/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.3515)
		   31/1000 | 0.010000   |    1.91704   |    4.45347   |      0.911 |      0.528 |    0/150  
		   32/1000 | 0.010000   |    1.94758   |    4.38467   |      0.909 |      0.540 |    1/150  
		   33/1000 | 0.010000   |    1.91707   |    4.24918   |      0.915 |      0.567 |    2/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.2492)
		   34/1000 | 0.010000   |    1.80575   |    4.35684   |      0.919 |      0.548 |    0/150  
		   35/1000 | 0.010000   |    1.99089   |    4.37753   |      0.900 |      0.539 |    1/150  
		   36/1000 | 0.010000   |    1.79762   |    4.41537   |      0.920 |      0.540 |    2/150  
		   37/1000 | 0.010000   |    1.81939   |    4.35959   |      0.918 |      0.552 |    3/150  
		   38/1000 | 0.010000   |    1.77868   |    4.39825   |      0.919 |      0.543 |    4/150  
		   39/1000 | 0.010000   |    1.72630   |    4.24335   |      0.925 |      0.571 |    5/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.2433)
		   40/1000 | 0.010000   |    1.72105   |    4.35889   |      0.928 |      0.546 |    0/150  
		   41/1000 | 0.010000   |    1.72180   |    4.32447   |      0.928 |      0.553 |    1/150  
		   42/1000 | 0.010000   |    1.80587   |    4.43321   |      0.918 |      0.532 |    2/150  
		   43/1000 | 0.010000   |    1.79211   |    4.31974   |      0.918 |      0.558 |    3/150  
		   44/1000 | 0.010000   |    1.85964   |    4.41599   |      0.922 |      0.538 |    4/150  
		   45/1000 | 0.010000   |    1.70090   |    4.37160   |      0.927 |      0.546 |    5/150  
		   46/1000 | 0.010000   |    1.85237   |    4.34909   |      0.918 |      0.550 |    6/150  
		   47/1000 | 0.010000   |    1.73656   |    4.47333   |      0.924 |      0.522 |    7/150  
		   48/1000 | 0.010000   |    1.91689   |    4.43996   |      0.918 |      0.529 |    8/150  
		   49/1000 | 0.010000   |    1.90802   |    4.54127   |      0.908 |      0.510 |    9/150  
		   50/1000 | 0.010000   |    1.79151   |    4.50916   |      0.920 |      0.518 |   10/150  
		   51/1000 | 0.010000   |    1.79400   |    4.54611   |      0.919 |      0.507 |   11/150  
		   52/1000 | 0.010000   |    1.80011   |    4.44087   |      0.920 |      0.531 |   12/150  
		   53/1000 | 0.010000   |    1.78914   |    4.47049   |      0.926 |      0.525 |   13/150  
		   54/1000 | 0.010000   |    1.83353   |    4.44457   |      0.919 |      0.527 |   14/150  
		   55/1000 | 0.005000   |    1.82022   |    4.49469   |      0.918 |      0.522 |   15/150  
		   56/1000 | 0.005000   |    1.68527   |    4.40985   |      0.929 |      0.537 |   16/150  
		   57/1000 | 0.005000   |    1.67991   |    4.38335   |      0.930 |      0.542 |   17/150  
		   58/1000 | 0.005000   |    1.57928   |    4.38089   |      0.939 |      0.543 |   18/150  
		   59/1000 | 0.005000   |    1.62857   |    4.39997   |      0.934 |      0.540 |   19/150  
		   60/1000 | 0.005000   |    1.58483   |    4.34795   |      0.938 |      0.550 |   20/150  
		   61/1000 | 0.005000   |    1.66509   |    4.43046   |      0.936 |      0.533 |   21/150  
		   62/1000 | 0.005000   |    1.55749   |    4.41317   |      0.939 |      0.536 |   22/150  
		   63/1000 | 0.005000   |    1.53472   |    4.43021   |      0.943 |      0.535 |   23/150  
		   64/1000 | 0.005000   |    1.55366   |    4.49650   |      0.943 |      0.521 |   24/150  
		   65/1000 | 0.005000   |    1.51132   |    4.44994   |      0.943 |      0.531 |   25/150  
		   66/1000 | 0.005000   |    1.60318   |    4.45189   |      0.936 |      0.531 |   26/150  
		   67/1000 | 0.005000   |    1.62953   |    4.50373   |      0.936 |      0.519 |   27/150  
		   68/1000 | 0.005000   |    1.52118   |    4.49767   |      0.941 |      0.521 |   28/150  
		   69/1000 | 0.005000   |    1.57259   |    4.51002   |      0.941 |      0.519 |   29/150  
		   70/1000 | 0.005000   |    1.57340   |    4.49875   |      0.941 |      0.521 |   30/150  
		   71/1000 | 0.002500   |    1.45184   |    4.46470   |      0.947 |      0.527 |   31/150  
		   72/1000 | 0.002500   |    1.43022   |    4.43911   |      0.949 |      0.532 |   32/150  
		   73/1000 | 0.002500   |    1.51841   |    4.43750   |      0.941 |      0.533 |   33/150  
		   74/1000 | 0.002500   |    1.48570   |    4.45154   |      0.945 |      0.529 |   34/150  
		   75/1000 | 0.002500   |    1.50603   |    4.46544   |      0.944 |      0.527 |   35/150  
		   76/1000 | 0.002500   |    1.44125   |    4.45914   |      0.948 |      0.529 |   36/150  
		   77/1000 | 0.002500   |    1.39791   |    4.46975   |      0.951 |      0.526 |   37/150  
		   78/1000 | 0.002500   |    1.42950   |    4.48614   |      0.948 |      0.523 |   38/150  
		   79/1000 | 0.002500   |    1.44827   |    4.43300   |      0.948 |      0.535 |   39/150  
		   80/1000 | 0.002500   |    1.53462   |    4.48017   |      0.941 |      0.525 |   40/150  
		   81/1000 | 0.002500   |    1.50920   |    4.49784   |      0.945 |      0.521 |   41/150  
		   82/1000 | 0.002500   |    1.50660   |    4.48752   |      0.944 |      0.523 |   42/150  
		   83/1000 | 0.002500   |    1.49388   |    4.51439   |      0.946 |      0.517 |   43/150  
		   84/1000 | 0.002500   |    1.53774   |    4.45170   |      0.946 |      0.530 |   44/150  
		   85/1000 | 0.002500   |    1.51582   |    4.47965   |      0.944 |      0.524 |   45/150  
		   86/1000 | 0.002500   |    1.48810   |    4.50032   |      0.946 |      0.520 |   46/150  
		   87/1000 | 0.001250   |    1.59774   |    4.52482   |      0.945 |      0.516 |   47/150  
		   88/1000 | 0.001250   |    1.46054   |    4.52276   |      0.947 |      0.515 |   48/150  
		   89/1000 | 0.001250   |    1.42089   |    4.49153   |      0.949 |      0.521 |   49/150  
		   90/1000 | 0.001250   |    1.46819   |    4.48995   |      0.947 |      0.522 |   50/150  
		   91/1000 | 0.001250   |    1.55676   |    4.48257   |      0.950 |      0.523 |   51/150  
		   92/1000 | 0.001250   |    1.43197   |    4.46333   |      0.949 |      0.528 |   52/150  
		   93/1000 | 0.001250   |    1.48008   |    4.48556   |      0.949 |      0.523 |   53/150  
		   94/1000 | 0.001250   |    1.35217   |    4.48424   |      0.954 |      0.523 |   54/150  
		   95/1000 | 0.001250   |    1.40139   |    4.50830   |      0.950 |      0.518 |   55/150  
		   96/1000 | 0.001250   |    1.35029   |    4.51635   |      0.953 |      0.516 |   56/150  
		   97/1000 | 0.001250   |    1.51402   |    4.51677   |      0.943 |      0.517 |   57/150  
		   98/1000 | 0.001250   |    1.48332   |    4.52088   |      0.947 |      0.516 |   58/150  
		   99/1000 | 0.001250   |    1.53615   |    4.51999   |      0.945 |      0.516 |   59/150  
		  100/1000 | 0.001250   |    1.47327   |    4.53861   |      0.948 |      0.512 |   60/150  
		  101/1000 | 0.001250   |    1.41987   |    4.53006   |      0.950 |      0.513 |   61/150  
		  102/1000 | 0.001250   |    1.56452   |    4.50942   |      0.942 |      0.517 |   62/150  
		  103/1000 | 0.000625   |    1.38420   |    4.52859   |      0.951 |      0.513 |   63/150  
		  104/1000 | 0.000625   |    1.43289   |    4.54107   |      0.949 |      0.511 |   64/150  
		  105/1000 | 0.000625   |    1.50822   |    4.53006   |      0.943 |      0.512 |   65/150  
		  106/1000 | 0.000625   |    1.44620   |    4.50756   |      0.947 |      0.518 |   66/150  
		  107/1000 | 0.000625   |    1.47762   |    4.51470   |      0.947 |      0.516 |   67/150  
		  108/1000 | 0.000625   |    1.40847   |    4.51841   |      0.949 |      0.516 |   68/150  
		  109/1000 | 0.000625   |    1.43201   |    4.52482   |      0.947 |      0.514 |   69/150  
		  110/1000 | 0.000625   |    1.42308   |    4.55044   |      0.948 |      0.508 |   70/150  
		  111/1000 | 0.000625   |    1.40626   |    4.52168   |      0.952 |      0.515 |   71/150  
		  112/1000 | 0.000625   |    1.48381   |    4.51598   |      0.950 |      0.516 |   72/150  
		  113/1000 | 0.000625   |    1.35691   |    4.53399   |      0.954 |      0.512 |   73/150  
		  114/1000 | 0.000625   |    1.53869   |    4.53132   |      0.945 |      0.513 |   74/150  
		  115/1000 | 0.000625   |    1.34410   |    4.53868   |      0.955 |      0.511 |   75/150  
		  116/1000 | 0.000625   |    1.44104   |    4.52092   |      0.950 |      0.515 |   76/150  
		  117/1000 | 0.000625   |    1.43782   |    4.54484   |      0.952 |      0.509 |   77/150  
		  118/1000 | 0.000625   |    1.38864   |    4.52970   |      0.952 |      0.514 |   78/150  
		  119/1000 | 0.000313   |    1.44060   |    4.52414   |      0.952 |      0.515 |   79/150  
		  120/1000 | 0.000313   |    1.34242   |    4.51882   |      0.954 |      0.515 |   80/150  
		  121/1000 | 0.000313   |    1.36091   |    4.51336   |      0.953 |      0.517 |   81/150  
		  122/1000 | 0.000313   |    1.37259   |    4.53747   |      0.953 |      0.512 |   82/150  
		  123/1000 | 0.000313   |    1.40431   |    4.49544   |      0.950 |      0.521 |   83/150  
		  124/1000 | 0.000313   |    1.43914   |    4.50771   |      0.949 |      0.518 |   84/150  
		  125/1000 | 0.000313   |    1.34205   |    4.51360   |      0.957 |      0.517 |   85/150  
		  126/1000 | 0.000313   |    1.51897   |    4.54101   |      0.947 |      0.511 |   86/150  
		  127/1000 | 0.000313   |    1.47542   |    4.52017   |      0.945 |      0.515 |   87/150  
		  128/1000 | 0.000313   |    1.49269   |    4.53369   |      0.945 |      0.512 |   88/150  
		  129/1000 | 0.000313   |    1.41521   |    4.56331   |      0.951 |      0.506 |   89/150  
		  130/1000 | 0.000313   |    1.39367   |    4.54931   |      0.950 |      0.509 |   90/150  
		  131/1000 | 0.000313   |    1.49358   |    4.54608   |      0.951 |      0.509 |   91/150  
		  132/1000 | 0.000313   |    1.38248   |    4.53905   |      0.953 |      0.511 |   92/150  
		  133/1000 | 0.000313   |    1.48544   |    4.56928   |      0.951 |      0.504 |   93/150  
		  134/1000 | 0.000313   |    1.38852   |    4.52296   |      0.952 |      0.515 |   94/150  
		  135/1000 | 0.000156   |    1.30482   |    4.52994   |      0.957 |      0.513 |   95/150  
		  136/1000 | 0.000156   |    1.39889   |    4.54129   |      0.950 |      0.511 |   96/150  
		  137/1000 | 0.000156   |    1.44774   |    4.54716   |      0.948 |      0.509 |   97/150  
		  138/1000 | 0.000156   |    1.41163   |    4.54569   |      0.950 |      0.510 |   98/150  
		  139/1000 | 0.000156   |    1.38395   |    4.54359   |      0.954 |      0.511 |   99/150  
		  140/1000 | 0.000156   |    1.52722   |    4.54884   |      0.946 |      0.509 |  100/150  
		  141/1000 | 0.000156   |    1.54648   |    4.54453   |      0.948 |      0.510 |  101/150  
		  142/1000 | 0.000156   |    1.39813   |    4.53979   |      0.952 |      0.511 |  102/150  
		  143/1000 | 0.000156   |    1.38369   |    4.54953   |      0.951 |      0.509 |  103/150  
		  144/1000 | 0.000156   |    1.36648   |    4.54292   |      0.952 |      0.511 |  104/150  
		  145/1000 | 0.000156   |    1.42572   |    4.55422   |      0.949 |      0.508 |  105/150  
		  146/1000 | 0.000156   |    1.32529   |    4.54658   |      0.955 |      0.510 |  106/150  
		  147/1000 | 0.000156   |    1.49139   |    4.56413   |      0.945 |      0.506 |  107/150  
		  148/1000 | 0.000156   |    1.44046   |    4.55782   |      0.950 |      0.507 |  108/150  
		  149/1000 | 0.000156   |    1.32524   |    4.54327   |      0.955 |      0.511 |  109/150  
		  150/1000 | 0.000156   |    1.36036   |    4.53899   |      0.954 |      0.511 |  110/150  
		  151/1000 | 0.000078   |    1.35367   |    4.55268   |      0.954 |      0.509 |  111/150  
		  152/1000 | 0.000078   |    1.50712   |    4.54434   |      0.951 |      0.510 |  112/150  
		  153/1000 | 0.000078   |    1.37742   |    4.56734   |      0.952 |      0.505 |  113/150  
		  154/1000 | 0.000078   |    1.34872   |    4.56675   |      0.954 |      0.505 |  114/150  
		  155/1000 | 0.000078   |    1.44355   |    4.57711   |      0.949 |      0.503 |  115/150  
		  156/1000 | 0.000078   |    1.40145   |    4.54506   |      0.950 |      0.510 |  116/150  
		  157/1000 | 0.000078   |    1.35787   |    4.54291   |      0.953 |      0.510 |  117/150  
		  158/1000 | 0.000078   |    1.42009   |    4.56846   |      0.951 |      0.505 |  118/150  
		  159/1000 | 0.000078   |    1.41175   |    4.54721   |      0.951 |      0.509 |  119/150  
		  160/1000 | 0.000078   |    1.28337   |    4.55982   |      0.959 |      0.507 |  120/150  
		  161/1000 | 0.000078   |    1.44274   |    4.54989   |      0.948 |      0.509 |  121/150  
		  162/1000 | 0.000078   |    1.41417   |    4.55981   |      0.949 |      0.507 |  122/150  
		  163/1000 | 0.000078   |    1.42895   |    4.56158   |      0.948 |      0.506 |  123/150  
		  164/1000 | 0.000078   |    1.37992   |    4.54317   |      0.954 |      0.510 |  124/150  
		  165/1000 | 0.000078   |    1.40885   |    4.55040   |      0.949 |      0.509 |  125/150  
		  166/1000 | 0.000078   |    1.39228   |    4.56333   |      0.953 |      0.506 |  126/150  
		  167/1000 | 0.000039   |    1.33185   |    4.54005   |      0.956 |      0.511 |  127/150  
		  168/1000 | 0.000039   |    1.38357   |    4.57430   |      0.954 |      0.503 |  128/150  
		  169/1000 | 0.000039   |    1.36991   |    4.55681   |      0.953 |      0.507 |  129/150  
		  170/1000 | 0.000039   |    1.34277   |    4.56554   |      0.955 |      0.506 |  130/150  
		  171/1000 | 0.000039   |    1.59810   |    4.55910   |      0.945 |      0.507 |  131/150  
		  172/1000 | 0.000039   |    1.41557   |    4.56200   |      0.951 |      0.506 |  132/150  
		  173/1000 | 0.000039   |    1.39637   |    4.56474   |      0.952 |      0.506 |  133/150  
		  174/1000 | 0.000039   |    1.37437   |    4.55493   |      0.952 |      0.508 |  134/150  
		  175/1000 | 0.000039   |    1.39972   |    4.56254   |      0.954 |      0.506 |  135/150  
		  176/1000 | 0.000039   |    1.44837   |    4.58174   |      0.953 |      0.502 |  136/150  
		  177/1000 | 0.000039   |    1.47581   |    4.57329   |      0.956 |      0.503 |  137/150  
		  178/1000 | 0.000039   |    1.40155   |    4.56238   |      0.950 |      0.506 |  138/150  
		  179/1000 | 0.000039   |    1.41146   |    4.57920   |      0.952 |      0.502 |  139/150  
		  180/1000 | 0.000039   |    1.40344   |    4.55082   |      0.951 |      0.509 |  140/150  
		  181/1000 | 0.000039   |    1.42402   |    4.56117   |      0.953 |      0.507 |  141/150  
		  182/1000 | 0.000039   |    1.34743   |    4.55038   |      0.955 |      0.509 |  142/150  
		  183/1000 | 0.000020   |    1.39173   |    4.55784   |      0.952 |      0.507 |  143/150  
		  184/1000 | 0.000020   |    1.41264   |    4.55470   |      0.949 |      0.508 |  144/150  
		  185/1000 | 0.000020   |    1.37527   |    4.55028   |      0.952 |      0.509 |  145/150  
		  186/1000 | 0.000020   |    1.40534   |    4.57653   |      0.951 |      0.503 |  146/150  
		  187/1000 | 0.000020   |    1.35080   |    4.54505   |      0.954 |      0.510 |  147/150  
		  188/1000 | 0.000020   |    1.39565   |    4.55015   |      0.953 |      0.509 |  148/150  
		  189/1000 | 0.000020   |    1.35074   |    4.56175   |      0.955 |      0.506 |  149/150  

		Early stopping triggered.
		[INFO] Case 3 completed.
