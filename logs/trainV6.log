nohup: ignoring input
Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at 'data/battery_demandV2/resample_full.csv' and 'data/battery_demandV2/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1395, 37)
		[INFO] Case 1 exists â€” loaded battery demand from 'data/battery_demandV2/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists â€” loaded battery demand from 'data/battery_demandV2/case2_nan_filled/battery_demand.npy' with shape (1563, 37).
		[INFO] Case 0 exists â€” loaded battery demand from 'data/battery_demandV2/case0_test/battery_demand.npy' with shape (2, 49).

	1.6 Generating battery schedule...
		[INFO] Case 0 exists â€” loaded from 'data/battery_demandV2/case0_test/battery_availability.npy' and 'data/battery_demandV2/case0_test/battery_details.npy' shape (2, 272, 48) and (4, 2, 272)
		[INFO] Case 1 exists â€” loaded from 'data/battery_demandV2/case1_real_only/battery_availability.npy' and 'data/battery_demandV2/case1_real_only/battery_details.npy' shape (168, 237, 36) and (4, 168, 237)
		[INFO] Case 2 exists â€” loaded from 'data/battery_demandV2/case2_nan_filled/battery_availability.npy' and 'data/battery_demandV2/case2_nan_filled/battery_details.npy' shape (1563, 237, 36) and (4, 1563, 237)
		[ERROR] Could not load battery demand from 'data/battery_demandV2/case3_extended_generated/battery_demand.npy': [Errno 2] No such file or directory: 'data/battery_demandV2/case3_extended_generated/battery_demand.npy'


==================================================
PART 2: MILP Optimization...
==================================================

	2.0 Optimizing Case 0...
		[INFO] Loaded 2 samples from 'data/battery_demandV2/case0_test'
		[INFO] Results already exist at 'data/optimization_resultsV2/case0_test/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at 'data/optimization_resultsV2/case0_test/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 0 completed.

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from 'data/battery_demandV2/case1_real_only'
		[INFO] Results already exist at 'data/optimization_resultsV2/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at 'data/optimization_resultsV2/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1563 samples from 'data/battery_demandV2/case2_nan_filled'
		[INFO] Results already exist at 'data/optimization_resultsV2/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at 'data/optimization_resultsV2/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 2 completed.


==================================================
PART 3: Supervised Learning...
==================================================

	3.2 Training Case 2...

=== Starting Training Run: STAF_currentSOC_V6_CASE2 ===
Device: cuda
		[INFO] Starting Preprocessing for Case 2...
		[INFO] Unique quantized indices: 28274
		[INFO] Suggested num_embeddings: 33928
		[INFO] Generating sliding windows...
Column names ['sin_hour', 'cos_hour', 'sin_day', 'cos_day', 'building_T1', 'building_T2', 'building_T3', 'building_T4', 'building_T5', 'building_T6', 'building_T7', 'building_T8', 'building_T9', 'building_T10', 'building_T11', 'building_T12', 'building_T13', 'building_T14', 'building_T15', 'building_T16', 'building_T17', 'building_T18', 'building_T19', 'building_T20', 'building_T21', 'building_T22', 'building_T23', 'building_T24', 'radiation_T1', 'radiation_T2', 'radiation_T3', 'radiation_T4', 'radiation_T5', 'radiation_T6', 'radiation_T7', 'radiation_T8', 'radiation_T9', 'radiation_T10', 'radiation_T11', 'radiation_T12', 'radiation_T13', 'radiation_T14', 'radiation_T15', 'radiation_T16', 'radiation_T17', 'radiation_T18', 'radiation_T19', 'radiation_T20', 'radiation_T21', 'radiation_T22', 'radiation_T23', 'radiation_T24', 'temperature_T1', 'temperature_T2', 'temperature_T3', 'temperature_T4', 'temperature_T5', 'temperature_T6', 'temperature_T7', 'temperature_T8', 'temperature_T9', 'temperature_T10', 'temperature_T11', 'temperature_T12', 'temperature_T13', 'temperature_T14', 'temperature_T15', 'temperature_T16', 'temperature_T17', 'temperature_T18', 'temperature_T19', 'temperature_T20', 'temperature_T21', 'temperature_T22', 'temperature_T23', 'temperature_T24', 'priceG2B_T1', 'priceG2B_T2', 'priceG2B_T3', 'priceG2B_T4', 'priceG2B_T5', 'priceG2B_T6', 'priceG2B_T7', 'priceG2B_T8', 'priceG2B_T9', 'priceG2B_T10', 'priceG2B_T11', 'priceG2B_T12', 'priceG2B_T13', 'priceG2B_T14', 'priceG2B_T15', 'priceG2B_T16', 'priceG2B_T17', 'priceG2B_T18', 'priceG2B_T19', 'priceG2B_T20', 'priceG2B_T21', 'priceG2B_T22', 'priceG2B_T23', 'priceG2B_T24', 'priceG2V_T1', 'priceG2V_T2', 'priceG2V_T3', 'priceG2V_T4', 'priceG2V_T5', 'priceG2V_T6', 'priceG2V_T7', 'priceG2V_T8', 'priceG2V_T9', 'priceG2V_T10', 'priceG2V_T11', 'priceG2V_T12', 'priceG2V_T13', 'priceG2V_T14', 'priceG2V_T15', 'priceG2V_T16', 'priceG2V_T17', 'priceG2V_T18', 'priceG2V_T19', 'priceG2V_T20', 'priceG2V_T21', 'priceG2V_T22', 'priceG2V_T23', 'priceG2V_T24', 'battery_T1', 'battery_T2', 'battery_T3', 'battery_T4', 'battery_T5', 'battery_T6', 'battery_T7', 'battery_T8', 'battery_T9', 'battery_T10', 'battery_T11', 'battery_T12', 'battery_T13', 'battery_T14', 'battery_T15', 'battery_T16', 'battery_T17', 'battery_T18', 'battery_T19', 'battery_T20', 'battery_T21', 'battery_T22', 'battery_T23', 'battery_T24', 'SOC_V1', 'SOC_V2', 'SOC_V3', 'SOC_V4', 'SOC_V5', 'SOC_V6', 'SOC_V7', 'SOC_V8', 'SOC_V9', 'SOC_V10', 'SOC_V11', 'SOC_V12', 'SOC_V13', 'SOC_V14', 'SOC_V15', 'SOC_V16', 'SOC_V17', 'SOC_V18', 'SOC_V19', 'SOC_V20', 'SOC_V21', 'SOC_V22', 'SOC_V23', 'SOC_V24', 'SOC_V25', 'SOC_V26', 'SOC_V27', 'SOC_V28', 'SOC_V29', 'SOC_V30', 'SOC_V31', 'SOC_V32', 'SOC_V33', 'SOC_V34', 'SOC_V35', 'SOC_V36', 'SOC_V37', 'SOC_V38', 'SOC_V39', 'SOC_V40', 'SOC_V41', 'SOC_V42', 'SOC_V43', 'SOC_V44', 'SOC_V45', 'SOC_V46', 'SOC_V47', 'SOC_V48', 'SOC_V49', 'SOC_V50', 'SOC_V51', 'SOC_V52', 'SOC_V53', 'SOC_V54', 'SOC_V55', 'SOC_V56', 'SOC_V57', 'SOC_V58', 'SOC_V59', 'SOC_V60', 'SOC_V61', 'SOC_V62', 'SOC_V63', 'SOC_V64', 'SOC_V65', 'SOC_V66', 'SOC_V67', 'SOC_V68', 'SOC_V69', 'SOC_V70', 'SOC_V71', 'SOC_V72', 'SOC_V73', 'SOC_V74', 'SOC_V75', 'SOC_V76', 'target']
Number of columns: 225
Number of rows: 18756
		[INFO] Saved dataset: ./data/training_results/STAF_currentSOC_V6_CASE2/merged_dataset_STAF_currentSOC_V6_CASE2.csv (Shape: (18756, 225))
		[INFO] Saved metadata: ./data/training_results/STAF_currentSOC_V6_CASE2/feature_info_STAF_currentSOC_V6_CASE2.json
	[Model Config] Detected Dims: {'static': 4, 'series_count': 6, 'seq_len': 24, 'vehicle': 76, 'emb_vocab': 1000}
		[INFO] Data loaded. Train: 13129, Val: 5627
		[INFO] Fitting new scalers on training data...
		[INFO] Calculating weights for imbalanced regression...
		[INFO] 
==================================================
		[INFO] ðŸš€ TRAINING SESSION: STAF_currentSOC_V6_CASE2
		[INFO] ==================================================
		[INFO] Device:             cuda
		[INFO] Model Parameters:   83,530
		[INFO] --------------------------------------------------
		[INFO] Epochs:             5000
		[INFO] Batch Size:         32
		[INFO] Learning Rate:      0.001
		[INFO] Weight Decay:       0.001
		[INFO] Dropout:            0.3
		[INFO] --------------------------------------------------
		[INFO] Hidden Layers:      [256, 64]
		[INFO] Embedding Dim:      8
		[INFO] Attention Heads:    4
		[INFO]==================================================


		[INFO]Epoch |    LR    | Trn RMSE | Val RMSE | Trn R2 | Val R2 | Stop
-----------------------------------------------------------------
		[INFO]    1 | 0.001000 |   5.2171 |   5.9291 |  0.592 |  0.329 | 0/60
		[INFO]    2 | 0.001000 |   4.2509 |   5.0971 |  0.731 |  0.504 | 0/60
		[INFO]    3 | 0.001000 |   4.0639 |   4.3777 |  0.757 |  0.634 | 0/60
		[INFO]    4 | 0.001000 |   3.8721 |   4.7488 |  0.778 |  0.570 | 0/60
		[INFO]    5 | 0.001000 |   3.8262 |   4.3250 |  0.782 |  0.643 | 1/60
		[INFO]    6 | 0.001000 |   3.7894 |   4.5105 |  0.790 |  0.612 | 0/60
		[INFO]    7 | 0.001000 |   3.6877 |   4.5209 |  0.800 |  0.610 | 1/60
		[INFO]    8 | 0.001000 |   3.6505 |   4.3077 |  0.805 |  0.646 | 2/60
		[INFO]    9 | 0.001000 |   3.6451 |   3.8571 |  0.803 |  0.716 | 0/60
		[INFO]   10 | 0.001000 |   3.5671 |   4.1310 |  0.812 |  0.674 | 0/60
		[INFO]   11 | 0.001000 |   3.5166 |   4.2382 |  0.814 |  0.657 | 1/60
		[INFO]   12 | 0.001000 |   3.4635 |   4.0477 |  0.822 |  0.687 | 2/60
		[INFO]   13 | 0.001000 |   3.5098 |   4.4156 |  0.818 |  0.628 | 3/60
		[INFO]   14 | 0.001000 |   3.3586 |   4.2162 |  0.833 |  0.661 | 4/60
		[INFO]   15 | 0.001000 |   3.3542 |   4.2924 |  0.835 |  0.648 | 5/60
		[INFO]   16 | 0.001000 |   3.3534 |   4.3713 |  0.834 |  0.635 | 6/60
		[INFO]   17 | 0.001000 |   3.3358 |   4.0934 |  0.834 |  0.680 | 7/60
		[INFO]   18 | 0.001000 |   3.3128 |   4.4085 |  0.838 |  0.629 | 8/60
		[INFO]   19 | 0.001000 |   3.2976 |   3.6941 |  0.837 |  0.739 | 9/60
		[INFO]   20 | 0.001000 |   3.2754 |   4.4204 |  0.839 |  0.627 | 0/60
		[INFO]   21 | 0.001000 |   3.2791 |   4.5523 |  0.840 |  0.604 | 1/60
		[INFO]   22 | 0.001000 |   3.2123 |   4.2783 |  0.848 |  0.650 | 2/60
		[INFO]   23 | 0.001000 |   3.2792 |   4.1036 |  0.842 |  0.678 | 3/60
		[INFO]   24 | 0.001000 |   3.2537 |   3.9248 |  0.844 |  0.706 | 4/60
		[INFO]   25 | 0.001000 |   3.1907 |   3.9685 |  0.852 |  0.699 | 5/60
		[INFO]   26 | 0.001000 |   3.0751 |   4.3745 |  0.861 |  0.635 | 6/60
		[INFO]   27 | 0.001000 |   3.1236 |   4.1844 |  0.857 |  0.666 | 7/60
		[INFO]   28 | 0.001000 |   3.1119 |   4.0579 |  0.858 |  0.686 | 8/60
		[INFO]   29 | 0.001000 |   3.1110 |   3.9796 |  0.856 |  0.698 | 9/60
		[INFO]   30 | 0.001000 |   3.0724 |   3.9302 |  0.859 |  0.705 | 10/60
		[INFO]   31 | 0.001000 |   3.1068 |   3.7792 |  0.859 |  0.727 | 11/60
		[INFO]   32 | 0.001000 |   3.0855 |   3.9507 |  0.859 |  0.702 | 12/60
		[INFO]   33 | 0.001000 |   3.0992 |   3.8247 |  0.860 |  0.721 | 13/60
		[INFO]   34 | 0.001000 |   3.1226 |   3.8900 |  0.854 |  0.711 | 14/60
		[INFO]   35 | 0.001000 |   3.0293 |   4.1381 |  0.863 |  0.673 | 15/60
		[INFO]   36 | 0.001000 |   2.9930 |   3.8384 |  0.866 |  0.719 | 16/60
		[INFO]   37 | 0.001000 |   3.0422 |   3.9482 |  0.862 |  0.702 | 17/60
		[INFO]   38 | 0.001000 |   3.0695 |   4.2752 |  0.859 |  0.651 | 18/60
		[INFO]   39 | 0.001000 |   3.0201 |   4.3892 |  0.866 |  0.632 | 19/60
		[INFO]   40 | 0.001000 |   2.9670 |   3.7604 |  0.871 |  0.730 | 20/60
		[INFO]   41 | 0.001000 |   3.0136 |   3.7541 |  0.866 |  0.731 | 21/60
		[INFO]   42 | 0.001000 |   3.0560 |   3.6852 |  0.862 |  0.741 | 22/60
		[INFO]   43 | 0.001000 |   2.9709 |   4.3094 |  0.871 |  0.645 | 0/60
		[INFO]   44 | 0.001000 |   2.9082 |   3.8084 |  0.875 |  0.723 | 1/60
		[INFO]   45 | 0.001000 |   2.9759 |   4.1244 |  0.868 |  0.675 | 2/60
		[INFO]   46 | 0.001000 |   2.9893 |   3.7986 |  0.868 |  0.724 | 3/60
		[INFO]   47 | 0.001000 |   2.9716 |   3.9647 |  0.868 |  0.700 | 4/60
		[INFO]   48 | 0.001000 |   2.9708 |   4.0840 |  0.869 |  0.682 | 5/60
		[INFO]   49 | 0.001000 |   2.9118 |   4.0366 |  0.874 |  0.689 | 6/60
		[INFO]   50 | 0.001000 |   2.8926 |   3.9971 |  0.874 |  0.695 | 7/60
		[INFO]   51 | 0.001000 |   2.8885 |   3.6780 |  0.877 |  0.742 | 8/60
		[INFO]   52 | 0.001000 |   2.8448 |   3.6358 |  0.882 |  0.748 | 0/60
		[INFO]   53 | 0.001000 |   2.8835 |   4.1002 |  0.877 |  0.679 | 0/60
		[INFO]   54 | 0.001000 |   2.9071 |   3.7869 |  0.875 |  0.726 | 1/60
		[INFO]   55 | 0.001000 |   2.9143 |   4.3119 |  0.874 |  0.645 | 2/60
		[INFO]   56 | 0.001000 |   2.8520 |   3.7539 |  0.879 |  0.731 | 3/60
		[INFO]   57 | 0.001000 |   2.8473 |   3.5839 |  0.879 |  0.755 | 4/60
		[INFO]   58 | 0.001000 |   2.8582 |   4.1009 |  0.880 |  0.679 | 0/60
		[INFO]   59 | 0.001000 |   2.8344 |   3.8693 |  0.881 |  0.714 | 1/60
		[INFO]   60 | 0.001000 |   2.8872 |   3.7395 |  0.879 |  0.733 | 2/60
		[INFO]   61 | 0.001000 |   2.8248 |   3.8481 |  0.882 |  0.717 | 3/60
		[INFO]   62 | 0.001000 |   2.8622 |   3.8430 |  0.879 |  0.718 | 4/60
		[INFO]   63 | 0.001000 |   2.8413 |   3.6904 |  0.880 |  0.740 | 5/60
		[INFO]   64 | 0.001000 |   2.8220 |   3.6582 |  0.882 |  0.744 | 6/60
		[INFO]   65 | 0.001000 |   2.8995 |   4.1665 |  0.875 |  0.669 | 7/60
		[INFO]   66 | 0.001000 |   2.8847 |   3.8874 |  0.877 |  0.711 | 8/60
		[INFO]   67 | 0.001000 |   2.8423 |   3.7195 |  0.880 |  0.736 | 9/60
		[INFO]   68 | 0.001000 |   2.7947 |   3.8605 |  0.886 |  0.715 | 10/60
		[INFO]   69 | 0.001000 |   2.8047 |   3.6918 |  0.884 |  0.740 | 11/60
		[INFO]   70 | 0.001000 |   2.7940 |   4.0105 |  0.884 |  0.693 | 12/60
		[INFO]   71 | 0.001000 |   2.7822 |   3.9517 |  0.886 |  0.702 | 13/60
		[INFO]   72 | 0.001000 |   2.8112 |   3.8337 |  0.883 |  0.719 | 14/60
		[INFO]   73 | 0.001000 |   2.7612 |   3.8103 |  0.885 |  0.723 | 15/60
		[INFO]   74 | 0.001000 |   2.7591 |   3.8366 |  0.885 |  0.719 | 16/60
		[INFO]   75 | 0.001000 |   2.8175 |   3.7141 |  0.883 |  0.737 | 17/60
		[INFO]   76 | 0.001000 |   2.8252 |   4.0984 |  0.881 |  0.679 | 18/60
		[INFO]   77 | 0.001000 |   2.8463 |   3.9135 |  0.880 |  0.708 | 19/60
		[INFO]   78 | 0.001000 |   2.8434 |   3.9831 |  0.880 |  0.697 | 20/60
		[INFO]   79 | 0.001000 |   2.7722 |   3.9897 |  0.885 |  0.696 | 21/60
		[INFO]   80 | 0.001000 |   2.7754 |   3.8903 |  0.886 |  0.711 | 22/60
		[INFO]   81 | 0.001000 |   2.7742 |   3.7977 |  0.885 |  0.725 | 23/60
		[INFO]   82 | 0.001000 |   2.8298 |   3.7998 |  0.882 |  0.724 | 24/60
		[INFO]   83 | 0.001000 |   2.7487 |   4.0412 |  0.888 |  0.688 | 25/60
		[INFO]   84 | 0.001000 |   2.7827 |   3.8110 |  0.886 |  0.723 | 26/60
		[INFO]   85 | 0.001000 |   2.7516 |   3.9328 |  0.889 |  0.705 | 27/60
		[INFO]   86 | 0.001000 |   2.7259 |   3.7391 |  0.889 |  0.733 | 28/60
		[INFO]   87 | 0.001000 |   2.8057 |   3.6982 |  0.884 |  0.739 | 29/60
		[INFO]   88 | 0.001000 |   2.7936 |   3.7391 |  0.884 |  0.733 | 30/60
		[INFO]   89 | 0.001000 |   2.7266 |   4.2009 |  0.891 |  0.663 | 31/60
		[INFO]   90 | 0.001000 |   2.6964 |   3.7610 |  0.893 |  0.730 | 32/60
		[INFO]   91 | 0.001000 |   2.7492 |   3.8156 |  0.889 |  0.722 | 33/60
		[INFO]   92 | 0.001000 |   2.7796 |   3.6370 |  0.885 |  0.747 | 34/60
		[INFO]   93 | 0.001000 |   2.7357 |   4.1938 |  0.889 |  0.664 | 35/60
		[INFO]   94 | 0.001000 |   2.7481 |   3.7972 |  0.889 |  0.725 | 36/60
		[INFO]   95 | 0.001000 |   2.7542 |   4.3709 |  0.887 |  0.635 | 37/60
		[INFO]   96 | 0.001000 |   2.7365 |   3.8099 |  0.889 |  0.723 | 38/60
		[INFO]   97 | 0.001000 |   2.7997 |   4.6671 |  0.885 |  0.584 | 39/60
		[INFO]   98 | 0.001000 |   2.7871 |   3.7297 |  0.882 |  0.734 | 40/60
		[INFO]   99 | 0.001000 |   2.7723 |   3.9415 |  0.887 |  0.703 | 41/60
		[INFO]  100 | 0.001000 |   2.7630 |   3.8329 |  0.886 |  0.720 | 42/60
		[INFO]  101 | 0.001000 |   2.7540 |   3.7769 |  0.889 |  0.728 | 43/60
		[INFO]  102 | 0.001000 |   2.6987 |   3.5786 |  0.892 |  0.755 | 44/60
		[INFO]  103 | 0.001000 |   2.7395 |   3.6841 |  0.888 |  0.741 | 0/60
		[INFO]  104 | 0.001000 |   2.7462 |   3.7868 |  0.889 |  0.726 | 1/60
		[INFO]  105 | 0.001000 |   2.7135 |   3.6478 |  0.893 |  0.746 | 2/60
		[INFO]  106 | 0.001000 |   2.7185 |   3.8178 |  0.890 |  0.722 | 3/60
		[INFO]  107 | 0.001000 |   2.7791 |   3.7085 |  0.886 |  0.737 | 4/60
		[INFO]  108 | 0.001000 |   2.7020 |   3.7405 |  0.891 |  0.733 | 5/60
		[INFO]  109 | 0.001000 |   2.7336 |   3.6728 |  0.890 |  0.742 | 6/60
		[INFO]  110 | 0.001000 |   2.7236 |   3.9029 |  0.890 |  0.709 | 7/60
		[INFO]  111 | 0.001000 |   2.6484 |   3.9688 |  0.896 |  0.699 | 8/60
		[INFO]  112 | 0.001000 |   2.6705 |   3.8162 |  0.894 |  0.722 | 9/60
		[INFO]  113 | 0.001000 |   2.6800 |   3.7816 |  0.893 |  0.727 | 10/60
		[INFO]  114 | 0.001000 |   2.6867 |   4.7469 |  0.893 |  0.570 | 11/60
		[INFO]  115 | 0.001000 |   2.7249 |   3.8415 |  0.890 |  0.718 | 12/60
		[INFO]  116 | 0.001000 |   2.6804 |   3.8556 |  0.895 |  0.716 | 13/60
		[INFO]  117 | 0.001000 |   2.7331 |   3.7032 |  0.890 |  0.738 | 14/60
		[INFO]  118 | 0.001000 |   2.6687 |   3.6105 |  0.896 |  0.751 | 15/60
		[INFO]  119 | 0.001000 |   2.7600 |   3.8081 |  0.888 |  0.723 | 16/60
		[INFO]  120 | 0.001000 |   2.6791 |   3.6692 |  0.893 |  0.743 | 17/60
		[INFO]  121 | 0.001000 |   2.6686 |   3.8303 |  0.895 |  0.720 | 18/60
		[INFO]  122 | 0.001000 |   2.6360 |   3.9123 |  0.897 |  0.708 | 19/60
		[INFO]  123 | 0.001000 |   2.6786 |   3.7337 |  0.894 |  0.734 | 20/60
		[INFO]  124 | 0.001000 |   2.7410 |   4.2055 |  0.888 |  0.662 | 21/60
		[INFO]  125 | 0.001000 |   2.6684 |   4.0220 |  0.895 |  0.691 | 22/60
		[INFO]  126 | 0.001000 |   2.6509 |   4.1102 |  0.895 |  0.677 | 23/60
		[INFO]  127 | 0.001000 |   2.6635 |   3.7561 |  0.895 |  0.731 | 24/60
		[INFO]  128 | 0.001000 |   2.7181 |   4.1396 |  0.890 |  0.673 | 25/60
		[INFO]  129 | 0.001000 |   2.7181 |   3.7877 |  0.891 |  0.726 | 26/60
		[INFO]  130 | 0.001000 |   2.6543 |   3.6290 |  0.895 |  0.749 | 27/60
		[INFO]  131 | 0.001000 |   2.6664 |   3.8923 |  0.895 |  0.711 | 28/60
		[INFO]  132 | 0.001000 |   2.6742 |   3.9396 |  0.894 |  0.704 | 29/60
		[INFO]  133 | 0.001000 |   2.7042 |   4.0129 |  0.894 |  0.693 | 30/60
		[INFO]  134 | 0.001000 |   2.7185 |   3.9255 |  0.892 |  0.706 | 31/60
		[INFO]  135 | 0.001000 |   2.6870 |   3.8198 |  0.894 |  0.721 | 32/60
		[INFO]  136 | 0.001000 |   2.7127 |   4.2975 |  0.892 |  0.647 | 33/60
		[INFO]  137 | 0.001000 |   2.6479 |   3.5089 |  0.894 |  0.765 | 34/60
		[INFO]  138 | 0.001000 |   2.6929 |   3.8217 |  0.893 |  0.721 | 0/60
		[INFO]  139 | 0.001000 |   2.6487 |   4.0697 |  0.898 |  0.684 | 1/60
		[INFO]  140 | 0.001000 |   2.6596 |   4.1037 |  0.895 |  0.679 | 2/60
		[INFO]  141 | 0.001000 |   2.6679 |   3.9416 |  0.895 |  0.703 | 3/60
		[INFO]  142 | 0.001000 |   2.6797 |   3.6312 |  0.895 |  0.748 | 4/60
		[INFO]  143 | 0.001000 |   2.6317 |   4.1270 |  0.897 |  0.675 | 5/60
		[INFO]  144 | 0.001000 |   2.6517 |   4.1651 |  0.897 |  0.669 | 6/60
		[INFO]  145 | 0.001000 |   2.6204 |   3.7659 |  0.899 |  0.729 | 7/60
		[INFO]  146 | 0.001000 |   2.6121 |   3.7101 |  0.898 |  0.737 | 8/60
		[INFO]  147 | 0.001000 |   2.7137 |   3.6094 |  0.893 |  0.751 | 9/60
		[INFO]  148 | 0.001000 |   2.6346 |   3.7227 |  0.896 |  0.735 | 10/60
		[INFO]  149 | 0.001000 |   2.6987 |   3.8882 |  0.893 |  0.711 | 11/60
		[INFO]  150 | 0.001000 |   2.6489 |   4.0732 |  0.896 |  0.683 | 12/60
		[INFO]  151 | 0.001000 |   2.6445 |   3.9539 |  0.898 |  0.702 | 13/60
		[INFO]  152 | 0.001000 |   2.6661 |   3.7928 |  0.895 |  0.725 | 14/60
		[INFO]  153 | 0.001000 |   2.5729 |   3.7328 |  0.902 |  0.734 | 15/60
		[INFO]  154 | 0.001000 |   2.6277 |   4.0754 |  0.898 |  0.683 | 16/60
		[INFO]  155 | 0.001000 |   2.6019 |   3.7320 |  0.900 |  0.734 | 17/60
		[INFO]  156 | 0.001000 |   2.6108 |   3.5782 |  0.900 |  0.756 | 18/60
		[INFO]  157 | 0.001000 |   2.6278 |   3.5922 |  0.897 |  0.754 | 19/60
		[INFO]  158 | 0.001000 |   2.6064 |   3.9312 |  0.899 |  0.705 | 20/60
		[INFO]  159 | 0.001000 |   2.5880 |   3.5097 |  0.901 |  0.765 | 21/60
		[INFO]  160 | 0.001000 |   2.5623 |   3.7720 |  0.903 |  0.728 | 22/60
		[INFO]  161 | 0.001000 |   2.6843 |   3.7118 |  0.894 |  0.737 | 23/60
		[INFO]  162 | 0.001000 |   2.5997 |   3.7879 |  0.900 |  0.726 | 24/60
		[INFO]  163 | 0.001000 |   2.6925 |   4.1937 |  0.894 |  0.664 | 25/60
		[INFO]  164 | 0.001000 |   2.6617 |   3.9758 |  0.896 |  0.698 | 26/60
		[INFO]  165 | 0.001000 |   2.6169 |   4.0305 |  0.900 |  0.690 | 27/60
		[INFO]  166 | 0.001000 |   2.6129 |   4.1338 |  0.899 |  0.674 | 28/60
		[INFO]  167 | 0.001000 |   2.6074 |   3.6546 |  0.898 |  0.745 | 29/60
		[INFO]  168 | 0.001000 |   2.6419 |   4.0977 |  0.898 |  0.679 | 30/60
		[INFO]  169 | 0.001000 |   2.6476 |   3.6123 |  0.897 |  0.751 | 31/60
		[INFO]  170 | 0.001000 |   2.6474 |   3.7571 |  0.897 |  0.730 | 32/60
		[INFO]  171 | 0.001000 |   2.5982 |   3.6508 |  0.901 |  0.746 | 33/60
		[INFO]  172 | 0.001000 |   2.6204 |   3.7280 |  0.899 |  0.735 | 34/60
		[INFO]  173 | 0.001000 |   2.6174 |   3.9619 |  0.898 |  0.700 | 35/60
		[INFO]  174 | 0.001000 |   2.5716 |   3.9090 |  0.902 |  0.708 | 36/60
		[INFO]  175 | 0.001000 |   2.6526 |   4.0208 |  0.897 |  0.691 | 37/60
		[INFO]  176 | 0.001000 |   2.6526 |   3.9036 |  0.896 |  0.709 | 38/60
		[INFO]  177 | 0.001000 |   2.6045 |   3.6803 |  0.900 |  0.741 | 39/60
		[INFO]  178 | 0.001000 |   2.6634 |   3.6148 |  0.895 |  0.751 | 40/60
		[INFO]  179 | 0.001000 |   2.6689 |   4.0051 |  0.893 |  0.694 | 41/60
		[INFO]  180 | 0.001000 |   2.6474 |   3.9378 |  0.896 |  0.704 | 42/60
		[INFO]  181 | 0.001000 |   2.5857 |   3.6158 |  0.901 |  0.750 | 43/60
		[INFO]  182 | 0.001000 |   2.5942 |   4.0943 |  0.902 |  0.680 | 44/60
		[INFO]  183 | 0.001000 |   2.6586 |   3.7995 |  0.898 |  0.724 | 45/60
		[INFO]  184 | 0.001000 |   2.6144 |   3.6578 |  0.899 |  0.745 | 46/60
		[INFO]  185 | 0.001000 |   2.7046 |   3.9287 |  0.891 |  0.705 | 47/60
		[INFO]  186 | 0.001000 |   2.5808 |   3.8143 |  0.902 |  0.722 | 48/60
		[INFO]  187 | 0.001000 |   2.6309 |   3.7624 |  0.899 |  0.730 | 49/60
		[INFO]  188 | 0.001000 |   2.5910 |   3.8793 |  0.902 |  0.713 | 50/60
		[INFO]  189 | 0.000500 |   2.5702 |   3.6539 |  0.902 |  0.745 | 51/60
		[INFO]  190 | 0.000500 |   2.5056 |   3.6395 |  0.908 |  0.747 | 52/60
		[INFO]  191 | 0.000500 |   2.5735 |   3.4868 |  0.902 |  0.768 | 53/60
		[INFO]  192 | 0.000500 |   2.5243 |   3.6040 |  0.908 |  0.752 | 0/60
		[INFO]  193 | 0.000500 |   2.5061 |   3.6012 |  0.908 |  0.752 | 1/60
		[INFO]  194 | 0.000500 |   2.4985 |   3.4941 |  0.909 |  0.767 | 2/60
		[INFO]  195 | 0.000500 |   2.5152 |   3.7404 |  0.906 |  0.733 | 3/60
		[INFO]  196 | 0.000500 |   2.5116 |   3.9355 |  0.907 |  0.704 | 4/60
		[INFO]  197 | 0.000500 |   2.4890 |   3.7669 |  0.910 |  0.729 | 5/60
		[INFO]  198 | 0.000500 |   2.4945 |   3.8117 |  0.909 |  0.723 | 6/60
		[INFO]  199 | 0.000500 |   2.4588 |   3.8931 |  0.910 |  0.711 | 7/60
		[INFO]  200 | 0.000500 |   2.4718 |   3.9851 |  0.911 |  0.697 | 8/60
		[INFO]  201 | 0.000500 |   2.4467 |   3.6540 |  0.910 |  0.745 | 9/60
		[INFO]  202 | 0.000500 |   2.4800 |   3.9136 |  0.910 |  0.707 | 10/60
		[INFO]  203 | 0.000500 |   2.4512 |   3.9688 |  0.911 |  0.699 | 11/60
		[INFO]  204 | 0.000500 |   2.4545 |   3.5825 |  0.910 |  0.755 | 12/60
		[INFO]  205 | 0.000500 |   2.5330 |   3.8049 |  0.906 |  0.724 | 13/60
		[INFO]  206 | 0.000500 |   2.4538 |   3.7288 |  0.912 |  0.735 | 14/60
		[INFO]  207 | 0.000500 |   2.5006 |   3.8118 |  0.908 |  0.723 | 15/60
		[INFO]  208 | 0.000500 |   2.5335 |   3.9647 |  0.906 |  0.700 | 16/60
		[INFO]  209 | 0.000500 |   2.4895 |   3.6898 |  0.910 |  0.740 | 17/60
		[INFO]  210 | 0.000500 |   2.4740 |   3.8958 |  0.909 |  0.710 | 18/60
		[INFO]  211 | 0.000500 |   2.4496 |   3.8692 |  0.911 |  0.714 | 19/60
		[INFO]  212 | 0.000500 |   2.4908 |   3.6543 |  0.909 |  0.745 | 20/60
		[INFO]  213 | 0.000500 |   2.4182 |   3.7575 |  0.912 |  0.730 | 21/60
		[INFO]  214 | 0.000500 |   2.4844 |   3.7119 |  0.909 |  0.737 | 22/60
		[INFO]  215 | 0.000500 |   2.4722 |   3.7534 |  0.910 |  0.731 | 23/60
		[INFO]  216 | 0.000500 |   2.4706 |   3.9512 |  0.911 |  0.702 | 24/60
		[INFO]  217 | 0.000500 |   2.4888 |   3.5968 |  0.909 |  0.753 | 25/60
		[INFO]  218 | 0.000500 |   2.4028 |   3.9535 |  0.915 |  0.701 | 26/60
		[INFO]  219 | 0.000500 |   2.4894 |   3.6666 |  0.908 |  0.743 | 27/60
		[INFO]  220 | 0.000500 |   2.4999 |   3.9497 |  0.908 |  0.702 | 28/60
		[INFO]  221 | 0.000500 |   2.4425 |   3.8139 |  0.911 |  0.722 | 29/60
		[INFO]  222 | 0.000500 |   2.4488 |   3.6017 |  0.911 |  0.752 | 30/60
		[INFO]  223 | 0.000500 |   2.4728 |   3.6395 |  0.910 |  0.747 | 31/60
		[INFO]  224 | 0.000500 |   2.4372 |   3.6616 |  0.913 |  0.744 | 32/60
		[INFO]  225 | 0.000500 |   2.4540 |   3.8797 |  0.911 |  0.713 | 33/60
		[INFO]  226 | 0.000500 |   2.4052 |   3.6427 |  0.914 |  0.747 | 34/60
		[INFO]  227 | 0.000500 |   2.4182 |   3.6650 |  0.914 |  0.744 | 35/60
		[INFO]  228 | 0.000500 |   2.4310 |   4.0860 |  0.911 |  0.681 | 36/60
		[INFO]  229 | 0.000500 |   2.5423 |   4.0087 |  0.906 |  0.693 | 37/60
		[INFO]  230 | 0.000500 |   2.5228 |   3.9453 |  0.906 |  0.703 | 38/60
		[INFO]  231 | 0.000500 |   2.4967 |   3.9452 |  0.908 |  0.703 | 39/60
		[INFO]  232 | 0.000500 |   2.4269 |   3.5622 |  0.913 |  0.758 | 40/60
		[INFO]  233 | 0.000500 |   2.4279 |   3.5702 |  0.912 |  0.757 | 41/60
		[INFO]  234 | 0.000500 |   2.4338 |   3.9017 |  0.912 |  0.709 | 42/60
		[INFO]  235 | 0.000500 |   2.4660 |   3.4730 |  0.910 |  0.770 | 43/60
		[INFO]  236 | 0.000500 |   2.4528 |   3.8607 |  0.911 |  0.715 | 0/60
		[INFO]  237 | 0.000500 |   2.4667 |   3.6089 |  0.910 |  0.751 | 1/60
		[INFO]  238 | 0.000500 |   2.4461 |   3.7566 |  0.911 |  0.731 | 2/60
		[INFO]  239 | 0.000500 |   2.4627 |   3.8722 |  0.911 |  0.714 | 3/60
		[INFO]  240 | 0.000500 |   2.4530 |   3.7065 |  0.911 |  0.738 | 4/60
		[INFO]  241 | 0.000500 |   2.4785 |   3.8624 |  0.910 |  0.715 | 5/60
		[INFO]  242 | 0.000500 |   2.4630 |   3.7894 |  0.910 |  0.726 | 6/60
		[INFO]  243 | 0.000500 |   2.4991 |   3.8200 |  0.908 |  0.721 | 7/60
		[INFO]  244 | 0.000500 |   2.4654 |   3.5816 |  0.910 |  0.755 | 8/60
		[INFO]  245 | 0.000500 |   2.4216 |   4.1430 |  0.912 |  0.672 | 9/60
		[INFO]  246 | 0.000500 |   2.4452 |   3.6223 |  0.911 |  0.750 | 10/60
		[INFO]  247 | 0.000500 |   2.4493 |   3.5004 |  0.911 |  0.766 | 11/60
		[INFO]  248 | 0.000500 |   2.4504 |   3.5803 |  0.912 |  0.755 | 12/60
		[INFO]  249 | 0.000500 |   2.4308 |   3.6719 |  0.912 |  0.743 | 13/60
		[INFO]  250 | 0.000500 |   2.4880 |   3.9849 |  0.909 |  0.697 | 14/60
		[INFO]  251 | 0.000500 |   2.4415 |   3.4911 |  0.911 |  0.767 | 15/60
		[INFO]  252 | 0.000500 |   2.4403 |   3.7026 |  0.911 |  0.738 | 16/60
		[INFO]  253 | 0.000500 |   2.4583 |   3.7563 |  0.911 |  0.731 | 17/60
		[INFO]  254 | 0.000500 |   2.4569 |   3.6412 |  0.912 |  0.747 | 18/60
		[INFO]  255 | 0.000500 |   2.4208 |   3.6375 |  0.914 |  0.747 | 19/60
		[INFO]  256 | 0.000500 |   2.5071 |   3.8484 |  0.907 |  0.717 | 20/60
		[INFO]  257 | 0.000500 |   2.4307 |   3.8712 |  0.912 |  0.714 | 21/60
		[INFO]  258 | 0.000500 |   2.4307 |   3.6793 |  0.913 |  0.742 | 22/60
		[INFO]  259 | 0.000500 |   2.4879 |   3.6616 |  0.908 |  0.744 | 23/60
		[INFO]  260 | 0.000500 |   2.4138 |   3.8323 |  0.914 |  0.720 | 24/60
		[INFO]  261 | 0.000500 |   2.4632 |   3.6983 |  0.909 |  0.739 | 25/60
		[INFO]  262 | 0.000500 |   2.4033 |   3.8067 |  0.915 |  0.723 | 26/60
		[INFO]  263 | 0.000500 |   2.4469 |   3.8408 |  0.912 |  0.718 | 27/60
		[INFO]  264 | 0.000500 |   2.4531 |   3.6812 |  0.912 |  0.741 | 28/60
		[INFO]  265 | 0.000500 |   2.4152 |   3.7043 |  0.914 |  0.738 | 29/60
		[INFO]  266 | 0.000500 |   2.4633 |   3.5734 |  0.912 |  0.756 | 30/60
		[INFO]  267 | 0.000500 |   2.4563 |   3.4550 |  0.912 |  0.772 | 31/60
		[INFO]  268 | 0.000500 |   2.4789 |   3.7958 |  0.911 |  0.725 | 0/60
		[INFO]  269 | 0.000500 |   2.4822 |   3.9889 |  0.909 |  0.696 | 1/60
		[INFO]  270 | 0.000500 |   2.4404 |   3.8455 |  0.912 |  0.718 | 2/60
		[INFO]  271 | 0.000500 |   2.4182 |   3.6074 |  0.914 |  0.752 | 3/60
		[INFO]  272 | 0.000500 |   2.4140 |   3.7996 |  0.914 |  0.724 | 4/60
		[INFO]  273 | 0.000500 |   2.4143 |   3.7004 |  0.913 |  0.739 | 5/60
		[INFO]  274 | 0.000500 |   2.4387 |   3.6130 |  0.913 |  0.751 | 6/60
		[INFO]  275 | 0.000500 |   2.3921 |   3.5997 |  0.914 |  0.753 | 7/60
		[INFO]  276 | 0.000500 |   2.4055 |   3.8717 |  0.915 |  0.714 | 8/60
		[INFO]  277 | 0.000500 |   2.4764 |   3.7119 |  0.908 |  0.737 | 9/60
		[INFO]  278 | 0.000500 |   2.4565 |   3.8080 |  0.911 |  0.723 | 10/60
		[INFO]  279 | 0.000500 |   2.4501 |   3.9399 |  0.912 |  0.704 | 11/60
		[INFO]  280 | 0.000500 |   2.4552 |   4.0476 |  0.912 |  0.687 | 12/60
		[INFO]  281 | 0.000500 |   2.4275 |   3.7761 |  0.913 |  0.728 | 13/60
		[INFO]  282 | 0.000500 |   2.4332 |   3.8536 |  0.912 |  0.716 | 14/60
		[INFO]  283 | 0.000500 |   2.4260 |   3.6490 |  0.913 |  0.746 | 15/60
		[INFO]  284 | 0.000500 |   2.4453 |   3.9024 |  0.911 |  0.709 | 16/60
		[INFO]  285 | 0.000500 |   2.4484 |   3.9052 |  0.911 |  0.709 | 17/60
		[INFO]  286 | 0.000500 |   2.4455 |   3.9039 |  0.910 |  0.709 | 18/60
		[INFO]  287 | 0.000500 |   2.4302 |   3.5624 |  0.912 |  0.758 | 19/60
		[INFO]  288 | 0.000500 |   2.4258 |   3.7283 |  0.913 |  0.735 | 20/60
		[INFO]  289 | 0.000500 |   2.4636 |   3.6686 |  0.909 |  0.743 | 21/60
		[INFO]  290 | 0.000500 |   2.3951 |   3.8145 |  0.916 |  0.722 | 22/60
		[INFO]  291 | 0.000500 |   2.5043 |   3.8247 |  0.909 |  0.721 | 23/60
		[INFO]  292 | 0.000500 |   2.3987 |   3.8303 |  0.915 |  0.720 | 24/60
		[INFO]  293 | 0.000500 |   2.4313 |   4.1934 |  0.914 |  0.664 | 25/60
		[INFO]  294 | 0.000500 |   2.4637 |   3.6717 |  0.911 |  0.743 | 26/60
		[INFO]  295 | 0.000500 |   2.4081 |   3.7880 |  0.914 |  0.726 | 27/60
		[INFO]  296 | 0.000500 |   2.4632 |   3.6118 |  0.911 |  0.751 | 28/60
		[INFO]  297 | 0.000500 |   2.4673 |   3.6096 |  0.910 |  0.751 | 29/60
		[INFO]  298 | 0.000500 |   2.4717 |   3.6806 |  0.911 |  0.741 | 30/60
		[INFO]  299 | 0.000500 |   2.3430 |   3.6412 |  0.919 |  0.747 | 31/60
		[INFO]  300 | 0.000500 |   2.4559 |   3.9138 |  0.910 |  0.707 | 32/60
		[INFO]  301 | 0.000500 |   2.4397 |   3.8907 |  0.912 |  0.711 | 33/60
		[INFO]  302 | 0.000500 |   2.4157 |   3.7986 |  0.913 |  0.724 | 34/60
		[INFO]  303 | 0.000500 |   2.4032 |   3.8469 |  0.915 |  0.717 | 35/60
		[INFO]  304 | 0.000500 |   2.4269 |   4.0071 |  0.912 |  0.693 | 36/60
		[INFO]  305 | 0.000500 |   2.4143 |   3.5697 |  0.915 |  0.757 | 37/60
		[INFO]  306 | 0.000500 |   2.4906 |   3.5571 |  0.909 |  0.758 | 38/60
		[INFO]  307 | 0.000500 |   2.3942 |   3.5863 |  0.914 |  0.754 | 39/60
		[INFO]  308 | 0.000500 |   2.5056 |   3.6767 |  0.908 |  0.742 | 40/60
		[INFO]  309 | 0.000500 |   2.4225 |   4.0039 |  0.914 |  0.694 | 41/60
		[INFO]  310 | 0.000500 |   2.4085 |   3.8676 |  0.915 |  0.714 | 42/60
		[INFO]  311 | 0.000500 |   2.4086 |   3.8870 |  0.914 |  0.712 | 43/60
		[INFO]  312 | 0.000500 |   2.4219 |   3.7250 |  0.912 |  0.735 | 44/60
		[INFO]  313 | 0.000500 |   2.4472 |   3.9990 |  0.911 |  0.695 | 45/60
		[INFO]  314 | 0.000500 |   2.3883 |   3.9105 |  0.915 |  0.708 | 46/60
		[INFO]  315 | 0.000500 |   2.4245 |   3.7581 |  0.912 |  0.730 | 47/60
		[INFO]  316 | 0.000500 |   2.4272 |   3.8473 |  0.913 |  0.717 | 48/60
		[INFO]  317 | 0.000500 |   2.3911 |   3.7189 |  0.915 |  0.736 | 49/60
		[INFO]  318 | 0.000500 |   2.4389 |   3.9178 |  0.912 |  0.707 | 50/60
		[INFO]  319 | 0.000250 |   2.4163 |   3.5969 |  0.913 |  0.753 | 51/60
		[INFO]  320 | 0.000250 |   2.4169 |   3.7287 |  0.914 |  0.735 | 52/60
		[INFO]  321 | 0.000250 |   2.3506 |   4.0496 |  0.919 |  0.687 | 53/60
		[INFO]  322 | 0.000250 |   2.3676 |   3.7492 |  0.918 |  0.732 | 54/60
		[INFO]  323 | 0.000250 |   2.3894 |   4.0819 |  0.916 |  0.682 | 55/60
		[INFO]  324 | 0.000250 |   2.3723 |   3.6588 |  0.917 |  0.744 | 56/60
		[INFO]  325 | 0.000250 |   2.3873 |   3.5209 |  0.916 |  0.763 | 57/60
		[INFO]  326 | 0.000250 |   2.3306 |   3.6902 |  0.919 |  0.740 | 58/60
		[INFO]  327 | 0.000250 |   2.4071 |   4.1858 |  0.915 |  0.665 | 59/60

[Stopping] Early stopping triggered after 327 epochs.
Training Complete. Results saved to: ./data/training_results/STAF_currentSOC_V6_CASE2
		[INFO] Case 2 completed.

	3.1 Training Case 1...

=== Starting Training Run: STAF_currentSOC_V6_CASE1 ===
Device: cuda
		[INFO] Starting Preprocessing for Case 1...
		[INFO] Unique quantized indices: 6686
		[INFO] Suggested num_embeddings: 8023
		[INFO] Generating sliding windows...
Column names ['sin_hour', 'cos_hour', 'sin_day', 'cos_day', 'building_T1', 'building_T2', 'building_T3', 'building_T4', 'building_T5', 'building_T6', 'building_T7', 'building_T8', 'building_T9', 'building_T10', 'building_T11', 'building_T12', 'building_T13', 'building_T14', 'building_T15', 'building_T16', 'building_T17', 'building_T18', 'building_T19', 'building_T20', 'building_T21', 'building_T22', 'building_T23', 'building_T24', 'radiation_T1', 'radiation_T2', 'radiation_T3', 'radiation_T4', 'radiation_T5', 'radiation_T6', 'radiation_T7', 'radiation_T8', 'radiation_T9', 'radiation_T10', 'radiation_T11', 'radiation_T12', 'radiation_T13', 'radiation_T14', 'radiation_T15', 'radiation_T16', 'radiation_T17', 'radiation_T18', 'radiation_T19', 'radiation_T20', 'radiation_T21', 'radiation_T22', 'radiation_T23', 'radiation_T24', 'temperature_T1', 'temperature_T2', 'temperature_T3', 'temperature_T4', 'temperature_T5', 'temperature_T6', 'temperature_T7', 'temperature_T8', 'temperature_T9', 'temperature_T10', 'temperature_T11', 'temperature_T12', 'temperature_T13', 'temperature_T14', 'temperature_T15', 'temperature_T16', 'temperature_T17', 'temperature_T18', 'temperature_T19', 'temperature_T20', 'temperature_T21', 'temperature_T22', 'temperature_T23', 'temperature_T24', 'priceG2B_T1', 'priceG2B_T2', 'priceG2B_T3', 'priceG2B_T4', 'priceG2B_T5', 'priceG2B_T6', 'priceG2B_T7', 'priceG2B_T8', 'priceG2B_T9', 'priceG2B_T10', 'priceG2B_T11', 'priceG2B_T12', 'priceG2B_T13', 'priceG2B_T14', 'priceG2B_T15', 'priceG2B_T16', 'priceG2B_T17', 'priceG2B_T18', 'priceG2B_T19', 'priceG2B_T20', 'priceG2B_T21', 'priceG2B_T22', 'priceG2B_T23', 'priceG2B_T24', 'priceG2V_T1', 'priceG2V_T2', 'priceG2V_T3', 'priceG2V_T4', 'priceG2V_T5', 'priceG2V_T6', 'priceG2V_T7', 'priceG2V_T8', 'priceG2V_T9', 'priceG2V_T10', 'priceG2V_T11', 'priceG2V_T12', 'priceG2V_T13', 'priceG2V_T14', 'priceG2V_T15', 'priceG2V_T16', 'priceG2V_T17', 'priceG2V_T18', 'priceG2V_T19', 'priceG2V_T20', 'priceG2V_T21', 'priceG2V_T22', 'priceG2V_T23', 'priceG2V_T24', 'battery_T1', 'battery_T2', 'battery_T3', 'battery_T4', 'battery_T5', 'battery_T6', 'battery_T7', 'battery_T8', 'battery_T9', 'battery_T10', 'battery_T11', 'battery_T12', 'battery_T13', 'battery_T14', 'battery_T15', 'battery_T16', 'battery_T17', 'battery_T18', 'battery_T19', 'battery_T20', 'battery_T21', 'battery_T22', 'battery_T23', 'battery_T24', 'SOC_V1', 'SOC_V2', 'SOC_V3', 'SOC_V4', 'SOC_V5', 'SOC_V6', 'SOC_V7', 'SOC_V8', 'SOC_V9', 'SOC_V10', 'SOC_V11', 'SOC_V12', 'SOC_V13', 'SOC_V14', 'SOC_V15', 'SOC_V16', 'SOC_V17', 'SOC_V18', 'SOC_V19', 'SOC_V20', 'SOC_V21', 'SOC_V22', 'SOC_V23', 'SOC_V24', 'SOC_V25', 'SOC_V26', 'SOC_V27', 'SOC_V28', 'SOC_V29', 'SOC_V30', 'SOC_V31', 'SOC_V32', 'SOC_V33', 'SOC_V34', 'SOC_V35', 'SOC_V36', 'SOC_V37', 'SOC_V38', 'SOC_V39', 'SOC_V40', 'SOC_V41', 'SOC_V42', 'SOC_V43', 'SOC_V44', 'SOC_V45', 'SOC_V46', 'SOC_V47', 'SOC_V48', 'SOC_V49', 'SOC_V50', 'SOC_V51', 'SOC_V52', 'SOC_V53', 'SOC_V54', 'SOC_V55', 'SOC_V56', 'SOC_V57', 'SOC_V58', 'SOC_V59', 'SOC_V60', 'SOC_V61', 'SOC_V62', 'SOC_V63', 'SOC_V64', 'SOC_V65', 'SOC_V66', 'SOC_V67', 'SOC_V68', 'SOC_V69', 'SOC_V70', 'SOC_V71', 'SOC_V72', 'SOC_V73', 'SOC_V74', 'SOC_V75', 'SOC_V76', 'target']
Number of columns: 225
Number of rows: 2016
		[INFO] Saved dataset: ./data/training_results/STAF_currentSOC_V6_CASE1/merged_dataset_STAF_currentSOC_V6_CASE1.csv (Shape: (2016, 225))
		[INFO] Saved metadata: ./data/training_results/STAF_currentSOC_V6_CASE1/feature_info_STAF_currentSOC_V6_CASE1.json
	[Model Config] Detected Dims: {'static': 4, 'series_count': 6, 'seq_len': 24, 'vehicle': 76, 'emb_vocab': 1000}
		[INFO] Data loaded. Train: 1411, Val: 605
		[INFO] Fitting new scalers on training data...
		[INFO] Calculating weights for imbalanced regression...
		[INFO] 
==================================================
		[INFO] ðŸš€ TRAINING SESSION: STAF_currentSOC_V6_CASE1
		[INFO] ==================================================
		[INFO] Device:             cuda
		[INFO] Model Parameters:   83,530
		[INFO] --------------------------------------------------
		[INFO] Epochs:             5000
		[INFO] Batch Size:         32
		[INFO] Learning Rate:      0.001
		[INFO] Weight Decay:       0.001
		[INFO] Dropout:            0.3
		[INFO] --------------------------------------------------
		[INFO] Hidden Layers:      [256, 64]
		[INFO] Embedding Dim:      8
		[INFO] Attention Heads:    4
		[INFO]==================================================


		[INFO]Epoch |    LR    | Trn RMSE | Val RMSE | Trn R2 | Val R2 | Stop
-----------------------------------------------------------------
		[INFO]    1 | 0.001000 |   6.9374 |   9.1160 |  0.255 | -0.624 | 0/60
		[INFO]    2 | 0.001000 |   5.8621 |   7.1977 |  0.495 | -0.013 | 0/60
		[INFO]    3 | 0.001000 |   4.8393 |   6.8865 |  0.660 |  0.074 | 0/60
		[INFO]    4 | 0.001000 |   4.1363 |   5.9511 |  0.742 |  0.308 | 0/60
		[INFO]    5 | 0.001000 |   4.0489 |   5.6159 |  0.782 |  0.384 | 0/60
		[INFO]    6 | 0.001000 |   3.7191 |   5.4255 |  0.786 |  0.425 | 0/60
		[INFO]    7 | 0.001000 |   3.8490 |   5.0682 |  0.809 |  0.498 | 0/60
		[INFO]    8 | 0.001000 |   3.7804 |   5.1895 |  0.816 |  0.474 | 0/60
		[INFO]    9 | 0.001000 |   3.6283 |   5.1680 |  0.806 |  0.478 | 1/60
		[INFO]   10 | 0.001000 |   3.5943 |   5.2404 |  0.804 |  0.463 | 2/60
		[INFO]   11 | 0.001000 |   3.5083 |   5.5716 |  0.828 |  0.393 | 3/60
		[INFO]   12 | 0.001000 |   3.8304 |   5.9418 |  0.793 |  0.310 | 4/60
		[INFO]   13 | 0.001000 |   3.4881 |   4.9166 |  0.813 |  0.527 | 5/60
		[INFO]   14 | 0.001000 |   3.3879 |   5.0491 |  0.826 |  0.502 | 0/60
		[INFO]   15 | 0.001000 |   3.0770 |   5.0538 |  0.856 |  0.501 | 1/60
		[INFO]   16 | 0.001000 |   3.2606 |   5.2446 |  0.851 |  0.462 | 2/60
		[INFO]   17 | 0.001000 |   3.2848 |   5.3347 |  0.841 |  0.444 | 3/60
		[INFO]   18 | 0.001000 |   3.3673 |   5.1647 |  0.828 |  0.478 | 4/60
		[INFO]   19 | 0.001000 |   3.1188 |   4.9154 |  0.852 |  0.527 | 5/60
		[INFO]   20 | 0.001000 |   3.5518 |   5.3024 |  0.829 |  0.450 | 0/60
		[INFO]   21 | 0.001000 |   3.2441 |   4.9244 |  0.847 |  0.526 | 1/60
		[INFO]   22 | 0.001000 |   3.1638 |   4.9062 |  0.855 |  0.529 | 2/60
		[INFO]   23 | 0.001000 |   3.6259 |   5.6960 |  0.844 |  0.366 | 0/60
		[INFO]   24 | 0.001000 |   3.2332 |   5.0636 |  0.845 |  0.499 | 1/60
		[INFO]   25 | 0.001000 |   3.4145 |   4.4647 |  0.837 |  0.610 | 2/60
		[INFO]   26 | 0.001000 |   3.1373 |   4.7024 |  0.853 |  0.567 | 0/60
		[INFO]   27 | 0.001000 |   3.1742 |   4.6767 |  0.859 |  0.572 | 1/60
		[INFO]   28 | 0.001000 |   3.1919 |   4.8511 |  0.852 |  0.540 | 2/60
		[INFO]   29 | 0.001000 |   3.2503 |   4.6486 |  0.852 |  0.577 | 3/60
		[INFO]   30 | 0.001000 |   3.5521 |   4.6037 |  0.846 |  0.586 | 4/60
		[INFO]   31 | 0.001000 |   3.5655 |   4.5869 |  0.844 |  0.588 | 5/60
		[INFO]   32 | 0.001000 |   3.6168 |   5.4163 |  0.833 |  0.427 | 6/60
		[INFO]   33 | 0.001000 |   3.2280 |   5.0209 |  0.848 |  0.507 | 7/60
		[INFO]   34 | 0.001000 |   3.0909 |   4.6377 |  0.856 |  0.579 | 8/60
		[INFO]   35 | 0.001000 |   2.9158 |   4.7895 |  0.870 |  0.551 | 9/60
		[INFO]   36 | 0.001000 |   3.2392 |   5.4023 |  0.844 |  0.429 | 10/60
		[INFO]   37 | 0.001000 |   3.5407 |   4.8317 |  0.865 |  0.543 | 11/60
		[INFO]   38 | 0.001000 |   3.0291 |   4.5054 |  0.858 |  0.603 | 12/60
		[INFO]   39 | 0.001000 |   3.5025 |   4.9833 |  0.842 |  0.514 | 13/60
		[INFO]   40 | 0.001000 |   3.3122 |   4.7255 |  0.845 |  0.563 | 14/60
		[INFO]   41 | 0.001000 |   3.2481 |   4.6604 |  0.854 |  0.575 | 15/60
		[INFO]   42 | 0.001000 |   2.9750 |   4.6544 |  0.871 |  0.576 | 16/60
		[INFO]   43 | 0.001000 |   2.9787 |   5.0933 |  0.869 |  0.493 | 17/60
		[INFO]   44 | 0.001000 |   3.1844 |   4.5133 |  0.882 |  0.602 | 18/60
		[INFO]   45 | 0.001000 |   3.1665 |   5.2588 |  0.854 |  0.459 | 19/60
		[INFO]   46 | 0.001000 |   3.2941 |   5.0586 |  0.848 |  0.499 | 20/60
		[INFO]   47 | 0.001000 |   2.8171 |   5.2547 |  0.881 |  0.460 | 21/60
		[INFO]   48 | 0.001000 |   2.9447 |   4.6069 |  0.863 |  0.585 | 22/60
		[INFO]   49 | 0.001000 |   3.1173 |   4.3860 |  0.867 |  0.624 | 23/60
		[INFO]   50 | 0.001000 |   3.1174 |   5.1572 |  0.858 |  0.480 | 0/60
		[INFO]   51 | 0.001000 |   3.3243 |   4.4400 |  0.867 |  0.614 | 1/60
		[INFO]   52 | 0.001000 |   3.0022 |   4.7258 |  0.873 |  0.563 | 2/60
		[INFO]   53 | 0.001000 |   3.1166 |   4.4209 |  0.869 |  0.617 | 3/60
		[INFO]   54 | 0.001000 |   2.8991 |   4.8302 |  0.871 |  0.543 | 4/60
		[INFO]   55 | 0.001000 |   2.8308 |   4.5356 |  0.884 |  0.598 | 5/60
		[INFO]   56 | 0.001000 |   2.9302 |   4.3841 |  0.872 |  0.624 | 6/60
		[INFO]   57 | 0.001000 |   2.8781 |   4.6276 |  0.870 |  0.581 | 0/60
		[INFO]   58 | 0.001000 |   3.0231 |   4.6852 |  0.872 |  0.571 | 1/60
		[INFO]   59 | 0.001000 |   2.8613 |   4.6502 |  0.885 |  0.577 | 2/60
		[INFO]   60 | 0.001000 |   3.3902 |   5.0993 |  0.847 |  0.492 | 3/60
		[INFO]   61 | 0.001000 |   3.3438 |   4.8462 |  0.849 |  0.541 | 4/60
		[INFO]   62 | 0.001000 |   3.0744 |   4.6121 |  0.868 |  0.584 | 5/60
		[INFO]   63 | 0.001000 |   3.1935 |   4.6280 |  0.867 |  0.581 | 6/60
		[INFO]   64 | 0.001000 |   3.0774 |   4.3782 |  0.869 |  0.625 | 7/60
		[INFO]   65 | 0.001000 |   3.0084 |   4.6441 |  0.868 |  0.578 | 0/60
		[INFO]   66 | 0.001000 |   3.0027 |   4.8917 |  0.868 |  0.532 | 1/60
		[INFO]   67 | 0.001000 |   3.0661 |   4.4037 |  0.872 |  0.620 | 2/60
		[INFO]   68 | 0.001000 |   2.9854 |   4.6780 |  0.868 |  0.572 | 3/60
		[INFO]   69 | 0.001000 |   3.0039 |   4.5189 |  0.879 |  0.600 | 4/60
		[INFO]   70 | 0.001000 |   3.0655 |   4.6706 |  0.857 |  0.573 | 5/60
		[INFO]   71 | 0.001000 |   2.8190 |   4.4900 |  0.889 |  0.605 | 6/60
		[INFO]   72 | 0.001000 |   2.8994 |   4.2968 |  0.884 |  0.639 | 7/60
		[INFO]   73 | 0.001000 |   2.8970 |   4.4041 |  0.878 |  0.620 | 0/60
		[INFO]   74 | 0.001000 |   2.7259 |   4.6205 |  0.894 |  0.582 | 1/60
		[INFO]   75 | 0.001000 |   3.1286 |   4.4872 |  0.886 |  0.606 | 2/60
		[INFO]   76 | 0.001000 |   2.9144 |   4.5267 |  0.879 |  0.599 | 3/60
		[INFO]   77 | 0.001000 |   2.6941 |   4.7750 |  0.898 |  0.554 | 4/60
		[INFO]   78 | 0.001000 |   2.7563 |   4.2681 |  0.887 |  0.643 | 5/60
		[INFO]   79 | 0.001000 |   3.0785 |   4.6441 |  0.877 |  0.578 | 0/60
		[INFO]   80 | 0.001000 |   2.8194 |   4.5680 |  0.898 |  0.592 | 1/60
		[INFO]   81 | 0.001000 |   3.2426 |   4.5927 |  0.853 |  0.587 | 2/60
		[INFO]   82 | 0.001000 |   2.9098 |   4.6860 |  0.874 |  0.570 | 3/60
		[INFO]   83 | 0.001000 |   2.7386 |   4.6206 |  0.887 |  0.582 | 4/60
		[INFO]   84 | 0.001000 |   2.9941 |   4.6188 |  0.879 |  0.583 | 5/60
		[INFO]   85 | 0.001000 |   2.9403 |   4.5057 |  0.875 |  0.603 | 6/60
		[INFO]   86 | 0.001000 |   3.0731 |   4.2973 |  0.874 |  0.639 | 7/60
		[INFO]   87 | 0.001000 |   2.7948 |   4.4925 |  0.883 |  0.605 | 8/60
		[INFO]   88 | 0.001000 |   2.8377 |   4.9431 |  0.881 |  0.522 | 9/60
		[INFO]   89 | 0.001000 |   2.8352 |   4.1592 |  0.891 |  0.661 | 10/60
		[INFO]   90 | 0.001000 |   2.9403 |   4.0472 |  0.883 |  0.679 | 0/60
		[INFO]   91 | 0.001000 |   2.8394 |   4.5595 |  0.885 |  0.593 | 0/60
		[INFO]   92 | 0.001000 |   3.0036 |   4.8308 |  0.875 |  0.543 | 1/60
		[INFO]   93 | 0.001000 |   2.9342 |   4.7437 |  0.883 |  0.560 | 2/60
		[INFO]   94 | 0.001000 |   2.7017 |   5.1256 |  0.890 |  0.486 | 3/60
		[INFO]   95 | 0.001000 |   2.8920 |   4.1287 |  0.897 |  0.666 | 4/60
		[INFO]   96 | 0.001000 |   2.6673 |   4.4474 |  0.895 |  0.613 | 5/60
		[INFO]   97 | 0.001000 |   2.5195 |   4.2938 |  0.901 |  0.639 | 6/60
		[INFO]   98 | 0.001000 |   2.7500 |   4.5397 |  0.891 |  0.597 | 7/60
		[INFO]   99 | 0.001000 |   2.8753 |   4.2172 |  0.885 |  0.652 | 8/60
		[INFO]  100 | 0.001000 |   3.1284 |   4.6472 |  0.869 |  0.578 | 9/60
		[INFO]  101 | 0.001000 |   2.9298 |   4.4583 |  0.876 |  0.611 | 10/60
		[INFO]  102 | 0.001000 |   2.9048 |   4.2663 |  0.888 |  0.644 | 11/60
		[INFO]  103 | 0.001000 |   2.7029 |   4.7092 |  0.897 |  0.566 | 12/60
		[INFO]  104 | 0.001000 |   2.7369 |   4.3609 |  0.887 |  0.628 | 13/60
		[INFO]  105 | 0.001000 |   2.6371 |   4.4422 |  0.893 |  0.614 | 14/60
		[INFO]  106 | 0.001000 |   2.8197 |   4.7253 |  0.878 |  0.563 | 15/60
		[INFO]  107 | 0.001000 |   2.7707 |   4.3650 |  0.893 |  0.627 | 16/60
		[INFO]  108 | 0.001000 |   2.8752 |   4.2841 |  0.897 |  0.641 | 17/60
		[INFO]  109 | 0.001000 |   2.6828 |   4.3902 |  0.892 |  0.623 | 18/60
		[INFO]  110 | 0.001000 |   2.9139 |   4.2348 |  0.896 |  0.649 | 19/60
		[INFO]  111 | 0.001000 |   2.7495 |   4.4700 |  0.893 |  0.609 | 20/60
		[INFO]  112 | 0.001000 |   3.1189 |   4.4802 |  0.875 |  0.607 | 21/60
		[INFO]  113 | 0.001000 |   2.8190 |   4.3747 |  0.880 |  0.625 | 22/60
		[INFO]  114 | 0.001000 |   2.9248 |   4.3567 |  0.884 |  0.628 | 23/60
		[INFO]  115 | 0.001000 |   3.0184 |   4.5123 |  0.869 |  0.601 | 24/60
		[INFO]  116 | 0.001000 |   2.6061 |   4.7865 |  0.897 |  0.552 | 25/60
		[INFO]  117 | 0.001000 |   2.6429 |   4.4113 |  0.905 |  0.619 | 26/60
		[INFO]  118 | 0.001000 |   2.8297 |   4.5938 |  0.892 |  0.587 | 27/60
		[INFO]  119 | 0.001000 |   2.9027 |   4.2217 |  0.899 |  0.651 | 28/60
		[INFO]  120 | 0.001000 |   3.2925 |   5.4132 |  0.866 |  0.427 | 29/60
		[INFO]  121 | 0.001000 |   2.8392 |   4.6160 |  0.880 |  0.583 | 30/60
		[INFO]  122 | 0.001000 |   2.6301 |   4.3148 |  0.895 |  0.636 | 31/60
		[INFO]  123 | 0.001000 |   2.7864 |   4.5717 |  0.886 |  0.591 | 32/60
		[INFO]  124 | 0.001000 |   2.7945 |   5.0132 |  0.880 |  0.508 | 33/60
		[INFO]  125 | 0.001000 |   2.5248 |   4.6666 |  0.908 |  0.574 | 34/60
		[INFO]  126 | 0.001000 |   3.3600 |   4.5473 |  0.888 |  0.595 | 35/60
		[INFO]  127 | 0.001000 |   2.6589 |   4.3388 |  0.896 |  0.632 | 36/60
		[INFO]  128 | 0.001000 |   2.9922 |   4.6716 |  0.897 |  0.573 | 37/60
		[INFO]  129 | 0.001000 |   3.0022 |   4.2452 |  0.889 |  0.647 | 38/60
		[INFO]  130 | 0.001000 |   2.9037 |   4.5208 |  0.871 |  0.600 | 39/60
		[INFO]  131 | 0.001000 |   2.8978 |   4.6040 |  0.882 |  0.585 | 40/60
		[INFO]  132 | 0.001000 |   2.8482 |   4.4351 |  0.889 |  0.615 | 41/60
		[INFO]  133 | 0.001000 |   2.5271 |   4.2776 |  0.907 |  0.642 | 42/60
		[INFO]  134 | 0.001000 |   3.3629 |   4.7231 |  0.884 |  0.563 | 43/60
		[INFO]  135 | 0.001000 |   2.7077 |   4.7278 |  0.895 |  0.563 | 44/60
		[INFO]  136 | 0.001000 |   2.5914 |   4.3449 |  0.900 |  0.631 | 45/60
		[INFO]  137 | 0.001000 |   2.4862 |   4.2148 |  0.904 |  0.652 | 46/60
		[INFO]  138 | 0.001000 |   3.0593 |   4.3578 |  0.875 |  0.628 | 47/60
		[INFO]  139 | 0.001000 |   3.0885 |   4.4566 |  0.883 |  0.611 | 48/60
		[INFO]  140 | 0.001000 |   2.7384 |   4.9949 |  0.893 |  0.512 | 49/60
		[INFO]  141 | 0.001000 |   2.4879 |   4.5971 |  0.908 |  0.586 | 50/60
		[INFO]  142 | 0.000500 |   2.8322 |   4.4169 |  0.898 |  0.618 | 51/60
		[INFO]  143 | 0.000500 |   2.6439 |   4.3461 |  0.894 |  0.630 | 52/60
		[INFO]  144 | 0.000500 |   2.5167 |   4.7810 |  0.903 |  0.553 | 53/60
		[INFO]  145 | 0.000500 |   2.7428 |   4.5493 |  0.897 |  0.595 | 54/60
		[INFO]  146 | 0.000500 |   2.8664 |   4.5244 |  0.884 |  0.599 | 55/60
		[INFO]  147 | 0.000500 |   2.6839 |   4.2698 |  0.895 |  0.643 | 56/60
		[INFO]  148 | 0.000500 |   2.5764 |   5.1989 |  0.910 |  0.471 | 57/60
		[INFO]  149 | 0.000500 |   2.5343 |   4.2419 |  0.908 |  0.648 | 58/60
/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/testcase/testcaseV4.py:208: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = STAF(dims["static"], dims["series"], dims["seq"], dims["veh"], dims["vocab"],
/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/testcase/testcaseV4.py:208: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = STAF(dims["static"], dims["series"], dims["seq"], dims["veh"], dims["vocab"],
		[INFO]  150 | 0.000500 |   2.5831 |   4.1595 |  0.899 |  0.661 | 59/60

[Stopping] Early stopping triggered after 150 epochs.
Training Complete. Results saved to: ./data/training_results/STAF_currentSOC_V6_CASE1
		[INFO] Case 1 completed.


==================================================
PART 4: Testing...
==================================================

	4.2 Testing Case 2...
ðŸš€ Starting Dynamic Simulation (Updating SOC per hour)
[INFO] Loading Initial State from Optimization file...
Initial SOC State: (2, 48, 272)
Initial SOC State: (272,)
battery_detail (4, 2, 272)
(272,)
Hour 24: AI Request=7.38kW | Executed=0.00kW | Avg SOC=0.20
battery_detail (4, 2, 272)
(272,)
Hour 25: AI Request=8.10kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 26: AI Request=7.70kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 27: AI Request=7.41kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 28: AI Request=7.13kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 29: AI Request=7.37kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 30: AI Request=7.55kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 31: AI Request=7.46kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 32: AI Request=6.96kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 33: AI Request=6.63kW | Executed=0.00kW | Avg SOC=0.74
battery_detail (4, 2, 272)
(272,)
Hour 34: AI Request=6.63kW | Executed=0.00kW | Avg SOC=0.68
battery_detail (4, 2, 272)
(272,)
Hour 35: AI Request=7.56kW | Executed=0.00kW | Avg SOC=0.68
battery_detail (4, 2, 272)
(272,)
Hour 36: AI Request=7.20kW | Executed=0.00kW | Avg SOC=0.68
battery_detail (4, 2, 272)
(272,)
Hour 37: AI Request=6.68kW | Executed=0.00kW | Avg SOC=0.68
battery_detail (4, 2, 272)
(272,)
Hour 38: AI Request=7.03kW | Executed=0.00kW | Avg SOC=0.64
battery_detail (4, 2, 272)
(272,)
Hour 39: AI Request=6.48kW | Executed=0.00kW | Avg SOC=0.59
battery_detail (4, 2, 272)
(272,)
Hour 40: AI Request=6.45kW | Executed=0.00kW | Avg SOC=0.59
battery_detail (4, 2, 272)
(272,)
Hour 41: AI Request=6.01kW | Executed=0.00kW | Avg SOC=0.59
battery_detail (4, 2, 272)
(272,)
Hour 42: AI Request=6.32kW | Executed=0.00kW | Avg SOC=0.46
battery_detail (4, 2, 272)
(272,)
Hour 43: AI Request=6.73kW | Executed=0.00kW | Avg SOC=0.38
battery_detail (4, 2, 272)
(272,)
Hour 44: AI Request=7.15kW | Executed=0.00kW | Avg SOC=0.38
battery_detail (4, 2, 272)
(272,)
Hour 45: AI Request=7.47kW | Executed=0.00kW | Avg SOC=0.38
battery_detail (4, 2, 272)
(272,)
Hour 46: AI Request=7.47kW | Executed=0.00kW | Avg SOC=0.34
battery_detail (4, 2, 272)
(272,)
Hour 47: AI Request=7.59kW | Executed=0.00kW | Avg SOC=0.20

âœ… Simulation Complete.
		[INFO] Case 2 completed.

	4.1 Testing Case 1...
ðŸš€ Starting Dynamic Simulation (Updating SOC per hour)
[INFO] Loading Initial State from Optimization file...
Initial SOC State: (2, 48, 272)
Initial SOC State: (272,)
battery_detail (4, 2, 272)
(272,)
Hour 24: AI Request=11.36kW | Executed=0.00kW | Avg SOC=0.20
battery_detail (4, 2, 272)
(272,)
Hour 25: AI Request=11.72kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 26: AI Request=11.64kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 27: AI Request=12.02kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 28: AI Request=11.26kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 29: AI Request=11.63kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 30: AI Request=11.36kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 31: AI Request=11.45kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 32: AI Request=11.83kW | Executed=0.00kW | Avg SOC=0.90
battery_detail (4, 2, 272)
(272,)
Hour 33: AI Request=11.36kW | Executed=0.00kW | Avg SOC=0.74
battery_detail (4, 2, 272)
(272,)
Hour 34: AI Request=10.22kW | Executed=0.00kW | Avg SOC=0.68
battery_detail (4, 2, 272)
(272,)
Hour 35: AI Request=10.76kW | Executed=0.00kW | Avg SOC=0.68
battery_detail (4, 2, 272)
(272,)
Hour 36: AI Request=11.15kW | Executed=0.00kW | Avg SOC=0.68
battery_detail (4, 2, 272)
(272,)
Hour 37: AI Request=10.47kW | Executed=0.00kW | Avg SOC=0.68
battery_detail (4, 2, 272)
(272,)
Hour 38: AI Request=10.19kW | Executed=0.00kW | Avg SOC=0.64
battery_detail (4, 2, 272)
(272,)
Hour 39: AI Request=10.21kW | Executed=0.00kW | Avg SOC=0.59
battery_detail (4, 2, 272)
(272,)
Hour 40: AI Request=9.82kW | Executed=0.00kW | Avg SOC=0.59
battery_detail (4, 2, 272)
(272,)
Hour 41: AI Request=9.77kW | Executed=0.00kW | Avg SOC=0.59
battery_detail (4, 2, 272)
(272,)
Hour 42: AI Request=9.37kW | Executed=0.00kW | Avg SOC=0.46
battery_detail (4, 2, 272)
(272,)
Hour 43: AI Request=9.30kW | Executed=0.00kW | Avg SOC=0.38
battery_detail (4, 2, 272)
(272,)
Hour 44: AI Request=8.22kW | Executed=0.00kW | Avg SOC=0.38
battery_detail (4, 2, 272)
(272,)
Hour 45: AI Request=8.33kW | Executed=0.00kW | Avg SOC=0.38
battery_detail (4, 2, 272)
(272,)
Hour 46: AI Request=9.40kW | Executed=0.00kW | Avg SOC=0.34
battery_detail (4, 2, 272)
(272,)
Hour 47: AI Request=10.13kW | Executed=0.00kW | Avg SOC=0.20

âœ… Simulation Complete.
		[INFO] Case 1 completed.
