Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at './data/battery_demand/tol25/resample_full.csv' and './data/battery_demand/tol25/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1377, 37)
		[INFO] Number of seeds ready for Case 3  = (2000, 36)

		[INFO] Case 1 exists — loaded battery demand from './data/battery_demand/tol25/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists — loaded battery demand from './data/battery_demand/tol25/case2_nan_filled/battery_demand.npy' with shape (1545, 37).
		[INFO] Case 3 exists — loaded battery demand from './data/battery_demand/tol25/case3_extended_generated/battery_demand.npy' with shape (3545, 37).
		[INFO] Case 0: Successfully added test pair 2024-03-15 & 2024-03-16
		Data: [10536, 28, 30, 35, 37, 37, 36, 33, 26, 10, 6, 10, 14, 19, 18, 15, 20, 26, 15, 9, 16, 21, 20, 8, 12, 15, 24, 31, 35, 32, 35, 34, 32, 31, 30, 22, 14, 18, 27, 18, 19, 19, 25, 25, 25, 26, 27, 17, 19]
		[INFO] Case 0: Successfully added test pair 2024-03-29 & 2024-03-30
		Data: [10872, 13, 26, 31, 33, 33, 33, 31, 15, 8, 19, 11, 15, 18, 16, 18, 18, 19, 7, 4, 23, 23, 16, 17, 18, 18, 19, 24, 29, 30, 30, 22, 27, 21, 14, 15, 16, 20, 18, 23, 27, 18, 2, 10, 23, 22, 22, 17, 21]

	1.6 Generating battery schedule...
		[INFO] Case 1 exists — loaded from './data/battery_demand/tol25/case1_real_only/battery_availability.npy' and './data/battery_demand/tol25/case1_real_only/battery_details.npy' shape (168, 263, 36) and (4, 168, 263)
		[INFO] Case 2 exists — loaded from './data/battery_demand/tol25/case2_nan_filled/battery_availability.npy' and './data/battery_demand/tol25/case2_nan_filled/battery_details.npy' shape (1545, 311, 36) and (4, 1545, 311)
		[INFO] Case 3 exists — loaded from './data/battery_demand/tol25/case3_extended_generated/battery_availability.npy' and './data/battery_demand/tol25/case3_extended_generated/battery_details.npy' shape (3545, 422, 36) and (4, 3545, 422)


==================================================
PART 2: MILP Optimization...
==================================================

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from './data/battery_demand/tol25/case1_real_only'
		[INFO] Results already exist at './data/optimization_results/tol25/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol25/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1545 samples from './data/battery_demand/tol25/case2_nan_filled'
		[INFO] Results already exist at './data/optimization_results/tol25/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol25/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 2 completed.

	2.3 Optimizing Case 3...
		[INFO] Loaded 3545 samples from './data/battery_demand/tol25/case3_extended_generated'
		[INFO] Results already exist at './data/optimization_results/tol25/case3_extended_generated/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Results already exist at './data/optimization_results/tol25/case3_extended_generated/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Case 3 completed.


==================================================
PART 3: Supervised Learning...
==================================================

	3.1 Training Case 1...
		=== Training Log Started: 2025-11-28 22:07:21.369823 ===
		Run Name: STAFV2_25_CASE1
		Device: cuda
		Epochs: 1000, Batch Size: 128, LR: 0.01
		============================================================
		[INFO] Unique quantized indices: 6686
		[INFO] Suggested num_embeddings: 8023
		[INFO] Processed 168 valid samples.
		[INFO] Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_25_CASE1.csv  (shape: (168, 429))
		[INFO] Saved feature metadata: ./data/training_results/feature_info_STAFV2_25_CASE1.json
		[INFO] Dataset split: 134 train, 34 val
		[INFO] Scalers fitted and saved.

		✅ Model initialized with 715620 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train R²  |   Val R²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/1000 | 0.010000   |    8.73819   |    9.07141   |     -1.115 |     -0.948 |    0/150  
		    2/1000 | 0.010000   |    7.67380   |    8.59776   |     -0.966 |     -0.750 |    0/150  
		    3/1000 | 0.010000   |    7.45463   |    8.11847   |     -0.862 |     -0.560 |    0/150  
		    4/1000 | 0.010000   |    9.28160   |    7.90570   |     -0.786 |     -0.479 |    0/150  
		    5/1000 | 0.010000   |    7.81208   |    7.67901   |     -0.710 |     -0.396 |    0/150  
		    6/1000 | 0.010000   |    7.75330   |    7.55834   |     -0.606 |     -0.352 |    0/150  
		    7/1000 | 0.010000   |    8.12339   |    7.28117   |     -0.588 |     -0.255 |    0/150  
		    8/1000 | 0.010000   |    8.12520   |    7.25736   |     -0.488 |     -0.247 |    0/150  
		    9/1000 | 0.010000   |    7.56268   |    7.19369   |     -0.390 |     -0.225 |    0/150  
		   10/1000 | 0.010000   |    7.75083   |    7.06252   |     -0.325 |     -0.181 |    0/150  
		   11/1000 | 0.010000   |    6.29820   |    6.79493   |     -0.251 |     -0.093 |    0/150  
		   12/1000 | 0.010000   |    6.78582   |    6.99945   |     -0.096 |     -0.160 |    0/150  
		   13/1000 | 0.010000   |    6.10305   |    6.81616   |     -0.012 |     -0.100 |    1/150  
		   14/1000 | 0.010000   |    7.51932   |    6.94791   |     -0.000 |     -0.143 |    2/150  
		   15/1000 | 0.010000   |    6.00238   |    6.67560   |      0.081 |     -0.055 |    3/150  
		   16/1000 | 0.010000   |    5.77351   |    6.63574   |      0.204 |     -0.042 |    0/150  
		   17/1000 | 0.010000   |    5.40860   |    6.69588   |      0.323 |     -0.061 |    0/150  
		   18/1000 | 0.010000   |    5.04409   |    6.62760   |      0.451 |     -0.040 |    1/150  
		   19/1000 | 0.010000   |    5.09310   |    6.43010   |      0.473 |      0.021 |    0/150  
		   20/1000 | 0.010000   |    4.22977   |    6.33106   |      0.576 |      0.051 |    0/150  
		   21/1000 | 0.010000   |    2.93483   |    6.26726   |      0.621 |      0.070 |    0/150  
		   22/1000 | 0.010000   |    5.38847   |    6.53738   |      0.669 |     -0.012 |    0/150  
		   23/1000 | 0.010000   |    4.80555   |    6.75346   |      0.709 |     -0.080 |    1/150  
		   24/1000 | 0.010000   |    2.91551   |    6.78675   |      0.742 |     -0.090 |    2/150  
		   25/1000 | 0.010000   |    2.96631   |    6.95357   |      0.778 |     -0.144 |    3/150  
		   26/1000 | 0.010000   |    2.32322   |    6.94984   |      0.823 |     -0.143 |    4/150  
		   27/1000 | 0.010000   |    2.57141   |    6.96510   |      0.854 |     -0.148 |    5/150  
		   28/1000 | 0.010000   |    2.20132   |    6.75381   |      0.856 |     -0.080 |    6/150  
		   29/1000 | 0.010000   |    2.73273   |    6.75353   |      0.878 |     -0.080 |    7/150  
		   30/1000 | 0.010000   |    6.08075   |    6.47201   |      0.805 |      0.009 |    8/150  
		   31/1000 | 0.010000   |    3.65205   |    6.48799   |      0.877 |      0.004 |    9/150  
		   32/1000 | 0.010000   |    2.30667   |    6.52554   |      0.871 |     -0.008 |   10/150  
		   33/1000 | 0.010000   |    3.25824   |    6.29839   |      0.875 |      0.061 |   11/150  
		   34/1000 | 0.010000   |    2.86830   |    6.15614   |      0.870 |      0.103 |   12/150  
		   35/1000 | 0.010000   |    2.61267   |    6.15552   |      0.882 |      0.103 |    0/150  
		   36/1000 | 0.010000   |    3.78882   |    6.21473   |      0.846 |      0.086 |    0/150  
		   37/1000 | 0.010000   |    2.32428   |    6.13250   |      0.853 |      0.110 |    1/150  
		   38/1000 | 0.010000   |    1.82208   |    5.96517   |      0.890 |      0.158 |    0/150  
		   39/1000 | 0.010000   |    2.27124   |    5.92354   |      0.895 |      0.169 |    0/150  
		   40/1000 | 0.010000   |    2.21305   |    5.93078   |      0.903 |      0.167 |    0/150  
		   41/1000 | 0.010000   |    2.60530   |    5.86191   |      0.878 |      0.187 |    1/150  
		   42/1000 | 0.010000   |    2.20460   |    5.78517   |      0.876 |      0.208 |    0/150  
		   43/1000 | 0.010000   |    6.68306   |    6.06012   |      0.823 |      0.131 |    0/150  
		   44/1000 | 0.010000   |    2.15328   |    6.01155   |      0.901 |      0.145 |    1/150  
		   45/1000 | 0.010000   |    2.38297   |    5.76478   |      0.904 |      0.213 |    2/150  
		   46/1000 | 0.010000   |    1.98992   |    5.71268   |      0.907 |      0.228 |    0/150  
		   47/1000 | 0.010000   |    2.51741   |    5.60984   |      0.899 |      0.255 |    0/150  
		   48/1000 | 0.010000   |    2.20485   |    5.58650   |      0.899 |      0.261 |    0/150  
		   49/1000 | 0.010000   |    2.11058   |    5.55955   |      0.918 |      0.268 |    0/150  
		   50/1000 | 0.010000   |    2.18823   |    5.56357   |      0.895 |      0.267 |    0/150  
		   51/1000 | 0.010000   |    3.73976   |    5.39926   |      0.870 |      0.310 |    1/150  
		   52/1000 | 0.010000   |    2.81221   |    5.39532   |      0.887 |      0.311 |    0/150  
		   53/1000 | 0.010000   |    1.64321   |    5.34008   |      0.909 |      0.325 |    0/150  
		   54/1000 | 0.010000   |    1.67882   |    5.34952   |      0.913 |      0.323 |    0/150  
		   55/1000 | 0.010000   |    2.84891   |    5.35327   |      0.886 |      0.322 |    1/150  
		   56/1000 | 0.010000   |    1.77995   |    5.41773   |      0.905 |      0.305 |    2/150  
		   57/1000 | 0.010000   |    4.33141   |    5.26700   |      0.860 |      0.343 |    3/150  
		   58/1000 | 0.010000   |    5.27224   |    5.13842   |      0.871 |      0.375 |    0/150  
		   59/1000 | 0.010000   |    2.65198   |    5.00312   |      0.917 |      0.408 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 5.0031)
		   60/1000 | 0.010000   |    1.84496   |    4.95115   |      0.907 |      0.420 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.9511)
		   61/1000 | 0.010000   |    4.45829   |    5.14435   |      0.884 |      0.374 |    0/150  
		   62/1000 | 0.010000   |    3.40376   |    5.27018   |      0.874 |      0.343 |    1/150  
		   63/1000 | 0.010000   |    1.84521   |    5.25518   |      0.906 |      0.346 |    2/150  
		   64/1000 | 0.010000   |    2.08562   |    5.38500   |      0.900 |      0.314 |    3/150  
		   65/1000 | 0.010000   |    1.67041   |    5.44705   |      0.906 |      0.298 |    4/150  
		   66/1000 | 0.010000   |    3.08882   |    5.53190   |      0.902 |      0.276 |    5/150  
		   67/1000 | 0.010000   |    4.01286   |    5.54956   |      0.861 |      0.271 |    6/150  
		   68/1000 | 0.010000   |    1.66972   |    5.61587   |      0.918 |      0.254 |    7/150  
		   69/1000 | 0.010000   |    2.73673   |    5.68891   |      0.899 |      0.234 |    8/150  
		   70/1000 | 0.010000   |    3.67115   |    5.81480   |      0.870 |      0.200 |    9/150  
		   71/1000 | 0.010000   |    1.94626   |    5.87712   |      0.879 |      0.182 |   10/150  
		   72/1000 | 0.010000   |    2.05473   |    5.83779   |      0.886 |      0.193 |   11/150  
		   73/1000 | 0.010000   |    2.30426   |    5.89502   |      0.875 |      0.177 |   12/150  
		   74/1000 | 0.010000   |    2.17523   |    5.82438   |      0.888 |      0.197 |   13/150  
		   75/1000 | 0.010000   |    2.45949   |    5.71130   |      0.874 |      0.228 |   14/150  
		   76/1000 | 0.005000   |    2.45086   |    5.61804   |      0.863 |      0.253 |   15/150  
		   77/1000 | 0.005000   |    2.25939   |    5.56053   |      0.903 |      0.268 |   16/150  
		   78/1000 | 0.005000   |    2.71523   |    5.48382   |      0.869 |      0.288 |   17/150  
		   79/1000 | 0.005000   |    4.84417   |    5.28672   |      0.862 |      0.338 |   18/150  
		   80/1000 | 0.005000   |    1.47882   |    5.29845   |      0.908 |      0.336 |   19/150  
		   81/1000 | 0.005000   |    2.02762   |    5.34466   |      0.884 |      0.324 |   20/150  
		   82/1000 | 0.005000   |    3.62851   |    5.49794   |      0.891 |      0.285 |   21/150  
		   83/1000 | 0.005000   |    2.18143   |    5.51775   |      0.873 |      0.279 |   22/150  
		   84/1000 | 0.005000   |    2.85826   |    5.55811   |      0.896 |      0.269 |   23/150  
		   85/1000 | 0.005000   |    2.44580   |    5.55574   |      0.869 |      0.269 |   24/150  
		   86/1000 | 0.005000   |    2.11441   |    5.57448   |      0.871 |      0.264 |   25/150  
		   87/1000 | 0.005000   |    2.44995   |    5.64335   |      0.905 |      0.246 |   26/150  
		   88/1000 | 0.005000   |    1.67085   |    5.60085   |      0.892 |      0.257 |   27/150  
		   89/1000 | 0.005000   |    3.90367   |    5.85908   |      0.871 |      0.187 |   28/150  
		   90/1000 | 0.005000   |    2.76747   |    5.87501   |      0.908 |      0.183 |   29/150  
		   91/1000 | 0.005000   |    2.24864   |    5.63793   |      0.893 |      0.248 |   30/150  
		   92/1000 | 0.002500   |    1.90078   |    5.60048   |      0.914 |      0.258 |   31/150  
		   93/1000 | 0.002500   |    2.28885   |    5.45436   |      0.893 |      0.296 |   32/150  
		   94/1000 | 0.002500   |    1.94524   |    5.50014   |      0.922 |      0.284 |   33/150  
		   95/1000 | 0.002500   |    1.74184   |    5.48396   |      0.914 |      0.288 |   34/150  
		   96/1000 | 0.002500   |    1.98919   |    5.36607   |      0.900 |      0.318 |   35/150  
		   97/1000 | 0.002500   |    1.60923   |    5.29485   |      0.916 |      0.336 |   36/150  
		   98/1000 | 0.002500   |    2.58661   |    5.18325   |      0.923 |      0.364 |   37/150  
		   99/1000 | 0.002500   |    2.80642   |    5.27798   |      0.925 |      0.341 |   38/150  
		  100/1000 | 0.002500   |    2.67583   |    5.42156   |      0.905 |      0.304 |   39/150  
		  101/1000 | 0.002500   |    1.93873   |    5.44112   |      0.929 |      0.299 |   40/150  
		  102/1000 | 0.002500   |    5.21722   |    5.19927   |      0.881 |      0.360 |   41/150  
		  103/1000 | 0.002500   |    2.10548   |    5.25046   |      0.938 |      0.347 |   42/150  
		  104/1000 | 0.002500   |    2.08495   |    5.23897   |      0.935 |      0.350 |   43/150  
		  105/1000 | 0.002500   |    3.14019   |    5.22907   |      0.916 |      0.353 |   44/150  
		  106/1000 | 0.002500   |    1.19943   |    5.27359   |      0.953 |      0.342 |   45/150  
		  107/1000 | 0.002500   |    2.38723   |    5.24356   |      0.914 |      0.349 |   46/150  
		  108/1000 | 0.001250   |    1.67496   |    5.38536   |      0.937 |      0.314 |   47/150  
		  109/1000 | 0.001250   |    1.50936   |    5.42074   |      0.936 |      0.304 |   48/150  
		  110/1000 | 0.001250   |    1.32075   |    5.44179   |      0.933 |      0.299 |   49/150  
		  111/1000 | 0.001250   |    1.87845   |    5.42999   |      0.935 |      0.302 |   50/150  
		  112/1000 | 0.001250   |    2.48870   |    5.52388   |      0.926 |      0.278 |   51/150  
		  113/1000 | 0.001250   |    1.81996   |    5.50884   |      0.916 |      0.282 |   52/150  
		  114/1000 | 0.001250   |    2.49769   |    5.60784   |      0.921 |      0.256 |   53/150  
		  115/1000 | 0.001250   |    2.73675   |    5.71447   |      0.938 |      0.227 |   54/150  
		  116/1000 | 0.001250   |    1.67799   |    5.56416   |      0.952 |      0.267 |   55/150  
		  117/1000 | 0.001250   |    3.37363   |    5.74592   |      0.922 |      0.219 |   56/150  
		  118/1000 | 0.001250   |    1.58122   |    5.62754   |      0.932 |      0.250 |   57/150  
		  119/1000 | 0.001250   |    1.95795   |    5.74771   |      0.933 |      0.218 |   58/150  
		  120/1000 | 0.001250   |    2.24851   |    5.78613   |      0.936 |      0.208 |   59/150  
		  121/1000 | 0.001250   |    1.88256   |    5.70886   |      0.938 |      0.229 |   60/150  
		  122/1000 | 0.001250   |    2.46676   |    5.54841   |      0.924 |      0.271 |   61/150  
		  123/1000 | 0.001250   |    1.50857   |    5.48452   |      0.923 |      0.288 |   62/150  
		  124/1000 | 0.000625   |    3.16912   |    5.31245   |      0.903 |      0.332 |   63/150  
		  125/1000 | 0.000625   |    2.70196   |    5.29974   |      0.919 |      0.335 |   64/150  
		  126/1000 | 0.000625   |    2.30172   |    5.22180   |      0.936 |      0.355 |   65/150  
		  127/1000 | 0.000625   |    2.66273   |    5.14530   |      0.922 |      0.373 |   66/150  
		  128/1000 | 0.000625   |    2.49660   |    5.09982   |      0.926 |      0.384 |   67/150  
		  129/1000 | 0.000625   |    4.05317   |    5.33494   |      0.919 |      0.326 |   68/150  
		  130/1000 | 0.000625   |    1.24629   |    5.44108   |      0.943 |      0.299 |   69/150  
		  131/1000 | 0.000625   |    3.06431   |    5.35045   |      0.904 |      0.322 |   70/150  
		  132/1000 | 0.000625   |    1.72352   |    5.31502   |      0.930 |      0.331 |   71/150  
		  133/1000 | 0.000625   |    2.59148   |    5.43066   |      0.914 |      0.302 |   72/150  
		  134/1000 | 0.000625   |    2.67810   |    5.35176   |      0.923 |      0.322 |   73/150  
		  135/1000 | 0.000625   |    1.43445   |    5.33610   |      0.943 |      0.326 |   74/150  
		  136/1000 | 0.000625   |    2.70673   |    5.25173   |      0.938 |      0.347 |   75/150  
		  137/1000 | 0.000625   |    1.93962   |    5.27834   |      0.919 |      0.341 |   76/150  
		  138/1000 | 0.000625   |    1.51842   |    5.24603   |      0.925 |      0.349 |   77/150  
		  139/1000 | 0.000625   |    2.71519   |    5.14186   |      0.915 |      0.374 |   78/150  
		  140/1000 | 0.000313   |    1.72870   |    5.14883   |      0.939 |      0.373 |   79/150  
		  141/1000 | 0.000313   |    1.31598   |    5.13328   |      0.933 |      0.376 |   80/150  
		  142/1000 | 0.000313   |    1.71590   |    5.15578   |      0.953 |      0.371 |   81/150  
		  143/1000 | 0.000313   |    2.38367   |    5.08916   |      0.934 |      0.387 |   82/150  
		  144/1000 | 0.000313   |    1.41463   |    5.11552   |      0.919 |      0.381 |   83/150  
		  145/1000 | 0.000313   |    1.49451   |    5.18444   |      0.935 |      0.364 |   84/150  
		  146/1000 | 0.000313   |    3.59657   |    5.16352   |      0.926 |      0.369 |   85/150  
		  147/1000 | 0.000313   |    2.27170   |    5.22612   |      0.908 |      0.354 |   86/150  
		  148/1000 | 0.000313   |    1.65616   |    5.20313   |      0.933 |      0.359 |   87/150  
		  149/1000 | 0.000313   |    3.33645   |    5.40489   |      0.915 |      0.309 |   88/150  
		  150/1000 | 0.000313   |    1.23543   |    5.43428   |      0.950 |      0.301 |   89/150  
		  151/1000 | 0.000313   |    2.47967   |    5.33810   |      0.904 |      0.326 |   90/150  
		  152/1000 | 0.000313   |    2.52304   |    5.20078   |      0.925 |      0.360 |   91/150  
		  153/1000 | 0.000313   |    1.66949   |    5.26997   |      0.939 |      0.343 |   92/150  
		  154/1000 | 0.000313   |    2.89928   |    5.45421   |      0.923 |      0.296 |   93/150  
		  155/1000 | 0.000313   |    2.11119   |    5.29059   |      0.924 |      0.337 |   94/150  
		  156/1000 | 0.000156   |    3.45415   |    5.52503   |      0.908 |      0.277 |   95/150  
		  157/1000 | 0.000156   |    3.93233   |    5.81293   |      0.915 |      0.200 |   96/150  
		  158/1000 | 0.000156   |    2.16243   |    5.58775   |      0.923 |      0.261 |   97/150  
		  159/1000 | 0.000156   |    3.43260   |    5.86701   |      0.915 |      0.185 |   98/150  
		  160/1000 | 0.000156   |    2.01315   |    5.68768   |      0.914 |      0.234 |   99/150  
		  161/1000 | 0.000156   |    2.93752   |    5.52761   |      0.901 |      0.277 |  100/150  
		  162/1000 | 0.000156   |    2.26973   |    5.53981   |      0.926 |      0.274 |  101/150  
		  163/1000 | 0.000156   |    1.65871   |    5.55728   |      0.947 |      0.269 |  102/150  
		  164/1000 | 0.000156   |    1.79160   |    5.66198   |      0.942 |      0.241 |  103/150  
		  165/1000 | 0.000156   |    4.18332   |    5.90922   |      0.900 |      0.173 |  104/150  
		  166/1000 | 0.000156   |    2.00322   |    5.97223   |      0.951 |      0.156 |  105/150  
		  167/1000 | 0.000156   |    2.14665   |    5.89352   |      0.915 |      0.178 |  106/150  
		  168/1000 | 0.000156   |    2.67011   |    5.66355   |      0.917 |      0.241 |  107/150  
		  169/1000 | 0.000156   |    1.61964   |    5.57996   |      0.925 |      0.263 |  108/150  
		  170/1000 | 0.000156   |    3.54658   |    5.88254   |      0.915 |      0.181 |  109/150  
		  171/1000 | 0.000156   |    2.05582   |    5.71216   |      0.935 |      0.228 |  110/150  
		  172/1000 | 0.000078   |    3.68130   |    5.90643   |      0.914 |      0.174 |  111/150  
		  173/1000 | 0.000078   |    1.74527   |    5.65831   |      0.937 |      0.242 |  112/150  
		  174/1000 | 0.000078   |    1.57457   |    5.53523   |      0.949 |      0.275 |  113/150  
		  175/1000 | 0.000078   |    3.78668   |    5.82123   |      0.930 |      0.198 |  114/150  
		  176/1000 | 0.000078   |    2.63756   |    5.87931   |      0.931 |      0.182 |  115/150  
		  177/1000 | 0.000078   |    1.72111   |    5.74725   |      0.951 |      0.218 |  116/150  
		  178/1000 | 0.000078   |    3.11656   |    5.56529   |      0.896 |      0.267 |  117/150  
		  179/1000 | 0.000078   |    2.06975   |    5.59972   |      0.935 |      0.258 |  118/150  
		  180/1000 | 0.000078   |    3.10411   |    5.43326   |      0.929 |      0.301 |  119/150  
		  181/1000 | 0.000078   |    1.79355   |    5.54621   |      0.950 |      0.272 |  120/150  
		  182/1000 | 0.000078   |    1.52420   |    5.43971   |      0.941 |      0.300 |  121/150  
		  183/1000 | 0.000078   |    1.63520   |    5.43601   |      0.913 |      0.301 |  122/150  
		  184/1000 | 0.000078   |    1.26510   |    5.41872   |      0.946 |      0.305 |  123/150  
		  185/1000 | 0.000078   |    3.10712   |    5.25589   |      0.933 |      0.346 |  124/150  
		  186/1000 | 0.000078   |    3.07683   |    5.17120   |      0.923 |      0.367 |  125/150  
		  187/1000 | 0.000078   |    6.22257   |    5.56754   |      0.848 |      0.266 |  126/150  
		  188/1000 | 0.000039   |    1.45060   |    5.60653   |      0.944 |      0.256 |  127/150  
		  189/1000 | 0.000039   |    2.36991   |    5.50383   |      0.930 |      0.283 |  128/150  
		  190/1000 | 0.000039   |    1.58038   |    5.47599   |      0.937 |      0.290 |  129/150  
		  191/1000 | 0.000039   |    1.87431   |    5.47435   |      0.944 |      0.291 |  130/150  
		  192/1000 | 0.000039   |    1.37579   |    5.48516   |      0.949 |      0.288 |  131/150  
		  193/1000 | 0.000039   |    2.69856   |    5.56375   |      0.925 |      0.267 |  132/150  
		  194/1000 | 0.000039   |    2.39178   |    5.66787   |      0.919 |      0.240 |  133/150  
		  195/1000 | 0.000039   |    2.57853   |    5.50824   |      0.934 |      0.282 |  134/150  
		  196/1000 | 0.000039   |    2.18506   |    5.41595   |      0.906 |      0.306 |  135/150  
		  197/1000 | 0.000039   |    1.53886   |    5.25358   |      0.945 |      0.347 |  136/150  
		  198/1000 | 0.000039   |    1.81314   |    5.29546   |      0.930 |      0.336 |  137/150  
		  199/1000 | 0.000039   |    1.55801   |    5.25615   |      0.934 |      0.346 |  138/150  
		  200/1000 | 0.000039   |    2.63011   |    5.41069   |      0.929 |      0.307 |  139/150  
		  201/1000 | 0.000039   |    3.87996   |    5.72174   |      0.908 |      0.225 |  140/150  
		  202/1000 | 0.000039   |    2.63660   |    5.92175   |      0.933 |      0.170 |  141/150  
		  203/1000 | 0.000039   |    1.53057   |    5.93161   |      0.937 |      0.167 |  142/150  
		  204/1000 | 0.000020   |    1.84455   |    5.74870   |      0.928 |      0.218 |  143/150  
		  205/1000 | 0.000020   |    1.48833   |    5.72658   |      0.943 |      0.224 |  144/150  
		  206/1000 | 0.000020   |    1.68725   |    5.67012   |      0.930 |      0.239 |  145/150  
		  207/1000 | 0.000020   |    3.83846   |    5.92225   |      0.918 |      0.170 |  146/150  
		  208/1000 | 0.000020   |    1.08253   |    5.82880   |      0.953 |      0.196 |  147/150  
		  209/1000 | 0.000020   |    3.07230   |    5.87737   |      0.928 |      0.182 |  148/150  
		  210/1000 | 0.000020   |    1.47829   |    5.66213   |      0.930 |      0.241 |  149/150  

		Early stopping triggered.
		[INFO] Case 1 completed.

	3.2 Training Case 2...
		=== Training Log Started: 2025-11-28 22:08:52.284021 ===
		Run Name: STAFV2_25_CASE2
		Device: cuda
		Epochs: 1000, Batch Size: 128, LR: 0.01
		============================================================
		[INFO] Unique quantized indices: 24141
		[INFO] Suggested num_embeddings: 28969
		[INFO] Processed 1545 valid samples.
		[INFO] Saved merged dataset: ./data/training_results/merged_windowed_dataset_STAFV2_25_CASE2.csv  (shape: (1545, 429))
		[INFO] Saved feature metadata: ./data/training_results/feature_info_STAFV2_25_CASE2.json
		[INFO] Dataset split: 1236 train, 309 val
		[INFO] Scalers fitted and saved.

		✅ Model initialized with 715620 params.
		============================================================
		--------------------------------------------------------------------------------------------
		  Epoch    |     LR     |  Train RMSE  |   Val RMSE   |  Train R²  |   Val R²   |  Patience 
		--------------------------------------------------------------------------------------------
		    1/1000 | 0.010000   |    9.15787   |    8.34922   |     -1.044 |     -0.597 |    0/150  
		    2/1000 | 0.010000   |    8.12420   |    7.30885   |     -0.613 |     -0.214 |    0/150  
		    3/1000 | 0.010000   |    6.90137   |    6.25164   |     -0.152 |      0.111 |    0/150  
		    4/1000 | 0.010000   |    5.48276   |    5.32775   |      0.269 |      0.346 |    0/150  
		    5/1000 | 0.010000   |    4.17981   |    4.31638   |      0.572 |      0.541 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 4.3164)
		    6/1000 | 0.010000   |    3.45034   |    4.43558   |      0.711 |      0.497 |    0/150  
		    7/1000 | 0.010000   |    3.03953   |    3.91398   |      0.777 |      0.601 |    1/150  
		                                          ╚══> ✅ SAVED (RMSE: 3.9140)
		    8/1000 | 0.010000   |    2.69210   |    3.96309   |      0.822 |      0.590 |    0/150  
		    9/1000 | 0.010000   |    2.58259   |    4.13573   |      0.839 |      0.554 |    1/150  
		   10/1000 | 0.010000   |    2.33443   |    3.99704   |      0.867 |      0.590 |    2/150  
		   11/1000 | 0.010000   |    2.15257   |    4.06416   |      0.888 |      0.569 |    3/150  
		   12/1000 | 0.010000   |    2.18274   |    3.91356   |      0.884 |      0.595 |    4/150  
		                                          ╚══> ✅ SAVED (RMSE: 3.9136)
		   13/1000 | 0.010000   |    2.18651   |    3.90254   |      0.884 |      0.598 |    0/150  
		                                          ╚══> ✅ SAVED (RMSE: 3.9025)
		   14/1000 | 0.010000   |    2.00788   |    4.01272   |      0.902 |      0.575 |    0/150  
		   15/1000 | 0.010000   |    1.90507   |    4.13074   |      0.912 |      0.542 |    1/150  
		   16/1000 | 0.010000   |    1.80941   |    4.01510   |      0.920 |      0.572 |    2/150  
		   17/1000 | 0.010000   |    1.92027   |    4.01704   |      0.910 |      0.578 |    3/150  
		   18/1000 | 0.010000   |    1.91938   |    4.04563   |      0.911 |      0.567 |    4/150  
		   19/1000 | 0.010000   |    1.80467   |    4.00438   |      0.919 |      0.584 |    5/150  
		   20/1000 | 0.010000   |    1.92898   |    3.94169   |      0.910 |      0.587 |    6/150  
		   21/1000 | 0.010000   |    1.71034   |    4.15294   |      0.930 |      0.550 |    7/150  
		   22/1000 | 0.010000   |    1.90045   |    4.11048   |      0.912 |      0.554 |    8/150  
		   23/1000 | 0.005000   |    1.86614   |    4.14355   |      0.915 |      0.556 |    9/150  
		   24/1000 | 0.005000   |    1.77617   |    4.10686   |      0.923 |      0.559 |   10/150  
		   25/1000 | 0.005000   |    1.72974   |    4.01412   |      0.927 |      0.581 |   11/150  
		   26/1000 | 0.005000   |    1.61786   |    4.07678   |      0.937 |      0.570 |   12/150  
		   27/1000 | 0.005000   |    1.70517   |    4.06125   |      0.929 |      0.561 |   13/150  
		   28/1000 | 0.005000   |    1.69354   |    4.02285   |      0.931 |      0.567 |   14/150  
		   29/1000 | 0.005000   |    1.65466   |    4.01330   |      0.935 |      0.570 |   15/150  
		   30/1000 | 0.005000   |    1.61745   |    3.95517   |      0.937 |      0.584 |   16/150  
		   31/1000 | 0.005000   |    1.66235   |    4.03310   |      0.933 |      0.567 |   17/150  
		   32/1000 | 0.005000   |    1.58248   |    4.02794   |      0.939 |      0.568 |   18/150  
		   33/1000 | 0.005000   |    1.53791   |    3.99481   |      0.943 |      0.571 |   19/150  
		   34/1000 | 0.005000   |    1.69828   |    4.06154   |      0.931 |      0.560 |   20/150  
		   35/1000 | 0.005000   |    1.45588   |    4.04037   |      0.948 |      0.564 |   21/150  
		   36/1000 | 0.005000   |    1.52936   |    4.05381   |      0.943 |      0.562 |   22/150  
		   37/1000 | 0.005000   |    1.64078   |    4.05444   |      0.935 |      0.564 |   23/150  
		   38/1000 | 0.005000   |    1.78910   |    3.99938   |      0.922 |      0.566 |   24/150  
		   39/1000 | 0.002500   |    1.53755   |    4.03712   |      0.942 |      0.562 |   25/150  
		   40/1000 | 0.002500   |    1.47693   |    4.07945   |      0.948 |      0.552 |   26/150  
		   41/1000 | 0.002500   |    1.60553   |    4.12286   |      0.937 |      0.542 |   27/150  
		   42/1000 | 0.002500   |    1.52307   |    4.13201   |      0.943 |      0.542 |   28/150  
		   43/1000 | 0.002500   |    1.62244   |    4.07077   |      0.935 |      0.552 |   29/150  
		   44/1000 | 0.002500   |    1.60621   |    4.01698   |      0.938 |      0.562 |   30/150  
		   45/1000 | 0.002500   |    1.56888   |    4.01699   |      0.941 |      0.566 |   31/150  
		   46/1000 | 0.002500   |    1.56509   |    4.09880   |      0.940 |      0.550 |   32/150  
		   47/1000 | 0.002500   |    1.57351   |    4.03463   |      0.940 |      0.561 |   33/150  
		   48/1000 | 0.002500   |    1.66264   |    4.03125   |      0.933 |      0.554 |   34/150  
		   49/1000 | 0.002500   |    1.60525   |    4.04187   |      0.939 |      0.557 |   35/150  
		   50/1000 | 0.002500   |    1.56261   |    4.07552   |      0.942 |      0.553 |   36/150  
		   51/1000 | 0.002500   |    1.58194   |    4.01033   |      0.940 |      0.565 |   37/150  
Traceback (most recent call last):
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/main.py", line 65, in <module>
    main()
    ~~~~^^
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/main.py", line 42, in main
    train(case_id=case_num, tolerance=target_tolerance)
    ~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/supervised_learning/training.py", line 151, in train
    for x, y in val_loader:
                ^^^^^^^^^^
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 1465, in _next_data
    return self._process_data(data)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 1491, in _process_data
    data.reraise()
    ~~~~~~~~~~~~^^
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/torch/_utils.py", line 715, in reraise
    raise exception
KeyError: Caught KeyError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/torch/utils/data/_utils/worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/home/lisa4090/Documents/GitHub/V2B_Optimization_with_AI_on_BSS/supervised_learning/dataloader/loader.py", line 50, in __getitem__
    series_feats = self.series_scaler.transform(series_feats.reshape(1, -1))[0]
                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/sklearn/utils/_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/sklearn/preprocessing/_data.py", line 1062, in transform
    X = validate_data(
        self,
    ...<6 lines>...
        ensure_all_finite="allow-nan",
    )
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/sklearn/utils/validation.py", line 2920, in validate_data
    tags = get_tags(_estimator)
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/sklearn/utils/_tags.py", line 393, in get_tags
    tag_provider = _find_tags_provider(estimator)
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/sklearn/utils/_tags.py", line 340, in _find_tags_provider
    has_get_or_more_tags = any(
        provider in tags_mro[klass] for provider in ("_get_tags", "_more_tags")
    )
  File "/home/lisa4090/anaconda3/envs/AIonBSS/lib/python3.13/site-packages/sklearn/utils/_tags.py", line 341, in <genexpr>
    provider in tags_mro[klass] for provider in ("_get_tags", "_more_tags")
                ~~~~~~~~^^^^^^^
KeyError: <function _find_tags_provider.<locals>.<genexpr> at 0x762f51b6c5e0>

