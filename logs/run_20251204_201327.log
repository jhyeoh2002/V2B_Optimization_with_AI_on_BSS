nohup: ignoring input
Crash diagnostics ON


==================================================
PART 1: Data preprocess for 2023-01-01 00:00:00 to 2024-09-30 23:00:00...
==================================================

	1.1 Preprocessing radiation data...
		[INFO] Radiation data already exists at './data/timeseries/radiation_data.csv'

	1.2 Preprocessing temperature data...
		[INFO] Temperature data already exists at './data/timeseries/temperature_data.csv'

	1.3 Preprocessing building data...
		[INFO] Building data already exists at './data/timeseries/building_data.csv'

	1.4 Preprocessing electricity cost data...
		[INFO] Electricity cost data already exists at './data/timeseries/electricitycostG2B_data.csv' and './data/timeseries/electricitycostG2V_data.csv'

	1.5 Preprocessing battery demand series data...
		[INFO] Found existing battery data at 'data/battery_demandV2/resample_full.csv' and 'data/battery_demandV2/resample_train.csv'

		[INFO] Number of series for clean windows = (168, 37)
		[INFO] Number of eligible series for Case 2 = (1395, 37)
		[INFO] Case 1 exists â€” loaded battery demand from 'data/battery_demandV2/case1_real_only/battery_demand.npy' with shape (168, 37).
		[INFO] Case 2 exists â€” loaded battery demand from 'data/battery_demandV2/case2_nan_filled/battery_demand.npy' with shape (1563, 37).
		[INFO] Case 0 exists â€” loaded battery demand from 'data/battery_demandV2/case0_test/battery_demand.npy' with shape (2, 49).

	1.6 Generating battery schedule...
		[INFO] Case 0 exists â€” loaded from 'data/battery_demandV2/case0_test/battery_availability.npy' and 'data/battery_demandV2/case0_test/battery_details.npy' shape (2, 272, 48) and (4, 2, 272)
		[INFO] Case 1 exists â€” loaded from 'data/battery_demandV2/case1_real_only/battery_availability.npy' and 'data/battery_demandV2/case1_real_only/battery_details.npy' shape (168, 237, 36) and (4, 168, 237)
		[INFO] Case 2 exists â€” loaded from 'data/battery_demandV2/case2_nan_filled/battery_availability.npy' and 'data/battery_demandV2/case2_nan_filled/battery_details.npy' shape (1563, 237, 36) and (4, 1563, 237)
		[ERROR] Could not load battery demand from 'data/battery_demandV2/case3_extended_generated/battery_demand.npy': [Errno 2] No such file or directory: 'data/battery_demandV2/case3_extended_generated/battery_demand.npy'


==================================================
PART 2: MILP Optimization...
==================================================

	2.0 Optimizing Case 0...
		[INFO] Loaded 2 samples from 'data/battery_demandV2/case0_test'
		[INFO] Results already exist at 'data/optimization_resultsV2/case0_test/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at 'data/optimization_resultsV2/case0_test/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 0 completed.

	2.1 Optimizing Case 1...
		[INFO] Loaded 168 samples from 'data/battery_demandV2/case1_real_only'
		[INFO] Results already exist at 'data/optimization_resultsV2/case1_real_only/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at 'data/optimization_resultsV2/case1_real_only/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 1 completed.

	2.2 Optimizing Case 2...
		[INFO] Loaded 1563 samples from 'data/battery_demandV2/case2_nan_filled'
		[INFO] Results already exist at 'data/optimization_resultsV2/case2_nan_filled/immediate_charging/V2B.npy'. Skipping immediate_charging run.
		[INFO] Results already exist at 'data/optimization_resultsV2/case2_nan_filled/optimization/V2B.npy'. Skipping optimization run.
		[INFO] Case 2 completed.


==================================================
PART 3: Supervised Learning...
==================================================

	3.1 Training Case 1...

=== Starting Training Run: STAFV5_CASE1 ===
Device: cuda
		[INFO] Starting Preprocessing for Case 1...
		[INFO] Unique quantized indices: 6686
		[INFO] Suggested num_embeddings: 8023
		[INFO] Generating sliding windows...
		[INFO] Saved dataset: ./data/training_results/STAFV5_CASE1/merged_dataset_STAFV5_CASE1.csv (Shape: (2016, 225))
		[INFO] Saved metadata: ./data/training_results/STAFV5_CASE1/feature_info_STAFV5_CASE1.json
	[Model Config] Detected Dims: {'static': 4, 'series_count': 6, 'seq_len': 24, 'vehicle': 76, 'emb_vocab': 8023}
		[INFO] Data loaded. Train: 1411, Val: 605
		[INFO] Fitting new scalers on training data...
		[INFO] Calculating weights for imbalanced regression...
		[INFO] 
==================================================
		[INFO] ðŸš€ TRAINING SESSION: STAFV5_CASE1
		[INFO] ==================================================
		[INFO] Device:             cuda
		[INFO] Model Parameters:   204,738
		[INFO] --------------------------------------------------
		[INFO] Epochs:             5000
		[INFO] Batch Size:         64
		[INFO] Learning Rate:      0.005
		[INFO] Weight Decay:       0.005
		[INFO] Dropout:            0.5
		[INFO] --------------------------------------------------
		[INFO] Hidden Layers:      [256, 64]
		[INFO] Embedding Dim:      16
		[INFO] Attention Heads:    4
		[INFO]==================================================


		[INFO]Epoch |    LR    | Trn RMSE | Val RMSE | Trn R2 | Val R2 | Stop
-----------------------------------------------------------------
		[INFO]    1 | 0.005000 |   6.7652 |  10.5051 |  0.306 | -1.169 | 0/100
		[INFO]    2 | 0.005000 |   5.9248 |   7.8709 |  0.557 | -0.220 | 0/100
		[INFO]    3 | 0.005000 |   4.6737 |   7.6066 |  0.681 | -0.142 | 0/100
		[INFO]    4 | 0.005000 |   4.4188 |   5.8965 |  0.713 |  0.318 | 0/100
		[INFO]    5 | 0.005000 |   4.6701 |   6.6170 |  0.700 |  0.141 | 0/100
		[INFO]    6 | 0.005000 |   4.8518 |   5.9205 |  0.720 |  0.317 | 1/100
		[INFO]    7 | 0.005000 |   4.4354 |   5.4223 |  0.763 |  0.423 | 2/100
		[INFO]    8 | 0.005000 |   4.1073 |   6.6179 |  0.746 |  0.143 | 0/100
		[INFO]    9 | 0.005000 |   4.0887 |   5.5393 |  0.767 |  0.398 | 1/100
		[INFO]   10 | 0.005000 |   3.8559 |   6.0662 |  0.789 |  0.279 | 2/100
		[INFO]   11 | 0.005000 |   3.8982 |   5.9107 |  0.786 |  0.317 | 3/100
		[INFO]   12 | 0.005000 |   4.2481 |   5.3252 |  0.765 |  0.439 | 4/100
		[INFO]   13 | 0.005000 |   3.7241 |   5.7424 |  0.786 |  0.353 | 0/100
		[INFO]   14 | 0.005000 |   3.9698 |   5.6804 |  0.785 |  0.365 | 1/100
		[INFO]   15 | 0.005000 |   4.0788 |   5.9925 |  0.782 |  0.296 | 2/100
		[INFO]   16 | 0.005000 |   4.0946 |   5.5850 |  0.773 |  0.387 | 3/100
		[INFO]   17 | 0.005000 |   4.0270 |   5.5978 |  0.782 |  0.382 | 4/100
		[INFO]   18 | 0.005000 |   3.7464 |   5.6059 |  0.808 |  0.380 | 5/100
		[INFO]   19 | 0.005000 |   3.6560 |   5.4999 |  0.823 |  0.408 | 6/100
		[INFO]   20 | 0.005000 |   4.0131 |   5.2565 |  0.783 |  0.454 | 7/100
		[INFO]   21 | 0.005000 |   4.8046 |   6.6497 |  0.783 |  0.129 | 0/100
		[INFO]   22 | 0.005000 |   3.5446 |   5.6243 |  0.812 |  0.376 | 1/100
		[INFO]   23 | 0.005000 |   3.3875 |   5.3168 |  0.826 |  0.441 | 2/100
		[INFO]   24 | 0.005000 |   3.6028 |   5.3451 |  0.804 |  0.435 | 3/100
		[INFO]   25 | 0.005000 |   3.8012 |   5.5639 |  0.811 |  0.391 | 4/100
		[INFO]   26 | 0.005000 |   3.8270 |   4.7539 |  0.830 |  0.553 | 5/100
		[INFO]   27 | 0.005000 |   3.3931 |   5.6308 |  0.815 |  0.378 | 0/100
		[INFO]   28 | 0.005000 |   3.5138 |   5.9545 |  0.821 |  0.302 | 1/100
		[INFO]   29 | 0.005000 |   3.3868 |   5.5595 |  0.825 |  0.389 | 2/100
		[INFO]   30 | 0.005000 |   3.1831 |   5.0083 |  0.842 |  0.505 | 3/100
		[INFO]   31 | 0.005000 |   4.0216 |   5.4893 |  0.849 |  0.406 | 4/100
		[INFO]   32 | 0.005000 |   3.7691 |   5.9325 |  0.806 |  0.306 | 5/100
		[INFO]   33 | 0.005000 |   3.6540 |   6.0606 |  0.803 |  0.277 | 6/100
		[INFO]   34 | 0.005000 |   3.4474 |   5.0157 |  0.821 |  0.503 | 7/100
		[INFO]   35 | 0.005000 |   3.6276 |   5.6667 |  0.812 |  0.366 | 8/100
		[INFO]   36 | 0.005000 |   3.3621 |   5.2113 |  0.824 |  0.467 | 9/100
		[INFO]   37 | 0.005000 |   3.5695 |   5.4919 |  0.835 |  0.406 | 10/100
		[INFO]   38 | 0.005000 |   3.5384 |   5.3894 |  0.837 |  0.430 | 11/100
		[INFO]   39 | 0.005000 |   3.3464 |   5.1635 |  0.838 |  0.478 | 12/100
		[INFO]   40 | 0.005000 |   3.3432 |   5.4828 |  0.857 |  0.412 | 13/100
		[INFO]   41 | 0.005000 |   3.4126 |   5.3191 |  0.847 |  0.448 | 14/100
		[INFO]   42 | 0.005000 |   3.7446 |   5.4083 |  0.834 |  0.430 | 15/100
		[INFO]   43 | 0.005000 |   3.5098 |   5.9132 |  0.815 |  0.318 | 16/100
		[INFO]   44 | 0.005000 |   4.2274 |   5.9774 |  0.812 |  0.299 | 17/100
		[INFO]   45 | 0.005000 |   3.7195 |   5.6812 |  0.794 |  0.366 | 18/100
		[INFO]   46 | 0.005000 |   3.4623 |   5.5830 |  0.824 |  0.388 | 19/100
		[INFO]   47 | 0.005000 |   3.3769 |   5.1701 |  0.853 |  0.475 | 20/100
		[INFO]   48 | 0.003750 |   3.4723 |   5.4813 |  0.810 |  0.410 | 21/100
		[INFO]   49 | 0.003750 |   3.6259 |   5.5226 |  0.840 |  0.402 | 22/100
